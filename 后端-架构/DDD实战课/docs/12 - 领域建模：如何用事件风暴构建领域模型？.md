你好，我是欧创新。

还记得我在 [\[第01讲\]](https://time.geekbang.org/column/article/149943) 中说过，微服务设计为什么要选择DDD吗？其中有一个非常重要的原因，就是采用DDD方法建立的领域模型，可以清晰地划分微服务的逻辑边界和物理边界。可以说，在DDD的实践中，好的领域模型直接关乎微服务的设计水平。因此，我认为DDD的战略设计是比战术设计更为重要的，也正是这个原因，我们的内容会更侧重于战略设计。

那么我们该采用什么样的方法，才能从错综复杂的业务领域中分析并构建领域模型呢？

它就是我在前面多次提到的事件风暴。事件风暴是一项团队活动，领域专家与项目团队通过头脑风暴的形式，罗列出领域中所有的领域事件，整合之后形成最终的领域事件集合，然后对每一个事件，标注出导致该事件的命令，再为每一个事件标注出命令发起方的角色。命令可以是用户发起，也可以是第三方系统调用或者定时器触发等，最后对事件进行分类，整理出实体、聚合、聚合根以及限界上下文。而事件风暴正是DDD战略设计中经常使用的一种方法，它可以快速分析和分解复杂的业务领域，完成领域建模。

那到底怎么做事件风暴呢？事件风暴需要提前准备些什么？又如何用事件风暴来构建领域模型呢？今天我们就来重点解决这些问题，深入了解事件风暴的全过程。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="" width="30px"><span>Geek_n0kucy</span> 👍（48） 💬（8）<div>DDD: 事件风暴--产品愿景--场景分析--领域建模--微服务拆分与设计。
传统: 产品需求--需求分析--详细设计--ER模型--UML设计
貌似最后都能产生模型图，一个叫领域模型，一个叫ER图，是不是关键就在这里，一个是面向业务领域建模，一个是面向底层数据层设计，也是DDD和传统的分水岭？</div>2019-11-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/31/0e/cbcada9b.jpg" width="30px"><span>伊来温</span> 👍（15） 💬（6）<div>有个问题请教下，商品的收藏功能，应该被划分在用户上下文呢还是商品上下文。感觉语意上两边都是通的</div>2020-06-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/df/7e/005ffd1e.jpg" width="30px"><span>Harris</span> 👍（11） 💬（1）<div>个人理解领域建模的核心是识别出领域模型并做到“高内聚，低耦合”；最后一步微服务拆分与设计并不一定是一定要微服务，可以是一个模块、一个包等等。</div>2020-01-05</li><br/><li><img src="" width="30px"><span>suke</span> 👍（9） 💬（4）<div>做微服务拆分为什么还要叫上产品、测试，和项目经理，他们的发言有用么 我就想问</div>2020-06-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/13/12/1c9692e7.jpg" width="30px"><span>myking</span> 👍（8） 💬（5）<div>老师能不能用把ddd带入到rbac的实战设计里面去？我感觉这个和订单比起来设计到的聚合根的选择更复杂的多，比如是不是应该有userRole的聚合根、roleMenu的聚合根。事件有删除menu删除role等等。在这种情况下应该如何处理呢</div>2020-10-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/db/c3/e11adfe8.jpg" width="30px"><span>hunter</span> 👍（8） 💬（6）<div>看着这个划分的领域，完全不知道怎么落地。</div>2019-11-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/a8/fa/e98afa52.jpg" width="30px"><span>Tan</span> 👍（6） 💬（3）<div>欧老师好，请教个问题：
信贷风控系统，客户提交申请信息，根据客户信息查几十个第三方信息（征信报告、欺诈分、企查查...）来获取客户相关信息然后放到规则引擎跑规则，最后算出客户授信金额。感觉这个系统一时半会没发下手划分领域和子域，麻烦老师指点一下，谢谢！</div>2019-12-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/b3/4e/5f22b09d.jpg" width="30px"><span>marker</span> 👍（5） 💬（1）<div>老师，能给我们说说四色建模或彩色建模？</div>2019-11-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/68/74/461b202d.jpg" width="30px"><span>睁眼看世界</span> 👍（4） 💬（3）<div>老师，学习到这里还是云里雾里，感觉学了一大堆概念，有个DDD这个理念。公司一般都是需求驱动，很少会花费大量精力去领域建模。老师，请问你们具体是如何推动DDD落地的？</div>2019-11-12</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/1LIW93RQ3ZvevCcfgib9Z4NwHsNAbicmGkicZwe9zCBPc9A2IXfLtXGUmzqrsibn1FibZcNIOddOrF9icuww9cYZD5ibA/132" width="30px"><span>Geek_75d94a</span> 👍（2） 💬（1）<div>学完感觉还是一脸懵逼，很多时候不知道哪些事件应该挂在哪个实体下面。像是一个团队里面，存在队长和队员，只有队长可以解散团队。那么解散团队这个操作，是放在团队实体上，还是队长实体上？</div>2020-07-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg" width="30px"><span>李二木</span> 👍（1） 💬（1）<div>DDD 适合敏捷开发吗？项目初期需求不是那么明确。都是在迭代中完善的。</div>2020-11-26</li><br/><li><img src="" width="30px"><span>suke</span> 👍（1） 💬（3）<div>怪不得ddd不好落地，且不说学习ddd付出的成本。一个领域建模要2周？还要叫上这么多人开会讨论 产出结果 可想效率之低</div>2020-06-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/c1/60/f5439f04.jpg" width="30px"><span>Geek_dn82ci</span> 👍（1） 💬（1）<div>有几个问题想请教下老师：
1. 中台类的项目通常是否也需要不断的迭代优化？
2. 假设要做一个2b的中台项目，集合ddd与敏捷开发，是否可以先根据用户旅程来遍历业务细节找出所有领域对象，最终按照ddd战略设计完成mvp产品的领域建模和限界上下文划分，这时候引入用户故事根据每一个边界内的聚合进行发布计划与迭代开发？
3. ddd与敏捷的融合，我认为有很多实践可以复用，例如白板、站会、用户旅程、工作坊，而到了战术设计阶段完全可以借用极限编程与精益的思想，比如引入结对编程，避免浪费等等，这样理解是否正确？谢谢</div>2020-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/e5/12/0ea3ff28.jpg" width="30px"><span>西野</span> 👍（1） 💬（1）<div>老师请教一下，领域服务和应用服务的区别是什么？？</div>2019-11-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/21/30/8ecce1e1.jpg" width="30px"><span>北天魔狼</span> 👍（1） 💬（4）<div>感觉最近要做的聚合交易项目就可以小试一下，老师已经列过类和方法名称，对照上下文和聚合可以照着葫芦画瓢了。现行项目不准备也没必要微服务，但是可以写好代码</div>2019-11-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/6a/0f/4388e49d.jpg" width="30px"><span>KorbinSeaman</span> 👍（0） 💬（1）<div>DDD的战略设计在实战中并没有展开讲，从事件风暴道最后设计出领域模型，希望可以详细讲一下战略设计的细节。作为读者，希望可以从实战案例中学习到一些经验性的总结。</div>2021-02-02</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo8oqLakeEtgzYuLutmn8F1icEhQmR1ib1Aqic9c9dkvPMEvqHIyMF0UljzfUyY17EOnB5N44SBHke4A/132" width="30px"><span>are you smoke</span> 👍（0） 💬（1）<div>老师，不明白事件风暴为什么需要产品远景，如果只是toB的业务系统，可以不需要吗？</div>2021-02-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/24/9d/81/085ae5fa.jpg" width="30px"><span>钟hao</span> 👍（0） 💬（1）<div>看的好困，太多的理论知识了，看了两遍才摸清讲的是什么，下面的评论也大多和我一样，实践太少了，而且是画好的图，跟本就不能按照图的逻辑去想，就好像镜花水月一样，抓不住重要的点，说实话文章很多的一些内容我还是去其他博客看了再回来理解作者的意思。不是说别人写的容易理解，而是老师说的太理论性了</div>2021-01-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7b/62/80d0d8d2.jpg" width="30px"><span>leesofte</span> 👍（0） 💬（1）<div>第一个问题：一个实体就可以构成一个聚合吗？那它自己就作为聚合根了？一个聚合也可以作为一个领域服务给应用服务提供底层服务吗？
第二个问题：智能工厂的场景，一个工厂会有多个场地，每个场地都会有一个场地方案，每个场地方案会包含多台智能设备，每台设备可能会配备一名操作人员也可能不需要配备人员，系统需要做工厂智能管理。里面的实体会包含系统各类状态，操作日志，操作规则，用户，权限，配件等等。我问下里面如何设计聚合比较合理？我自己设计感觉只有设备聚合，用户权限聚合，场地聚合，工厂聚合。然后设备又作为场地的值对象。用户、场地又有作为工厂聚合的值对象，一层套一层。这样的聚合设计对不对？？老师你是怎么设计的呢？</div>2020-12-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/71/22/b8c596b6.jpg" width="30px"><span>风</span> 👍（0） 💬（1）<div>事件风暴听着很好，但是不知该如何落地，也就是说把一群人组织在一起如何开展活动，需要让每个人都做些什么，是天马行空地想，还是划定方向，也就是主持人该如何组织一场事件风暴的开展呢？</div>2020-11-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/c1/b7/57f153f6.jpg" width="30px"><span>Sun Fei</span> 👍（0） 💬（1）<div>就记住了事件风暴。</div>2020-11-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/e6/f1/f2d448ad.jpg" width="30px"><span>Jason</span> 👍（0） 💬（1）<div>老师，这讲是不是没有体现事件风暴的过程啊。我们比较关系如何通过事件风暴，用可视化的方式进行沟通，并如何对识别的事件、约束、角色、命令等，进行DDD建模，识别实体等。</div>2020-10-14</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/4mialQmmo2p1jlNyyaZGJvV1SfUMAP1XfFHCJDtfknibomU5AKUkBh3Y6uaYVjjlTn7FmrCcaa2HMSiat212T1MyA/132" width="30px"><span>xiaoacheng</span> 👍（0） 💬（1）<div>商品目录-》商品分类-》商品   这种怎么定义聚合呢？</div>2020-10-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/ce/4f/6afbb99a.jpg" width="30px"><span>天信</span> 👍（0） 💬（1）<div>子域划分的那个椭圆形图是用什么工具做的</div>2020-09-26</li><br/><li><img src="" width="30px"><span>Geek_70b64a</span> 👍（0） 💬（1）<div>事件风暴怎么感觉其实就是系统的用例图，只不过这个用例图是由大家一起拼凑的。</div>2020-05-31</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/LalJD9ruYQI5zVM1GOCe4PjunIbbeeMiacFHC4TAj0DBVeialKt3vRCLs9dxn1vYXvfp8pgcyaeEQkh1nde1JoBQ/132" width="30px"><span>jun</span> 👍（0） 💬（1）<div>哈哈， 电商领域，感觉不知道怎么开始。。。
天然就感觉用户、订单、商品分别属于各不同的业务领域，然后再根据它们具体的业务，提炼出服务。</div>2020-05-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/0a/bb/2f3b6af3.jpg" width="30px"><span>清涧飞鸟</span> 👍（0） 💬（3）<div>老师您好，昨天对公司现有系统准备进行DDD的重构，尝试进行事件风暴活动，结果第一步就挂了，找不到事件：这个产品是医院的一个数据整合平台，它主要是收集医院各个临床子系统的数据，然后进行简单清洗为一个患者全景展示页面提供数据，同时这个产品收集上来的数据和状态也为其他子系统提供数据服务；
我们是以医院全院流程与系统相关的事件为事件，如患者已挂号，就给我们的系统推送了新建的患者信息，患者已作了检查就给我们推送检查数据和状态数据，医生了写了报告就给我们的系统推送报告数据...... 我们用了这些事件，结果找不到命令，或者命令根本对我们的系统没意义（命令是我们系统提供对外的服务），

现在我的问题如下，请老师帮我看看：
在事件风暴中，
1）事件必须是本系统内的事件吗？
2）事件一定有命令触发吗？
3）就我上面的场景而言，我们的系统的事件与命令大致应该如何识别</div>2020-05-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/36/f6/d65b7302.jpg" width="30px"><span>峰</span> 👍（0） 💬（2）<div>请问老师两个问题 :
1.上面那张表是不是示示的有问题，应用服务归到聚合下了？
2.领域服务是操作多个实体的？是指在一个聚合内操作多个实体？还是指操作不同聚合下的多个实体？
</div>2020-04-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/36/f6/d65b7302.jpg" width="30px"><span>峰</span> 👍（0） 💬（2）<div>请问老师，子域和BC是否非得要一对一才合理？如果出现一个子域出现了2个BC是否意味着还要往下再拆分子域？</div>2020-04-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/f9/19/7c3b12ee.jpg" width="30px"><span>Geek_deb968</span> 👍（0） 💬（1）<div>这是要一个航空母舰超级天团撑着哈</div>2020-03-27</li><br/>
</ul>