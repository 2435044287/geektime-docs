你好，我是丁威。

这节课我们来回答一下上节课的问题，希望通过梳理这些问题，可以进一步加深你对知识的理解。

**1. MyCat数据库中间件与ShardingJDBC在架构思想上有什么差异？**

MyCat数据库中间件的设计理念是代理模式，这是一种**高度中心化的设计**，所有的路由配置都会存储在MyCat数据库中间件中。具体的工作机制是，所有客户端将所有请求发送到MyCat，然后MyCat根据配置的路由规则将请求发送到真实的后端数据库。

这种架构模式在数据量较少的情况下确实能提升性能，但如果请求数继续增加，就有可能出现问题，你可以先看看下面这张图片：

![图片](https://static001.geekbang.org/resource/image/a4/b8/a4e1225d880ea7e2b55dbca871c1d0b8.jpg?wh=1920x1001)

如果数据库需要存储的数据逐步增加，我们就要对后端数据库进行扩容，这个无可厚非。但如此一来，存储的数据会越来越多，基于代理模式，所有的请求都必须经过MyCat这个中心节点。一旦这个节点出现故障，将导致系统不可用。

而ShardingJDBC采取了去中心化的设计，系统架构如下图所示：

![图片](https://static001.geekbang.org/resource/image/f3/db/f3ec24548c32265c6408ee62c07caedb.jpg?wh=1920x977)

从这张图可以看到，ShardingJDBC是将所有的路由信息嵌入到应用进程中，在客户端进行路由计算，然后连接后端真实的数据库。如果要对后端数据库进行扩容，只需要更新一下路由注册信息就可以了，不会带来额外的资源损耗，也不存在单点故障。
<div><strong>精选留言（1）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/21/20/1299e137.jpg" width="30px"><span>秋天</span> 👍（1） 💬（0）<div>然后开一个定时任务，拿队列中第一个元素和当前时间进行比较：如果下一次执行时间大于等于当前时间，则将队列中第一个元素（调度任务）从队列中移除，投入线程池中执行。如果下一次执行时间小于当前时间，则不处理，因为队列中最小的待执行任务都还没有到执行时间，其他任务一定也是这样。
大佬，感觉着说的有问题呢？大于当前时间不做处理，小于当前时间执行调度加入调度线程中把？</div>2022-08-03</li><br/>
</ul>