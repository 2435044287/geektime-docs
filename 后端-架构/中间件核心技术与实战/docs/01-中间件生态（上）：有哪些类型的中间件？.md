你好，我是丁威。

最近十年是互联网磅礴发展的十年，IT系统从单体应用逐渐向分布式架构演变，高并发、高可用、高性能、分布式等话题变得异常火热，中间件也在这一时期如雨后春笋般涌现出来，那到底什么是中间件呢？存在哪些类型的中间件呢？同一类型的中间件，我们该怎么选择？接下来的两节课，我们就来聊聊这些问题。

中间件的种类很多，我们无法把所有类型和产品列出来逐一讲解。但是每个类别的中间件在设计原理、使用上有很多共同的考量标准，只要了解了最重要、最主流的几种中间件，我们就可以方便地进行知识迁移，举一反三了，然后学习其他中间件将变得非常简单。

所以呢，你可以把这两节课看作是提纲挈领的知识清单。下面我们讲到的中间件你不一定都能够用上，但在需要的时候，可以帮你从更加高屋建瓴的角度迅速决策。

## 什么是中间件？

先来说说什么是中间件，我认为中间件是游离于业务需求之外，专门为了处理项目中涉及高可用、高性能、高并发等技术需求而引入的一个个技术组件。它的一个重要作用就是能够实现业务代码与技术功能之间解耦合。

这么说是不是还有点抽象？在这里定义里，我提到了业务需求和技术需求，关于这两个词我需要再解释一下。

业务需求，笼统地说就是特定用户的特定诉求。以我们快递行业为例：人与人之间需要跨城市传递物品，逢年过节我们需要给远方的亲人寄礼物，这就是所谓的业务需求。
<div><strong>精选留言（11）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/18/bd/f6/558bb119.jpg" width="30px"><span>ᯤ⁵ᴳ</span> 👍（7） 💬（3）<div>ShardingJDBC 似乎没有 myCat 性能好啊</div>2022-07-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/87/5c/919c1262.jpg" width="30px"><span>文涛</span> 👍（5） 💬（1）<div>mycat似乎N没更新了，现在分表分库还是几年前那套理论？而且还是Java体系的！TiDb等新兴数据库了解一下！</div>2022-06-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/50/2b/2344cdaa.jpg" width="30px"><span>第一装甲集群司令克莱斯特</span> 👍（2） 💬（1）<div>运维戏称:珍爱生命，远离mycat</div>2022-08-24</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/picb3nrC6rX6t4t6pHP8huAyrBa9g4lXCsY0uz2OicZsVsCfyLRg523CTWxX5AfEptxCMEC9DMuLZcia1cwzawhmg/132" width="30px"><span>Mr.Hwang</span> 👍（1） 💬（1）<div>其实选择ShardingSphere或CAT更多考虑的层面是从数据库治理去考虑的，ShardingJDBC也还是没办法做治理的。</div>2022-09-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/0e/6c/1f3b1372.jpg" width="30px"><span>哈哈哈</span> 👍（0） 💬（1）<div>丁老师，之前我用过的分库分表中间件也是集成在业务系统上的，但也有一个统一运维平台，这个平台可以提交分库分表规则，就是一段代码，根据uId&#47;mid确定是哪个库&#47;表，貌似也没有运维问题；另外分成1024个表这个数字有点奇怪，我理解要么是百库百表or千库千表，1024不太好配置规则吧。</div>2022-08-27</li><br/><li><img src="" width="30px"><span>qiuzeliang</span> 👍（0） 💬（1）<div>写一个类就可以处理根据订单编号路由到对应的表，为啥要引入数据库中间件？ 个人觉得以这个理由引入数据库中间件不够充分</div>2022-07-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg" width="30px"><span>李二木</span> 👍（0） 💬（2）<div>如果要高可用就是多副本方式</div>2022-06-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/aa/01/641f3c3a.jpg" width="30px"><span>c梦</span> 👍（0） 💬（4）<div>文章片段：「举个例子，如果订单表被分成了 1024 个表，这时候如果你想根据订单编号去查询数据，必须人为计算出这条数据存在于哪个库的哪个表中，然后再去对应的库上执行 SQL 语句。」

老师，您好，这里我没太懂，为什么需要人为计算出数据库存在于哪个表，因为 sharding-jdbc 应该是可以根据配置知道有哪些库哪些表的，然后根据他的算法计算出去哪个库表执行sql的吧？我没有用过 sharding-jdbc，可能是理解有偏差？</div>2022-06-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/2a/b3/81b09345.jpg" width="30px"><span>李蕾</span> 👍（4） 💬（0）<div>分库分表都能够环节写入的压力，其中分表主要是能够降低表锁或者间隙锁的锁竞争，从而缓解写入压力。
我在业务中基本使用的都是ShardingJDBC,使用过程中直接将分库分表的逻辑配置好，具体的路由就由ShardingJDBC实现，但是这里需要注意线程池的配置，防止数据库连接数爆炸的问题，这个也是我在业务上踩过的大坑，一般的措施是在接口侧增加限流；
这里我理解，分布式架构设计更多的还是要从实际业务出发，将通用能力抽取，减少与业务的耦合，然后不断优化为一款好的产品。
虽然当前有TiDB等分布式数据库的出现，但是由于社区、技术积累等等方面的原因，MySQL依旧还是最为常用的数据库，了解常用的分库分表的中间件还是很关键的。</div>2022-11-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/5d/4b/adec3edc.jpg" width="30px"><span>Master</span> 👍（4） 💬（4）<div>有些不严谨，分库能缓解写入压力我能理解，分表不能吧。。。另外mycat和ShardingJDBC的选择更多的是综合性的选择结果，并没有绝对的好坏，sharding的方案会让数据库的连接数大幅上升，对于连接池的设置要异常谨慎，还有就是应用程序在扩容的时候实际上需要非常小心，连接数的飙高会直接影响mysql性能，而mycat一般没有这些问题。至于性能。。本质上来说还是DB的性能是大头，和中间件无关，中间件不会连数据库都跑不过吧 0 0...链路较长性能有损是常识，但高性能中间件一般都会注意这个，是不是你测试的时候设置不对啊，有做过不同设置下对比么，如果有损是否可以到不可接受的地步？。。。。
还有就是目前的云原生数据库的发展很快，文章中提到的一些问题可能目前不是问题了。。</div>2022-07-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg" width="30px"><span>朱雯</span> 👍（0） 💬（0）<div>老师我有些问题想问一下。 
1. 中间件是通用的吗 我经常看到tomcat会用于java 其他语言没咋听过 请问这是什么原因呢？
2. 今天说了两种数据库中间件 请问一下 这两种中间件哪种好 有没有其他组件可以替代吗</div>2023-03-10</li><br/>
</ul>