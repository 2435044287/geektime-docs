你好，我是丁威。

不知不觉，我们已经进入了专栏的最后一个板块。这节课，我想给你介绍一下我在全链路压测领域的一些实践经验，让你对中间件相关技术有一个全局的理解。

实际上，全链路压测也是我进入中通负责的第一个项目。当时，我们需要从0到1打造全链路压测项目，而我对主流中间件的深入了解，在项目的开发和启动过程中发挥了极大的作用，也让作为新人的我在新公司站稳了脚跟。

### 全链路压测概述

那什么是全链路压测呢？网上关于它的定义有很多，所以我在这里只给出一个可能不太全面，但是比较简单易懂的我的版本：**全链路压测就是在生产环境对我们的系统进行压测，压测流量的行进方向和真实用户的请求流量是一致的，也就是说压测流量会完全覆盖真实的业务请求链路。**

全链路压测的核心目的是高保真地检测系统的当前容量，方便在大促时科学合理地扩缩容，为合理规划资源提供可视化的数据支撑。

在介绍全链路压测之前，我们先来看一张简易的数据流向图，感受一下我们公司需要落地全链路压测的底层系统的布局情况：

![图片](https://static001.geekbang.org/resource/image/ed/19/ed00e492cfbe446276731fe4874a8719.jpg?wh=1920x607)

首先，压测端通常采用JMeter构建压测请求（HTTP请求），全链路压测系统需要提供一种机制对真实的业务流量与测试流量加以区分，然后压测流量与真实流量分别进入接入层的负载均衡组件，最终进入接口网关。接口网关再发起HTTP或者Dubbo等RPC请求，进入到内部的业务系统。
<div><strong>精选留言（1）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/1b/a6/72/526fd3df.jpg" width="30px"><span>ICE FROG</span> 👍（0） 💬（1）<div>ThreadLocal有父子线程传递问题，父线程的一些数据状态不会传递给子线程，父线程的ThreadLocal状态子线程是无法感知的，也就是会丢失</div>2022-11-22</li><br/>
</ul>