你好，我是姚秋辰，今天想跟你聊聊主链路规划在微服务中的应用。

说起微服务改造，我们第一个想到的就是要对各个服务进行拆分，微服务拆分的合理性很大程度上决定了整个业务链路的可用性。在微服务拆分的过程中，我们的首要任务是识别出核心服务，那么核心服务为何如此重要呢？

如果把所有线上服务比喻为一个大军团，那么“核心服务”就是这个军团当中战斗力最强的精锐部队，是完成战略目标的攻坚力量。比如在双11这类大战役中，所有的后勤资源（虚拟机、磁盘、网络资源等）都要优先供给给精锐部队，保证整个军团的集体作战能力（业务高可用性）。

如果能精准**识别核心服务场景**，将这些核心服务拆分成独立的微服务模块，我们就可以在核心微服务链路上应用弹性机房水位调拨、流量整形和熔断降级等技术手段，构建核心服务与边缘服务之间的隔离带，在极端洪峰流量场景下保证核心业务的高可用性。

那如何才能识别核心服务场景呢？这就要讲到今天的主题：**主链路规划**。主链路规划是一种非常直观的方法论，帮助我们快速识别核心链路。今天我就来和你探讨两个“主链路规划”相关的话题：

- 什么是主链路？
- 如何识别业务场景中的主链路

## 什么是主链路

所谓主链路，用一句话概括就是“**保证业务可用性的核心链路**”，那什么样的业务场景才能够入围核心链路呢？
<div><strong>精选留言（6）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/11/30/c1/2dde6700.jpg" width="30px"><span>密码123456</span> 👍（3） 💬（1）<div>“可复用性”未必是一个很好的思路。我从来没有思考过这个问题。</div>2022-04-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/f4/c7/037235c9.jpg" width="30px"><span>kimoti</span> 👍（2） 💬（1）<div>在回答怎么样保证主链路的高可用之前,我就在想主链路怎么就不可用了呢？只要想明白第二个问题,然后考虑对应的解决方案就是第一个问题的答案了。</div>2022-01-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（0） 💬（1）<div>Q1：优惠服务为什么是四个？是为了高并发吗？这四个优惠服务的代码是一样的吗？
Q2：在实践方面，阿里都采用微服务了吗？sentinel在阿里内部使用率高吗？
Q3：sentinel的前端是用vue开发的吗？有前端工程代码吗？</div>2022-01-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/50/2b/2344cdaa.jpg" width="30px"><span>第一装甲集群司令克莱斯特</span> 👍（2） 💬（0）<div>多聊聊业务相关的东西，挺好的😁</div>2022-01-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/7e/14/7e76114b.jpg" width="30px"><span>醒</span> 👍（0） 💬（0）<div>1. 服务多副本，即使出现了个别服务的故障，其他服务可以支撑使用；
2. 数据和服务的隔离，防止故障的蔓延；限流、熔断、降级同理；
3. 灰度发布和回滚，主要用于版本更新时的问题处理；
4. 监控和告警，出现问题时即使告警处理问题；</div>2024-09-20</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/ULSZxjHNT5ZMormTYmqSZvoCbKd0q6oN8V78QaLdzqkqs1AXMShysNczsOOVJrblE4dxhBuibDvkgIlzVAw2qeQ/132" width="30px"><span>Geek_e306aa</span> 👍（0） 💬（0）<div>坐等下节课，受益匪浅
</div>2022-01-30</li><br/>
</ul>