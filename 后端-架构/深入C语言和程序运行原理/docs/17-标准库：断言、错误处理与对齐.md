你好，我是于航。

这一讲是这门课中关于 C 标准库的最后一讲。通过前面几讲的学习，相信你已经对 C 标准库提供的相关能力有了一个全面的认识。在此基础上，我们便可以使用这些成熟的接口，来更加方便地构建应用程序。这一讲后，在“ C 工程实战篇”的其他篇目中，我会和你一起讨论语言具体功能之外的性能优化、自动化测试、结构化编译等 C 工程化相关内容，并带你手把手实现一个简单的高性能 HTTP Server。

今天，我们来看一看与 C 标准库相关的最后三个话题：断言、错误处理，以及对齐。

断言为我们提供了一种可以静态或动态地检查程序在目标平台上整体状态的能力，与它相关的接口由头文件 assert.h 提供。错误处理则涉及 C 程序如何通过特定方式，判断其运行是否发生错误，以及错误的具体类型，头文件 errno.h 中则定义了与此相关的宏。除此之外，C 语言还具有自定义数据对齐方式的能力，借助 stdalign.h 头文件提供的宏，我们可以轻松地做到这一点。

## 断言

在计算机编程中，断言是一种可用于判断程序设计或运行是否符合开发者预期的逻辑判断式。与断言相关的编程接口由标准库头文件 assert.h 提供。

在 C 语言中，断言被分为静态断言与运行时断言。其中，静态断言主要用来约束程序在编译时需要满足的一定要求；运行时断言则可以在程序运行过程中，判断一些支持程序正常运行的假设性条件是否满足。我们来看下面这个例子：
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/18/80/f4/564209ea.jpg" width="30px"><span>纳兰容若</span> 👍（4） 💬（2）<div>老师 您好
我在cppreference上发现这个例子：
assert((2*2==4) &amp;&amp; &quot;Yet another way to add assert message&quot;);
老师说的断言失败给开发者发送自定义的错误消息 是这个意思么</div>2022-04-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/a2/4b/b72f724f.jpg" width="30px"><span>zxk</span> 👍（3） 💬（1）<div>契约式编程是一种编程风格，类比商业中的服务供应商与客户的，将编程中划分为了服务提供方与服务调用方，两者之间的关系如下：
1. 服务提供方期望服务调用方能够遵循一定的规范进行调用，这是服务调用方应满足服务提供方定下的先验条件
2. 服务提供方退出时需要保证能够返回特定的结果，这是服务提供方承诺服务调用方定下的后验条件
3. 先验条件与后验条件之间的交集，在进入与退出之后都应保持不变

具体到编程来说，就是客户端遵循一定规范调用方法接口，方法内部会对函数做一定程度的检查（通常是断言 + 异常信息，但 C 中是 errno 的间接方式），客户端会期望方法接口具有特定的行为，并返回一个可预测的返回值。
个人浅显理解，不知道对不对。</div>2022-03-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/8e/10/10092bb1.jpg" width="30px"><span>Luke</span> 👍（1） 💬（0）<div>一楼那个太妙了。。。我第一反应是自定义自己的assert宏。

没想到errno居然是线程安全的，跟我以前的印象不太一样了，只记得他是全局的，在此更新一下认知。</div>2022-09-20</li><br/>
</ul>