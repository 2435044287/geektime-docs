你好，我是七牛云许式伟。

## 架构是共识确认的过程

对于架构这件事情，有不少让人误解的地方。前面在 “[57 | 心性：架构师的修炼之道](https://time.geekbang.org/column/article/166014)” 一讲中，我们提到过架构师需要掌握的三大技能：

- 理需求的能力；
- 读代码的能力；
- 抽象系统的能力。

这里面除了 “读代码” 这件事可能允许没有什么显性的产出外（其实也应该有，去读代码通常意味着缺架构设计文档，所以按理应该去补文档），其他两类事情要做好都不容易。

就理需求的能力而言，很多架构师一不知道要做需求分析，二不知道需求分析的产出到底应该是什么样的。需求分析可以说是架构师最没有概念的一个环节，尽管它至关重要。这一块领域特征比较明显，课堂上讲师授课的方式，很难有好的成效，更适合以实训的方式来强化。

就抽象系统的能力而言，很多架构师爱画架构图。画完了架构图，他就认为架构做完了，下一步该去编码。

这有什么问题？

首先，架构过程是团队共识形成与确认的过程。共识是需要精确的、无歧义的。而架构图显然并不精确。

团队没有精确的共识很可怕，它可能导致不同模块的工作牛头不对马嘴，完全无法连接起来，但是这个风险没有被暴露，直到最后一刻里程碑时间要到了，要出版本了，大家才匆匆忙忙联调，临时解决因为架构不到位产生的“锅”。
<div><strong>精选留言（27）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" width="30px"><span>tt</span> 👍（46） 💬（2）<div>“框架，提现的是需求泛化的能力”。


体现需求泛化的能力，就是架构可以适应需求的变化。需求的变化就是接口的变化，因为本文说了，接口代表需求。

接口代表了要做什么，需求就是一个要做什么的集合，是目的。接口是需求的流程分解，即可以体现用户地图。

程序分为算法和数据结构，业务分为接口和业务数据，业务数据是业务的沉淀，是比框架更稳定的东西，而接口是在数据之上的动作，所以位置最高。</div>2019-11-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/87/30/4626c8c0.jpg" width="30px"><span>Fs</span> 👍（19） 💬（2）<div>定义了数据结构，但是不抽象数据的业务逻辑，直接让使用方操作成员变量，或者定义一堆成员变量的 get&#47;set 接口。

这句话含义是DDD中的贫血模型了。比如我需要判断某个实体是否是合格的，需要通过a,b 字段来判断。这个实现没有定义在数据结构里，却把a,b字段通过get暴露出去，让调用方去判断了</div>2019-11-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/db/b2/29b4f22b.jpg" width="30px"><span>JasonZ</span> 👍（4） 💬（3）<div>比框架（架构图）更重要的是数据结构，比数据结构更重要的是接口。这句话不是很认同。一般业务迭代中，接口的变化是很快的。底层数据结构和框架比接口更稳定</div>2020-07-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/09/8f/ad6039b6.jpg" width="30px"><span>沫沫（美丽人生）</span> 👍（1） 💬（1）<div>许老师好，现在有些SaaS 企业PaaS化，请问从SaaS 向PaaS 过度的关键技术是什么呢？在系统架构上两者有什么本质区别吗？望不吝赐教。</div>2019-11-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/95/2a/572fc97c.jpg" width="30px"><span>lufeng</span> 👍（0） 💬（0）<div>架构到数据结构，再到接口，是一个设计到实现的过程，接口定义了业务的逻辑，数据结构定义了领域实体，对实体的业务的动作是实体对外胡接口，多个内聚的实体构成了模块，相互独立，正交的模块构成系统，类似面向对象的领域设计理念。

感觉最核心的是实体=数据结构+接口，😄</div>2021-11-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/8d/af/01deb987.jpg" width="30px"><span>xtepCool</span> 👍（0） 💬（1）<div>用实现机制替代业务。这个什么理解呢？</div>2021-04-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/20/2d/dfa5bec8.jpg" width="30px"><span>Han</span> 👍（0） 💬（2）<div>老师，不太明白您对框架的定义，等同于架构图？ 能否解释一下。 您说的框架应该不是指那些三方的开源框架吧。</div>2020-06-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg" width="30px"><span>小喵喵</span> 👍（0） 💬（1）<div>数据结构是指的是表结构或者是实体吗？还是什么链表，栈，树之类的数据结构呢？</div>2019-11-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg" width="30px"><span>Jxin</span> 👍（10） 💬（0）<div>目前来看，架构设计套路有限，但业务领域无限。如何应用有限的套路做出无限的架构设计，难点应是在业务上。没有足够的业务背景积累和业务需求洞察，架构设计就会出现知易行难的窘境。但是想要架构师一步到位具有健全的业务领域知识也是不现实的。所以，横竖都不好，那么就落地灵活的设计，动态去演变，也就所谓的演进式架构。而代码变动是高成本的，所以要想办法降低成本。首先代码可读要高。接着，单模块内各层，以及模块间的耦合要低。最后，代码的实现要采用合适的设计模式，以便易于扩展。但这三点不取决于架构师，具体业务开发个人素养的影响更大。所以，感觉约往后，业务开发的个人素养要求会越高。至少领域设计（战略规划）和架构分层、设计模式（战术应用）的诉求怕是少不了的。</div>2019-11-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（7） 💬（0）<div>    老师今天课程中提到了一个很关键的现状：框架绑架开发。这其实是许多程序过程中经常碰到的问题：某种框架不错大家去用，可是随着业务的复杂度和需求的复杂度的增加我们会发现被框架绑架了-实现不了，然后就开始调整需求或者实现方式。
     这些年更多基于内核或者核心去改&#47;写框架的：稍微有点特色就火了；其实我们去看本质会发现，只是降低了对某些框架的绑定能力而已，当程序中一大堆框架时其实我们就被一大堆事物绑架了。框架使用的度确实是个问题：用的越深绑架越深，故而其实都是在努力的做解绑-最小需求使用。
     以上是个人的一点切身体会和薄见：一路听老师的课一路学习修正；期待老师的后续分享。</div>2019-11-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/7a/08/4d3e47dd.jpg" width="30px"><span>Aaron Cheung</span> 👍（2） 💬（0）<div>理清楚需求 列出验收标准 让一线开发理解做成啥样OK 有一些感触👍🏻</div>2019-11-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/2a/d9/d35a4864.jpg" width="30px"><span>yz</span> 👍（1） 💬（0）<div>许老师的课很有价值，是那种时时需要拿出来感悟的课程！越读感受越深！例如：1）架构就是业务的正交分解。每个模块都有它自己的业务。2）抽象出符合业务自然语义的接口，远比抽象出泛需求的框架要容易得多。因为，业务语义是稳定的。关注业务接口的定义，我们自然就把焦点转向关注业务如何由相互正交的子业务组合而来。

</div>2021-05-29</li><br/><li><img src="" width="30px"><span>Geek_88604f</span> 👍（1） 💬（0）<div>SAX模式是不是抽象的太过了，以至于丧失了应有的灵活性和业务意义？这里不是很明白</div>2020-09-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/8d/c5/898b13b4.jpg" width="30px"><span>亢（知行合一的路上）</span> 👍（1） 💬（0）<div>* 模块的接口，是架构设计的核心。在概要设计阶段，用真真正正的代码把用户故事串一遍，降低后期联调的风险。
    * 接口确定了，提供哪些功能也就确定了。
    * 把业务数据的流转也走一遍，那相当于系统就跑起来，只是很多实现是假的，但也是真实的一种体现。
    * 控制住高层的复杂度、风险，开发阶段负担就少了很多。
* 连接性的代码越少越好。
    * 也就是模块之间的交互越少越好，互相调用的接口越少越好，最好有一个模块统一管理，其它模块都不互相依赖，需要的东西以接口的方式传进来。</div>2020-04-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/ef/b9/c0c12bea.jpg" width="30px"><span>gtp</span> 👍（1） 💬（0）<div>闻所未闻的观点</div>2020-03-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/d0/4d/2116c1a4.jpg" width="30px"><span>Bravery168</span> 👍（1） 💬（0）<div>比框架（架构图）更重要的是数据结构，比数据结构更重要的是接口。
-----我的理解： 业务对象的定义包含了数据结构和数据行为逻辑，架构设计需要从业务实现的角度完整表达，数据结构表达是其中的一部分，更完整的表达体现在接口层面。</div>2020-02-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg" width="30px"><span>丁丁历险记</span> 👍（1） 💬（0）<div>本身也应该按module 来切分代码模块，最好让模块多具备正交性。</div>2019-11-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg" width="30px"><span>ifelse</span> 👍（0） 💬（0）<div>学习打卡</div>2023-10-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/cc/de/e28c01e1.jpg" width="30px"><span>剑八</span> 👍（0） 💬（0）<div>接口对外是稳定的，模型也是稳定的
这2者看哪个稳定要看是从哪个角度看，需求变化一般好的设计是模型上的扩展，接口是相对不变的
比如交易下单，这个接口在设计的时候考虑充分后就可以在后面迭代中不变，而不同的行业交易需要从模型扩展承接</div>2022-06-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/27/62/e1/764aca72.jpg" width="30px"><span>哲</span> 👍（0） 💬（0）<div>架构是对业务的正交分解，很多时候做架构是需求分析，概要设计，缺乏详细设计这个流程。详细设计非常关键，不在于一定要有文档还是什么，而在于梳理详细设计的过程，会进行需求的拆分，定义模块的边界，对每一个子业务具体做什么也会定义清楚，在此基础之下的工作，就是代码实现简单的事情了。</div>2021-11-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/98/fa/6b80ed33.jpg" width="30px"><span>Zoker</span> 👍（0） 💬（0）<div>一切都是为业务服务的，如果没法通过业务产生价值，框架的存在也只是一堆代码而已，就像没了软件，电脑就是一堆金属制品一样。</div>2021-07-07</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/ib0X7hRHD3YC1XVoUbW8nak05yJEiaZM4BkABzRnJEhI1IvkFzzGyO1UqJzdkyUVe5SQuH5tPExEMwLB1zqLdryQ/132" width="30px"><span>up</span> 👍（0） 💬（0）<div>1.架构就是业务的正交分解。正交分解这个概念非常棒，比好内聚低耦合的拆分方向深刻很多。
2. 还有基础架构和服务治理的重视很有同感，也很受启发，本书干货满满，借此感谢许老师的毫无保留的分享！
3. 所以模块的接口，是架构设计的核心。将接口和数据结构的设计也全部划分到架构师的职责上，不是很认同，两者会涉及模块多数细节，这会导致架构师和开发人员过多的沟通，协作效率急降，我的想法是，职责也应该正交分解，核心模块交由能力最强的人来做，接受周边模块可能出现的差一些的设计。回头来看架构师的职责，我的理解是负责全局架构、选型、技术难点、开发组件、开发核心模块，这块理解不够深刻，还在从许老师的书中不断学习思考 ～_～</div>2020-09-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e7/32/82939538.jpg" width="30px"><span>thinker</span> 👍（0） 💬（0）<div>接口&gt;数据结构&gt;框架(架构图)
包含业务语义的代码</div>2020-06-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/cc/de/e28c01e1.jpg" width="30px"><span>剑八</span> 👍（0） 💬（0）<div>DDD比较合适</div>2020-05-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4a/b2/6b8451c1.jpg" width="30px"><span>Expif</span> 👍（0） 💬（0）<div>目前我们这的架构师基本不做需求分析，需求分析都是SA-系统分析师在做，当SA对其中有些技术点拿不准的时候才去咨询架构师，而部分架构师就确认下什么功能放在什么系统，什么功能这个系统不应该做==，非常机械。</div>2019-12-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/d3/93/bef5a186.jpg" width="30px"><span>苟范儿</span> 👍（0） 💬（0）<div>“追求的不再是架构设计的好坏，而是打补丁，怎么把里程碑的目标实现了，别影响了团队绩效“ 。绩效真是把双刃剑，也许在做架构的时候也要充分将这些管理、协作因素考虑进去。  

“代码即文档。代码是理解一致性更强的文档。“ 现在小孩子都开始抓编程，编程语言也真正变成一种语言，与计算机沟通、与 IT 人员沟通的语言。</div>2019-12-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/52/44/de7f2b98.jpg" width="30px"><span>pines</span> 👍（0） 💬（0）<div>定好边界，提前抽象出各个子模块对接时的接口与数据，然后是各个子模块的结构。架构师之路，道阻且长</div>2019-11-22</li><br/>
</ul>