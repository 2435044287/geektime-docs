上几节课中，我们介绍了面向对象相关的知识。从今天起，我们开始学习一些经典的设计原则，其中包括，SOLID、KISS、YAGNI、DRY、LOD等。

这些设计原则，从字面上理解，都不难。你一看就感觉懂了，一看就感觉掌握了，但真的用到项目中的时候，你会发现，“看懂”和“会用”是两回事，而“用好”更是难上加难。从我之前的工作经历来看，很多同事因为对这些原则理解得不够透彻，导致在使用的时候过于教条主义，拿原则当真理，生搬硬套，适得其反。

所以，在接下来的讲解中，我不仅会讲解这些原则的定义，还会解释这些原则设计的初衷，能解决哪些问题，有哪些应用场景等，让你知其然知其所以然。在学习的时候，希望你能跟上我的思路，把握住重点，真正做到活学活用。

## 如何理解单一职责原则（SRP）？

文章的开头我们提到了SOLID原则，实际上，SOLID原则并非单纯的1个原则，而是由5个设计原则组成的，它们分别是：单一职责原则、开闭原则、里式替换原则、接口隔离原则和依赖反转原则，依次对应SOLID中的S、O、L、I、D这5个英文字母。我们今天要学习的是SOLID原则中的第一个原则：单一职责原则。

单一职责原则的英文是Single Responsibility Principle，缩写为SRP。这个原则的英文描述是这样的：A class or module should have a single responsibility。如果我们把它翻译成中文，那就是：一个类或者模块只负责完成一个职责（或者功能）。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/14/4b/4b/97926cba.jpg" width="30px"><span>Luciano李鑫</span> 👍（73） 💬（12）<div>想请教一下争哥，关于代码代码持续重构的问题，所引出的额外测试、发布成本，和故障风险应该怎样平衡呢。</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/7a/ba/791d0f5e.jpg" width="30px"><span>一壶浊酒</span> 👍（45） 💬（4）<div>老师您好，有个问题想请教下，就是您举的UserInfo的例子，在抽取了地址相关的信息到新的类的时候，原来的userinfo类中需要再添加一个新的类的属性在里面么？感觉如果根据单一职责原则了话，新的类应该独立出来，UserInfo里应该不包含该类，那在这种情况下数据库的表一般会出现变化么？不然是否会造成一个新增的用户会在保存用户信息的时候对数据库进行两次操作？一次新增用户信息，然后获取了userId再进行一次操作修改地址相关信息？还是说在userinfo中存在新的地址相关类的属性，进行直接新增操作？因为没有这方面的实际经验，所以对这个比较疑惑。老师遇到这种情况一般作何处理</div>2020-01-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg" width="30px"><span>Jxin</span> 👍（16） 💬（12）<div>回答问题：
1.不好说，职责单一这东西比较主观。得看自己对抽象出来的类的主观定义是什么。准的捏不住，但还是要把控一下范围的。
2.码出高效给出了方法行数不超过50行的一个基准标注。而我实践下来很难写出超过50行的方法，这50行还包括了大量注释。

3.方法的职责单一，业务领域的能力要单一（边界清晰）。

提问：

1.以前不代码规范不行，就逼着自己多思考，多写注释。现在养成了写注释的洁癖，不写就很难受。请问大佬，这怎么办，需要戒掉吗。我除了dao层的crud和数据类的setget外，其余方法都会带上注释。</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg" width="30px"><span>蚂蚁内推+v</span> 👍（11） 💬（3）<div>有个问题，比如有个OrderService中可能提供了各种订单查询、操作等，即一个OrderService有多个方法，是否符合SRP呢？</div>2019-12-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/56/cd/0add8290.jpg" width="30px"><span>刘学习来学习</span> 👍（5） 💬（1）<div>前段时间需要对外提供sdk,最开始的设计就是根据职责定义了多个client对象供其他系统调用，后来角色不是很友好，最后还是提供了个聚合类，将所有的接口都集中到一起对外提供了,像这种情况,有的时候不知道该参考什么来设计</div>2020-01-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/61/7d/1bd071ba.jpg" width="30px"><span>空也空</span> 👍（4） 💬（6）<div>“私有方法过多”为什么作为一个衡量标准呢？</div>2020-04-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/7b/f0/ccc11dec.jpg" width="30px"><span>Cris</span> 👍（2） 💬（3）<div>老师，我今天听到了一个概念叫面向切片编程(aop)，它和面向对象编程有什么联系呢？想听听老师的理解</div>2019-12-07</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/BIRpwViaN51yynIeFonD7QRlwDCVtKibrG956NTxzEqibOZZVjhMMgibOPmd3VicfYxpknZsic1oJq8KicZvXkmmiajuQg/132" width="30px"><span>tuyu</span> 👍（1） 💬（2）<div>小争哥, 数据库设计是不是不太适合设计那种抽象类的数据库表结构, 这样我写bo就会就会维护的很大很大</div>2020-01-01</li><br/><li><img src="" width="30px"><span>刘同青</span> 👍（0） 💬（1）<div>老师，您好，我工作中遇到的就是面向过程编程，一个接口中只有一个方法，对应一个实现，然后通过dubbo  rpc调用。。。请问如果一个接口中很多个方法，那实现类不就很复杂了么？</div>2020-05-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/6c/0c/9693fba5.jpg" width="30px"><span>L</span> 👍（0） 💬（2）<div>你好，我想问下如何在spring mvc下使用设计模式，或者说在框架下如何使用设计模式</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/c2/2e/c4a527d9.jpg" width="30px"><span>blacknhole</span> 👍（377） 💬（28）<div>在看文末的“3. 类的职责是否设计得越单一越好？”时，我惊喜地意识到：

1，内聚和耦合其实是对一个意思（即合在一块）从相反方向的两种阐述。

2，内聚是从功能相关来谈，主张高内聚。把功能高度相关的内容不必要地分离开，就降低了内聚性，成了低内聚。

3，耦合是从功能无关来谈，主张低耦合。把功能明显无关的内容随意地结合起来，就增加了耦合性，成了高耦合。</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/4f/c9/9f51fd27.jpg" width="30px"><span>编程界的小学生</span> 👍（99） 💬（29）<div>1.方法就是全凭感觉。感觉不爽，就尝试着是否可以拆分多个类，感觉来了谁也挡不住。没有硬性要求吧，都是凭借经验。比如用户service可能包含用户的登录注册修改密码忘记密码等等，这些操作都需要验证邮箱，这时候你会发现这个类就很乱，就可以把他一分为二，弄个UserService再弄个UserEmailService专门处理用户相关邮件的操作逻辑，让UserService依赖Email的，等等这种，我觉得真的是全凭经验。换句话说，屎一样的代码写多了，写到自己看着都想吐的时候，经验就积累了。
2.方法设计上也用到了，比如自上而下的编程方式，先把核心方法定义好在去写具体细节，不要上来就把所有的细节都写到一个大而全的方法里。自上而下的编程方式他不香吗？</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/50/d7/f82ed283.jpg" width="30px"><span>辣么大</span> 👍（41） 💬（10）<div>懂几个设计模式，只是花拳绣腿。掌握设计原则就才掌握了“道”。

设计你的系统，使得每个模块负责（响应）只满足一个业务功能需求。
Design your systems such that each module is responsible (responds to) the needs of just that one business function. (Robert C. Martin)

参考：https:&#47;&#47;blog.cleancoder.com&#47;uncle-bob&#47;2014&#47;05&#47;08&#47;SingleReponsibilityPrinciple.html</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/15/03/c0fe1dbf.jpg" width="30px"><span>考休</span> 👍（29） 💬（5）<div>项目初始阶段也是雄心勃勃，要把系统做出一个快速迭代、维护性高的系统，可是不断的需求变更导致开发任务过重，留给项目整体的思考和重构时间被严重压缩，最终导致项目的技术管理失控，再加上人员变动等原因，项目死亡的概率急剧上升，都是惨痛的教训。

《三体》中常伟思的父亲经常说的是：要多想。

共勉！</div>2019-12-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/62/bb/323a3133.jpg" width="30px"><span>下雨天</span> 👍（21） 💬（1）<div>回答问题
1. 类单一职责判断可以通过评估其对外提供接口是否满足不断变化的业务和需求来确定！问自己，该类是否对其他类是&quot;黑盒&quot;！

2. 类行数多=属性多+方法多
属性多: 要考虑这些属性是不是对类来说是必须的，需要移除么？
方法多: 方法间复用情况，方法间有没有写重复代码？
如上如果觉得没有可以改进的余地，就可以认为类行数恰当！

3. 单一职责还可以应用到方法，模块，功能点上！</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/78/51/4790e13e.jpg" width="30px"><span>Smallfly</span> 👍（13） 💬（0）<div>What

一个函数、类、模块只负责完成一个职责或者功能。

How

关于如何使用这个原则，不同的应用场景、需求背景、业务，对一个类职责是否单一，会有不同的判定结果。

这个说法其实很模糊，并没有多少实践上的指导意义。

定义中也存在令人迷惑的点，类由函数构成，模块由类构成（面向对象领域），如果每个函数职责单一，多个职责单一的功能函数组成一个类，那么这个类还算职责单一吗？

这里的区别在于看待职责单一的抽象维度不同，也称为职责颗粒度。

比如在函数的维度，在一个 getter 方法，只返回用户名，它是职责单一的；在用户类的维度，它还可以包含返回手机号的 getter 方法。

类也是有颗粒度的。以文中用户信息类为例，什么时候地址信息应该被作为单独类存在呢？我的结论是存在被复用的场景。

在初次设计时，可能并没有复用场景，那么都写在一个类里满足业务需求完全没问题。

但随着需求的发展，类中代码量膨胀，我们就需要根据复用性来对类进行拆分，此时单一职责原则可以作为一个指导思想。

过度使用单一职责

在设计时也不要过度使用单一职责原则，它会使得功能点不够内聚，增加维护成本。如果一个类，始终是作为整体被使用，即使它包含多种功能，放一起也可以。

当我们只想使用类的某一部分功能，又觉得其它功能鸡肋的时候，再考虑拆分也不迟。

Why

单一职责原则，是前辈在代码时间中的经验，将某一类经验抽象为这个名字。这个原则主要目的是为了，实现高内聚、低耦合、提高代码的复用性、可读性、可维护性。</div>2019-12-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/ef/89/8c73a24d.jpg" width="30px"><span>Chen</span> 👍（11） 💬（3）<div>Android里面Activity过于臃肿会让感觉很头大，MVP,MVVM等框架都是为了让Activity变得职责单一。</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7e/bb/947c329a.jpg" width="30px"><span>程序员小跃</span> 👍（8） 💬（0）<div>因为学习设计模式，前几天刚和朋友在聊，说其实每个类的代码行数和函数的行数最好都需要控制下，能精简就精简，完成我们理解的重构。

刚好，今天就看到老师说的这个，赶紧分享给朋友，盛赞了这门课，哈哈</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/23/a1/b08f3ee7.jpg" width="30px"><span>何妨</span> 👍（7） 💬（4）<div>我有个问题，就用户地址的设计来说，后续功能扩大再拆解是不是违反了开闭原则呢？而且后期拆分会比较影响现有业务逻辑吧，这个如何平衡呢？</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/44/a7/171c1e86.jpg" width="30px"><span>啦啦啦</span> 👍（7） 💬（1）<div>单一职责原则也可以用在服务上的拆分上</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/37/3f/a9127a73.jpg" width="30px"><span>KK</span> 👍（6） 💬（0）<div>相关的“在一起”，叫内聚，不相关的“在一起”，叫耦合。</div>2020-04-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/67/01/44626cb9.jpg" width="30px"><span>爱水人家</span> 👍（6） 💬（0）<div>个人感觉码代码就像语文中的写文章，而设计原则就像一条条需要考虑的原则。用好了这些原则我们就可以写出好的文章。文章写多了，心得体会出来了，设计原则就熟门熟路了。
感觉在没学这些原则之前，都能感觉到自己码的代码布局有问题。学了之后，更能知道问题在哪里了，需要怎么修改了！</div>2019-12-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/fa/ab/0d39e745.jpg" width="30px"><span>李小四</span> 👍（4） 💬（0）<div>设计模式_15
# 作业：
单一职责也可以用于方法的编写，在维护多年的项目中，我们会看到一些非常“庞大”的方法，这些方法的功能比它的命名丰富很多，它是一次次地改成了这个样子。本来是一个职责单一的简单方法，由于需求的变化，可能是方法被调用太多(不敢改)，也可能是框架设计(不能改)导致只能在方法内部添加特殊业务的判断条件，这样下来，这个方法就变得难以理解且难以维护。

# 感想
同事们也常讨论单一职责的边界, 始终没有一致的结论。今天的内容也坚定了观点，业务的发展一定程序决定了耦合的边界。
我们学习前人总结的这些原则，目的是什么呢，我今天的感受是，系统性地降低工作量和出错概率。
- 降低工作量：我们要尽量保证，随着需求的增加，工作量的增加是线性的，而不是指数级的。据我了解，维护一些老代码的同学们，一直被产品同事质疑：就这么点功能，要做这么久吗？？？
- 降低出错概率：就像文中的序列化的例子，强行把序列化与反序列化方法拆开，会导致使用者需要花更多的时间来做一些同步的工作，如果文档不够清晰，或者阅读文档不够仔细，就会导致出错；有这样代码结构的系统，运行足够长的时间，一定会出更多的错误。</div>2019-12-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/ca/c7/00e544c2.jpg" width="30px"><span>黄林晴</span> 👍（4） 💬（0）<div>打卡✔
安装ali规范插件，看到报警告的就按照规范修改，不过这个规范是死的，有时候和实际应用不同，不过大部分规范还是可以遵循的</div>2019-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/74/68/3725546b.jpg" width="30px"><span>Carlos</span> 👍（3） 💬（0）<div>1、判断类职责是否单一，其实有个挺客观的方法就是，如果类的对象在现有系统中任何一个地方出现都会带上，或者隐性带上所有的属性，那么这个类的职责就是单一。以用户类为例，系统中凡是出现用户的地方，都应显示，或者隐性显示出用户姓名、性别、年龄、地址等这些属性，那么这个类职责就是单一的；如果有些场景只强调带上用户账号密码，有些场景只强调带上用户地址信息，如果出现了其他更为详细的信息功能就错误了，那么这个类就需要拆分了。如果设计者依然要站在用户类这个角度将他们组织在一起，首先违背了接口隔离的原则，其次这样的类后期BUG产生几率也高了，因为有好多不相干场景都要来修改同一个类。
2、单一职责除了应用到类的设计上外，其实软件系统设计的方方面面都要应用代单一职责，包括模块设计呀，前端组件设计等，所有设计中，如果把多个不相干的东西放到一个，都会带来上面提到的问题，但如果将原本就是一个整体的东西拆分了，也会带来问题，假如以人这个对象来说，客观世界中一个健全的人都包括五官和四肢，如果映射到程序对象中，将他们拆开了，或者少了个部件，首先和客户世界不符了，其次也为后期其他同事的理解和维护带来了困难。</div>2020-06-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/20/82/1e/f3cb3d57.jpg" width="30px"><span>超越自我</span> 👍（2） 💬（0）<div>一生二，二生三，三生万物。万物生发过程必然是一个拆分的过程。拆是为了高纬度的合。类的拆分，微服务的拆分，负载均衡，读写分离，分库分表，分布式系统；细胞分裂，大树开枝散叶，羊群壮大;公司部门划分；百家姓,多民族,一国两制等等。这些拆分的个体都是服务于高纬度的整体。当然这个拆要有度，要遵守自然规律，历史大势，不能违背。度很关键。
</div>2020-08-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/e2/c0/09cef977.jpg" width="30px"><span>润！</span> 👍（2） 💬（0）<div>课程讲得是真的不错，值得购买</div>2020-07-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ba/4d/7ba09ff0.jpg" width="30px"><span>郑童文</span> 👍（2） 💬（0）<div>推荐一个很好的免费资料, NEU Program Design Paradigms课程的网站:
https:&#47;&#47;course.ccs.neu.edu&#47;cs5010&#47;index.html
Lecture部分写得很细致,还有作业</div>2019-12-07</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/GUYEdkZwS6icOYHPhwhkXNsxficiaoDnxRbXibgS6iakpIwiajN6UMb8oDucMaiaORaPqRkyaCL84ApaiaRKPwiaKPDzTXA/132" width="30px"><span>士心23</span> 👍（1） 💬（0）<div>1，没有了，老师说的很全面了
2，除了类设计的单一，还有类方法的职责单一，有的方法负责组合逻辑，有的方法负责实现算法逻辑，一个方法我一般是不会让它超过20行的，基本就是一屏幕，该抽取方法的代码要抽取成方法，在改代码时看到长代码，顺手会改下</div>2024-07-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/24/2c/c6/416bd86e.jpg" width="30px"><span>阿杰</span> 👍（1） 💬（0）<div>小结一下：
1、单一职责原则：某个模块或者类只负责一个职责（功能）。
2、如何判断类的设计满足单一职责原则：得结合业务需求来看，从不同的业务功能的角度来看，同一个类的设计可能会得出不同的答案。没有万能公式能套用，更多的时候还是根据经验及结合业务对代码的理解。
3、辅助方法判断：
* 当你发现类中的方法、函数、属性多且杂，让你眼花缭乱时，你维护一个功能纠结半天也找不到或者不知道该用哪个函数时，这时可以往这方面想想。
* 当你很难命名一个类时，代表你它的定义是模糊的，不清晰的，可能让它扮演了太多了角色。
* 当本类的依赖类很多时（其实这一点也不满足，软件设计的要求---高内聚，低耦合）
* 当本类的函数很多都集中操作本类的那几个属性时。
4、辩证思考：
虽然单一职责很妙，但凡事都要有个度，使用过度，一个类中想关联的方法，硬拆成两个类，反而会适得其反，降低类的内聚性，反而使得代码不易维护。</div>2024-04-03</li><br/>
</ul>