你好，我是华仔。

我们架构课的[第18讲](https://time.geekbang.org/column/article/8697)和[第19讲](https://time.geekbang.org/column/article/8805)主题是单服务器高性能模式，我们讲了PPC与TPC、Reactor与Proactor，从理论上跟你详细讲述了不同模式的实现方式和优缺点，但是并没有给出详细的测试数据对比，原因在于我自己没有整套的测试环境，也不能用公司的服务器做压力测试，因此留下了一个小小的遗憾。

幸运的是，最近我在学习的时候，无意中在网络上找到一份非常详尽的关于Linux服务器网络模型的详细系列文章。作者通过连载的方式，将iterative、forking（对应专栏的PPC模式）、preforked（对应专栏的prefork模式）、threaded（对应专栏的TPC模式）、prethreaded（对应专栏的prethread模式）、poll、epoll（对应专栏的Reactor模式）共7种模式的实现原理、实现代码、性能对比都详尽地进行了阐述，完美地弥补了专栏内容没有实际数据对比的遗憾。

因此我把核心的测试数据对比摘录出来，然后基于数据来进一步阐释，也就有了这一讲的加餐。我想第一时间分享给你，相信今天的内容可以帮助我们加深对课程里讲过的理论的理解。

下面是作者对7种模式的性能测试对比结果表格，作者在文章中并没有详细地介绍测试环境，只是简单提到了测试服务器是租来的云服务器，**CPU只有1核**（没有说明具体的CPU型号），对于内存、带宽、磁盘等信息并没有介绍，我们假设这些硬件相关性能都足够。从理论上来说，网络模型的核心性能部件就是CPU，因此如下数据是具备参考意义的。
<div><strong>精选留言（8）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/1c/28/aa/06c12256.jpg" width="30px"><span>两只狮子</span> 👍（9） 💬（1）<div>华哥，请教一下concurrence列下面的数据是指的绝对并发数还是指的每秒的请求量呢？</div>2021-02-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/ca/a5/43c42afe.jpg" width="30px"><span>YHK</span> 👍（4） 💬（1）<div>prethread 好强啊。比 poll和select都强，那epoll没出来之前，怎么还有人用多路复用</div>2021-05-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/9d/c0/cb5341ec.jpg" width="30px"><span>leesper</span> 👍（4） 💬（1）<div>我用Go写过一个网络库，得益于Go语言的强大，我对每个网络连接开了三个goroutine，一个负责读，一个负责写，一个负责配合工作者线程执行业务逻辑，但我一直想写一个基于epoll的网络库出来，https:&#47;&#47;github.com&#47;leesper&#47;tao</div>2021-01-13</li><br/><li><img src="" width="30px"><span>Geek_798202</span> 👍（1） 💬（1）<div>看了老师的分析后，反思自己对技术太浅尝辄止了，只是做到了理解，然后缺少总结和实践，后面希望自己能加强学习，认识到差距</div>2023-09-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7c/59/dc9bbb21.jpg" width="30px"><span>Join</span> 👍（1） 💬（1）<div>太棒了华仔, 之前看Linux高性能服务器开发中提到Reactor模式,可以没有测试数据支撑,这下可以弥补这个缺失了</div>2022-03-10</li><br/><li><img src="" width="30px"><span>Geek_c25f25</span> 👍（1） 💬（1）<div>神文，都说reactor模式好，但是到底怎么个好还是要有测试数据支撑。老师的分析能力好强大啊，特别是redis,c10k这两个分析真的太精彩了，其他地方看不到这两个情况的分析。</div>2021-12-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/5f/90/711efc88.jpg" width="30px"><span>FuriousEric</span> 👍（0） 💬（1）<div>老师，请教下，表格中concurrency(并发连接数)这栏，作者是使用什么工具模拟这么多并发连接数的呢？也就是用啥工具测试的能产生这么多concurrency, 一般我做测试，用wrk, connections设置20个左右。但是图中concurrency高达1w+，是怎么模拟出来的？</div>2022-08-02</li><br/><li><img src="" width="30px"><span>Geek_c25f25</span> 👍（0） 💬（1）<div>从表格中发现另外一个数据，不管并发连接数是多少个，从epoll的数据看，都是2000+一点，也就是这个系统的QPS只能达到2000+。</div>2021-12-01</li><br/>
</ul>