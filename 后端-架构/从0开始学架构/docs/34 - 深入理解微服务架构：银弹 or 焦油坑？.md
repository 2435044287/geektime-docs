微服务是近几年非常火热的架构设计理念，大部分人认为是Martin Fowler提出了微服务概念，但事实上微服务概念的历史要早得多，也不是Martin Fowler创造出来的，Martin只是将微服务进行了系统的阐述（原文链接：[https://martinfowler.com/articles/microservices.html](https://martinfowler.com/articles/microservices.html)）。不过不能否认Martin在推动微服务起到的作用，微服务能火，Martin功不可没。

微服务的定义相信你早已耳熟能详，参考维基百科，我就来简单梳理一下微服务的历史吧（[https://en.wikipedia.org/wiki/Microservices#History）：](https://en.wikipedia.org/wiki/Microservices#History%EF%BC%89%EF%BC%9A)

- 2005年：Dr. Peter Rodgers在Web Services Edge大会上提出了“Micro-Web-Services”的概念。
- 2011年：一个软件架构工作组使用了“microservice”一词来描述一种架构模式。
- 2012年：同样是这个架构工作组，正式确定用“microservice”来代表这种架构。
- 2012年：ThoughtWorks的James Lewis针对微服务概念在QCon San Francisco 2012发表了演讲。
- 2014年：James Lewis和Martin Fowler合写了关于微服务的一篇学术性的文章，详细阐述了微服务。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="" width="30px"><span>Tom</span> 👍（34） 💬（1）<div>我们公司的实践是比较粗粒度的子系统或服务，基本上没有太细粒度的微服务，以webapi为主。感觉更像微服务架构，只是服务粒度比较粗，从概念上算是SOA还是微服务架构呢？</div>2018-08-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/87/57/645159ee.jpg" width="30px"><span>鹅米豆发</span> 👍（155） 💬（10）<div>对于一个新事物的诞生，本能地套用已有的知识。特别是一个并不简单的东西，这算是一种高效的入门方法。微服务架构其实相当复杂，我是分成好几个阶段理解。
1、第一阶段，微服务架构就是去掉了ESB的SOA架构，只不过是通信的方式和结构变了。对于初级的使用者而言，这样理解没有太大问题。
2、第二阶段，没有了ESB，原本很多由ESB组件做的事儿，转到服务的提供者和调用者这里了。他们需要考虑服务的拆分粒。大体仍然算是SOA架构。
3、第三阶段，随着服务的数量大幅增加，服务的管理越来越困难，此时DevOps出现了。这个阶段的微服务架构，已经是跟SOA架构完全不同的东西了。
之前给一家大国企分享过一些经验。他们想从传统架构，转向微服务架构。
1、建设好基础设施，RPC、服务治理、日志、监控、持续集成、持续部署、运维自动化是基本的，其它包括服务编排、分布式追踪等。
2、要逐步演进和迭代，不要过于激进，更不要拆分过细，拆分的粒度，要与团队的架构相互匹配。（康威定律）
3、微服务与数据库方面，是个很大的难点，可以深入了解下领域驱动设计，做好领域建模，特别是数据库要随着服务一起拆分。
说完上面这些，他们的研发负责人说，我说的跟他们的架构师说的不一样，他们的架构师说，微服务就是各种拆分，不顾一切地拆分。</div>2018-07-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ed/68/737f97c8.jpg" width="30px"><span>ant</span> 👍（37） 💬（4）<div>我们是一家社交公司，后端加厚的演变符合dubbo官网的那张图，在Mvc架构坚持了一年后，业务越来越大，工程越来越臃肿。后面我们一致同意进行服务话，开始用了dubbo。后面由于决策层的原因没有上，后面来了个架构师，又重启了服务拆分，到现在已经用于生产。我们使用的是Spring cloud，现在拆分暴露了很多问题:
1、个别服务没有熔断出来，出现过雪崩效应
2、服务拆分过细，服务调用链过长
3、开发人员能力不一样，代码水平不一样
4、没有监控措施
5、每个服务部署多台，日志查询就会死人的感觉
6、开发过程中经常出现访问不到该访问的接口，这是因为开发人员经常启动本地服务，就会导致30%的概率访问不到
7、使用了不合理的持久层框架，使用了JPA访问
大概就有上面的问题，总之微服务不是银弹，用得不好会发现无穷无尽的坑。当然，出现问题解决问题就是了。唯一的就像CEO说的: 你们他妈的是完全在拿用户当小白鼠使用</div>2018-07-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/a1/d7/fb836ffc.jpg" width="30px"><span>三棱镜</span> 👍（22） 💬（2）<div>我们目前全部微服务，踩坑踩了不少，拆分服务同时要把自动化运维系统和多维度监控系统，包括问题定位跟踪系统建立起来，要不然拆了就是噩梦。</div>2018-08-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/1d/8e/0a546871.jpg" width="30px"><span>凡凡</span> 👍（17） 💬（1）<div>说到微服务，切分的粒度和基础设施都致关重要。

经历的项目有创业初期的单体服务，也有不太完善的服务切分的系统，也有微服务基础设施相对完善的公司。

单体服务致命就致命在随着项目的发展，项目会越来越臃肿，越不利于扩展开发。

微服务过程怕就怕基础不完善，人员配备不够盲目切分，导致工程师开发和维护的战线拉长，特别疲惫和泄气，容易产生一种抱怨的大气氛，从而导致微服务失败，重新合并一部分服务。

微服务做的好的，也有所经历，公司的基础设施完全云化和统一管理，申请几台机器，一套缓存集群，一套mq，sql&#47;nosql…特别容易，工程师愿意建独立的工程，因为很容易构建和部署。这种感觉有点像svn和git，git建分支特别轻量，大家都愿意用分支管理自己的代码，迭代开发，应急处理都能自由切换，得心应手。

现在遇到一个问题，就是微服务内部系统大多使用rpc，但对接外部系统，或者跨外网传输到客户端就需要http-rest类的协议。也就是我们常说的网关，如果是纯http就很容易做到通用的转发机制，但是http转rpc就不知道有什么方式可以做到通用转发了，内部每增加一个rpc，网关就需要增加一个对应的服务处理逻辑。不知道，这个问题，有没有好的解决办法？</div>2018-07-16</li><br/><li><img src="" width="30px"><span>木头旮瘩</span> 👍（16） 💬（2）<div>让我想起了一次面试经历，一家小公司，技术团队大概7 8个人，然后他们要进行微服务架构改造，我问他们:你们这样满足康威定理么？他们一脸懵逼……我就果断闪人了</div>2018-12-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/fe/c5/3467cf94.jpg" width="30px"><span>正是那朵玫瑰</span> 👍（13） 💬（3）<div>我们的业务也算是微服务吧，	接手项目时，已经有好多服务，主要采用的语言有java，php，nodejs，存在以下问题：
1、没有一个统一的网关服务，前端请求后端服务都需要后端的服务A来充当安全校验，权限校验等，A服务充当了多重职责，变的职责不明确了，后来抽出网关系统，负责平台统一的流量入口。在构建微服务网关系统是至关重要的。
2、监控系统不完善，调用链跟踪，异常报警都不完善，对微服务是巨坑，查找问题如同一场噩梦，调用链很长，一旦发生异常不知道到底哪里出现问题，得一个一个去找。后来慢慢完善，变得好了很多，问题很快定位。
3、加入网关后，没有一个统一的服务发现注册中心，网关的路由依靠人工手动配置，变的很麻烦，也很容易出错。后来引入consul，得到改善。</div>2018-07-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e1/a9/64a2fe3a.jpg" width="30px"><span>子清</span> 👍（11） 💬（1）<div>我们公司的平台就是使用微服务架构，十多二十个微服务，但是没有自动化部署，监控，自动化测试这些，而且每次报错日志也特别难找，但是我们那架构师却不重视这些，只想继续升级平台的功能</div>2018-07-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/24/26/58/141fd7df.jpg" width="30px"><span>修仙中</span> 👍（8） 💬（3）<div>我们之前5个人的小团队，老板一拍脑袋玩起了微服务。整了spring cloud那一套全家桶：
现有业务拆拆拆，什么注册中心，配置中心，链路追踪，网关，ELK统统往系统里面堆。
主要的带来了以下问题：
1、运维成本过高，部署物数量多、监控进程多导致整体运维复杂度提升。
2、接口大量的兼容版本
3、网络延迟，服务容错，可用性，负载复杂性大大提升
4、还引入了分布式事务
团队没有运维，我们只能硬着头皮上，自己用docker搭redis集群，mysql集群，mq集群，es集群
最终因为不够钱买服务器，整个叫停了，哈哈哈哈哈</div>2020-12-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/7b/36/fd46331c.jpg" width="30px"><span>Jussi Lee</span> 👍（8） 💬（2）<div>我们项目之前是把数据采集，和展示都是我们Java组去写的。后面公司为了统一，把采集部分交给了.net组。我们Java只负责数据展示。但是我们这边又按照领导的要求把整个业务拆分为模板解析层-》api层——》终端层。现在每次最烦的事就是找bug。一直感觉现阶段我们的任务和目标没有这么庞大，这与架构中的简单和合适原则想违背。搞的整个项目组一直在反复的开发工作中。都很心累</div>2018-09-18</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLwSoTjHPX5tm4whBSfoZLX6toZxrZGUaLABQywKNf4MDc9toK3QSV7Z99ATcGicFCysoleQ5ISzmw/132" width="30px"><span>乘风</span> 👍（7） 💬（1）<div>16年时，架构师引入了微服务架构，架构设计分为三层：网关层、业务处理层、数据处理层（getaway-&gt;ls&gt;ds），自上而下依赖，业务层之间也互相依赖，构建过程中发现引入了分布式事务和调用链长（调用链的消耗时间无法接受），经常无故报错，定位问题慢，测试复杂等问题，而我们的大多数业务相对简单，所以重新划分服务粒度，分为两层：网关层：提供路由功能，业务处理层：处理请求，业务层中间可以相互调用，当出现有出现分布式事务时，采取MQ或者更新状态的方式解决，如果是充值+业务订单的这种会直接在一个事务里处理（其实这里就混乱一点了），层与层之间没有完全隔离，但是将调用链缩短，我觉得采用微服务架构确实解决了单体应用的一些问题，如资源问题（但消耗资源是比以前多的）、耦合问题、快速迭代问题，服务与服务的职责更加清晰，不同的服务粒度设计的系统是天差地别的。</div>2018-12-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/af/ee/5235ebfa.jpg" width="30px"><span>Daniel大东</span> 👍（6） 💬（1）<div>能否来一篇中台战略和微服务的文章？</div>2019-06-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/7f/ec/6cbc04d3.jpg" width="30px"><span>冬阳(Wolfer Chen)</span> 👍（6） 💬（2）<div>我个人比较认同康威定律，微服务的拆分粒度一定要和组织结构匹配起来，组织结构和开发管理模式是微服务粒度的最重要参考指标之一。</div>2018-11-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d3/3c/ab6425f7.jpg" width="30px"><span>hello</span> 👍（6） 💬（4）<div>我记得有一次做业务，当时不知道什么原因，整体使用微服务，当时是个新业务，完全从0开始，没有任何用户基础，当时按照业务把服务拆成了7.8个微服务，但没有自动化，服务还是部署在一台机器上，服务之间也没有服务治理，服务之间的调用链很长，开发就4.5个人，定位问题花费时间长，典型的基础服务也跟不上。现在想想，当时团队不知道咋想的，觉得微服务比较新就上了，完全没有考虑到产生的问题。还好后来这块业务黄了。要不然估计坑更多。对于创业公司来说，刚开始的时候，其实一个服务就够了，真等用户上来了，业务有希望了，那时候再上其他架构模式也不迟，忌讳一开始就求新求全，说到底，对于大部分公司来说。技术是为业务服务的。</div>2018-08-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/06/81/28418795.jpg" width="30px"><span>衣申人</span> 👍（5） 💬（1）<div>同问:dubbo和motan这类rpc框架，是微服务框架？？</div>2018-07-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/c5/68/7afb7304.jpg" width="30px"><span>narry</span> 👍（5） 💬（1）<div>我弄微服务遇到最大的坑，就是jvm与docker兼容性不好，导致每个微服务会消耗过多不必要的内存，我感觉从资源消耗上来说，java开发的微服务都不能算是微服务了，最近在转向go来改造</div>2018-07-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg" width="30px"><span>Demon.Lee</span> 👍（4） 💬（4）<div>一个服务调用好几个微服务，如何保证事务一致性啊，愁死了，每个微服务属于不同的业务子系统，独立的数据库，数据一致性有好的实践么</div>2019-05-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/5b/30/9dcf35ff.jpg" width="30px"><span>森林</span> 👍（4） 💬（1）<div>概念是会一直演化的，我相信最初的SOA的概念就是作者所说的形式，但是仅仅从&quot;面向服务的架构&quot;这几个字来说，难道他就不能是微服务的超集么？在微服务名字出来前，用dubbo的系统是怎么称呼其架构的？微服务定义一开始还要求一定是基于Rest的，难道用dubbo的就不是了？所以个人觉得，理解历史可以，但限定于SOA就一定是基于ESB做协议转换联通各个系统的一种架构是不妥的。</div>2018-09-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/a1/e6/50da1b2d.jpg" width="30px"><span>旭东(Frank)</span> 👍（4） 💬（2）<div>个人觉得SOA只是提出了面向服务的编程，到但没有对服务粒度的定义，以及服务的治理问题做深入的分析。
提出微服务主要是为了解决面向服务架构后如何能够在实际工程中带来真正的红利。
微服务对SOA的技术关键点给出了指导意见。


微服务对分布式服务的诱惑力的确很大，但做但微服务都不会免费的，需要很多的基础设施来做铺垫和基石，才有可能搞定。

除了基础设施还有很多设计思想需要学习，我觉得DDD就是微服务的绝配。

</div>2018-08-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/cf/bb/22af0e52.jpg" width="30px"><span>孙振超</span> 👍（3） 💬（1）<div>之前是一个系统承载所有功能，对应几十个开发，每次的发布都会有一个痛苦的冲突解决的过程。

采用微服务首先是理念转变的过程，从一个系统一个数据库切分为多个系统多个数据库，确实会给问题定位排查带上很大的麻烦，每次一个业务功能的更迭需要多个系统共同参与，中间的需求宣讲、排期、联调、确定发布依赖和发布计划增加了不少工作量。

个人认为最为重要的要有包含全方位立体的监控、链路排查、服务依赖、jia包依赖、服务器部署结构等能力的强大的基础设施，这将极大的提升整体效率。</div>2018-09-09</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/7P4wtgRQt1l0YQlVOtiaUKey2AFZqQCAcABzdCNTP0JR027tkhVkRYgj1iaYF8OlqsE8j6A6icsAvYHIAX8E31WNg/132" width="30px"><span>killer</span> 👍（2） 💬（1）<div>我经历了初创公司到公司高速发展再到公司衰退，聊聊我们踩过的坑吧。
1、团队初期，为了快速验证业务价值，快速上线，整个团队都在单体应用上开发，业务需求较多团队10来个人冲突已经比较严重了，开发--&gt;发布经常遇到合并代码遗漏代码问题；

2、业务发展越来越好发现在单体服务中迭代已经是举步维艰了，这时候想着拆服务，当时觉得微服务很牛逼，但是理解并不深刻。开发语言是golang，所以想了一个骚操作，就是 go get 引包的方式，把其他模块代码逻辑引入造成耦合严重（服务之间调用舍弃了http和rpc），这种方式开发巨快也为我们后来埋下了非常严重的技术债务（一年内我们团队20人发展到了160+个服务）；

3、后来适应公司发展，团队规模缩小，160+的服务落到了我们团队，团队12人。虽然有一些模块不在迭代，但是也根本维护不过来，很多服务不知道啥背景、啥业务，开发一个迭代少则几个服务，多则几十个服务一起发布，研发-&gt;测试-&gt;运维都痛苦不堪；

4、后面发现越来越不对劲，2年时间我做了服务治理，做了服务合并，下线了110+的服务（这段时间真的痛苦，制定目标每周跟进拉着全团队拼命干），到目前为止我们团队剩下40左右服务（有一大批是低价值业务也不迭代了），核心服务不超过15个，后来发现很多成本都降低了，比如：开发测试成本、硬件成本、运维成本等。

微服务拆分的好，一定是可以提升性能、稳定性、研发效率的，但是拆分不好就是煤焦油。。。</div>2024-11-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/6b/56/37a4cea7.jpg" width="30px"><span>单朋荣</span> 👍（2） 💬（1）<div>云原生算不算是微服务的最佳实践？</div>2023-07-31</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKlqvEticcIia5JMNgV8sNcjRv2kXXX35MxID6XKDzoG5ZGIic5gaAoS6ia8qystVwPrDsFB21a9Ft1HA/132" width="30px"><span>Geek_8ddf3c</span> 👍（2） 💬（1）<div>微服务过于精细和笨重，不适合中小型公司</div>2022-11-20</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eozpyAUaM6ra1hqeIsd4v0fulS4zVmxDM3LQyqGo0BFM141QpQnSib6oHdQricGrRxusp5rflGn54ew/132" width="30px"><span>甜宝仙女的专属饲养员</span> 👍（2） 💬（1）<div>没有基建是做不好微服务的，微服务只有两个，一个是书上的几个简单服务的单机玩玩，另一个就是基建上构建的微服务复杂王国</div>2022-11-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/b5/3c/967d7291.jpg" width="30px"><span>艺超(鲁鸣)</span> 👍（2） 💬（1）<div>遇到两个典型问题，第一个，由于某个服务响应慢，再加上不合理的重试，导致一系列级联反应，最终整个系统挂掉了。第二个，也是很有意思，A微服务调用B微服务的接口，结果B微服务接口实现中又依赖了A服务，这个问题很容易导致自己把自己打挂的情况发生</div>2022-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/5d/73/742097e2.jpg" width="30px"><span>joseph.herder💭.</span> 👍（2） 💬（1）<div>李老师对service mesh怎么看？</div>2018-08-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4b/d4/b7719327.jpg" width="30px"><span>波波安</span> 👍（2） 💬（1）<div>我们用的是dubbo。最开始系统要快速上线，所以服务拆分的不彻底。订单，商品，店铺等这些服务都没有进行拆分。就把支付和营销两个服务拆分出来了。服务拆分不彻底经常导致一个业务有问题。整个系统都用不了。</div>2018-07-15</li><br/><li><img src="" width="30px"><span>陈峰</span> 👍（1） 💬（1）<div>我认为，我在的小团队不适合用微服务，之前只有试水过。

目前我主导的项目，直接完全不考虑微服在做，当然我也hold不住。

在我的观点里

微服在代码组织上，实际上和拆模块没有什么本质的区别，仅仅是为了编码和隔离服务之间的编码影响，完全没必要使用微服务，直接maven拆模块即可。

我认为，微服能写好的前提是，单体项目模块化写法能做到信手拈来。最终的微服实现，代码层面就相当于将模块单独拆分出去。

微服本质上是为了解决一个问题，也就是最初讲的，任务分解，通过任务分解来提高系统的性能。

所以，我认为没有以上需求的场景完全不用拆分微服，而且大多数中小型项目可能集群就可以解决性能需求的话，也没必要拆分微服。

感觉微服对比单纯的计算高性能集群，复杂度会上升特别多。</div>2023-10-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/37/1b/82310e20.jpg" width="30px"><span>拿笔小星</span> 👍（1） 💬（2）<div>总计一下，老师看对不对。
SOA，更多是思考如何把企业里的众多的异构系统整合起来，互相通信，提高服务效率。因此，设计出了ESB这个组件。他这里的服务更多是指，一个个单体应用。即，每个服务都是可以独立对外提供服务的。我理解，SOA的提出更多是为了解决传统企业的软件服务不好互相协作的问题。出发点是为了解决历史包袱。所以，他是现有了系统，再用SOA去把这些系统整合。

微服务设计基本不需要考虑历史包袱，他是先设计，把大单体应用按业务领域拆分出一个个服务，然后通过BFF层整体对外提供服务。其中的每个领域服务无法独立对外提供服务。然后服务间通过更轻量的通信方式通信即可

</div>2023-03-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/7a/f5/54a5084b.jpg" width="30px"><span>简单猫</span> 👍（1） 💬（1）<div>还是根据实际是业务情况来吧。
最早是net MVC架构，业务各做各的，后来发现业务有重合，就把业务层抽离了一层 其实也就是说的web api化，同一个业务同一个人维护就好了，而不是每个人都要去了解业务并从新开发一次。后来尝试了一下微服务架构发现完全没必要，业务量集没起来，一共就2台服务器，一台数据库，一台web服务器。分个鬼微服务，个人认为接口化就满足了要求，正好也方便以后真有需求扩展成微服务架构</div>2022-03-21</li><br/>
</ul>