计算高可用的主要设计目标是当出现部分硬件损坏时，计算任务能够继续正常运行。因此计算高可用的本质是通过冗余来规避部分故障的风险，单台服务器是无论如何都达不到这个目标的。所以计算高可用的设计思想很简单：通过增加更多服务器来达到计算高可用。

计算高可用架构的设计复杂度主要体现在**任务管理**方面，即当任务在某台服务器上执行失败后，如何将任务重新分配到新的服务器进行执行。因此，计算高可用架构设计的关键点有下面两点。

1.哪些服务器可以执行任务

第一种方式和计算高性能中的集群类似，每个服务器都可以执行任务。例如，常见的访问网站的某个页面。

第二种方式和存储高可用中的集群类似，只有特定服务器（通常叫“主机”）可以执行任务。当执行任务的服务器故障后，系统需要挑选新的服务器来执行任务。例如，ZooKeeper的Leader才能处理写操作请求。

2.任务如何重新执行

第一种策略是对于已经分配的任务即使执行失败也不做任何处理，系统只需要保证新的任务能够分配到其他非故障服务器上执行即可。

第二种策略是设计一个任务管理器来管理需要执行的计算任务，服务器执行完任务后，需要向任务管理器反馈任务执行结果，任务管理器根据任务执行结果来决定是否需要将任务重新分配到另外的服务器上执行。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/de/17/75e2b624.jpg" width="30px"><span>feifei</span> 👍（169） 💬（5）<div>计算高可用架构，主要解决当单点发生故障后，原本发送到故障节点的任务，任务如何分发给非故障节点，根据业务特点选择分发和重试机制即可，不存在数据一致性问题，只需要保证任务计算完成即可
存储高可用架构，解决的问题是当单点发生故障了，任务如何分发给其他非故障节点，以及如何保障数据的一致性问题。
所以存储的高可用比计算的高可用的设计更为复杂。</div>2018-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/cf/bb/22af0e52.jpg" width="30px"><span>孙振超</span> 👍（82） 💬（5）<div>在学习课程的过程中，发现作者是把很多的学习方法给融合到自身之中，变成了自己的东西，从知道变成了成为。比如本次的习题，通过对计算高可用和存储高可用的对比，就是很好的一个例子。

要想高可用就离不开冗余，无论是计算高可用还是存储高可用都会面对机器状态检测、切换以及机器选择的问题，在这几个方面二者复杂度差别不大。

但对于计算而言，集群中的机器间之间基本上是无交互的，对于需要重试的计算任务，是有任务管理器来维护处理；而存储高可用还会涉及到机器之间数据的同步和一致性问题，在同步时还需要考虑性能、稳定性、同步中断、个别失败、重复同步等问题，这一块就会复杂许多。
因而，总体来看，存储高可用更为复杂。
</div>2018-08-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/2f/c5/aaacb98f.jpg" width="30px"><span>yungoo</span> 👍（42） 💬（2）<div>计算高可用系统需考虑safety和liveness，而存储高可用除了需考虑safety和liveness，还受CAP约束</div>2018-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/c3/c2/5ff554d9.jpg" width="30px"><span>@</span> 👍（28） 💬（2）<div>计算无状态，存储有状态</div>2019-07-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/d4/c2/910d231e.jpg" width="30px"><span>oddrock</span> 👍（27） 💬（1）<div>存储高可用比计算高可用要复杂的多，存储高可用是有状态的，计算高可用一般解决的都是无状态问题，有状态就存在着如何保存状态、同步状态的问题了</div>2018-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/22/57/cf35d10c.jpg" width="30px"><span>Johnny.Z</span> 👍（10） 💬（1）<div>任务分配器挂了是不是高可用计算就没办法保证了，任务分配器是否也要弄成集群呢？</div>2018-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/9d/4b/e1ec92c7.jpg" width="30px"><span>李同杰</span> 👍（8） 💬（1）<div>存储高可用需要考虑数据复制的问题，复杂度高于计算高可用架构。</div>2018-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/a8/1b/ced1d171.jpg" width="30px"><span>空档滑行</span> 👍（5） 💬（1）<div>计算高可用复杂在选择算法，随着集群规模的扩大，复杂性增加的不明显。比如负载均衡如何判断节点可用，如何判断任务失败还是只是时间较长。
存储高可用除了面临计算高可用同样的问题在，还要考虑数据的同步，异地备灾也比计算高可用复杂，而且随着集群数量增加，整个策略都要做相应的改变</div>2018-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/20/d5/9c/842eda55.jpg" width="30px"><span>一步两步</span> 👍（4） 💬（1）<div>结合我的负责的项目，计算高可用更像是我平时开发的业务系统（包含了我平时写的curd），当然这个理解台浅显了，希望有更好的举例或者我后面再想想，而存储高可用是我平时业务系统调用的mysql、mongodb、redis、elasticsearch等，平时开发对存储高可用其实考虑的较少，因为有基础架构部门和DBA团队支持，也比较放心使用，只需要分析好数据规模，以及未来增长趋势即可，对于计算高可用，我负责的业务系统大概是北京、南京等三个机房、每个机房有几个集群，我的服务大概100来台机器，我的上游流控系统把流量分发到我这里，采用的是nginx的轮训做的负载均衡。</div>2021-01-06</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/WtHCCMoLJ2DvzqQwPYZyj2RlN7eibTLMHDMTSO4xIKjfKR1Eh9L98AMkkZY7FmegWyGLahRQJ5ibPzeeFtfpeSow/132" width="30px"><span>脱缰的野马__</span> 👍（3） 💬（1）<div>老师，@yungoo同学说的：存储高可用还受到CAP约束 这句话，应该需要更明确一些吧？存储高可用也是通过冗余的方式来实现，但是有不同的方案和不同的使用场景，比如是主从主备这类的集群还是切片集群。结合CAP的讲解内容，切片集群并不共享数据，切片集群存储的目的是因为数据体量非常大，只能通过某个切分规则将数据分开来存储，减少单个实例的存储压力，不涉及到集群节点之间的数据同步，最多只是扩容和缩容时的数据重分配，所以CAP应该是约束在存储高可用的主从主备种类的集群方案中吧？请教老师</div>2020-09-25</li><br/><li><img src="" width="30px"><span>Geek_Littlelolo</span> 👍（2） 💬（1）<div>老师你好,我们现在的业务是开发C-V2X设备的CA系统,系统运行中包含了大量的加解密,签名,验签,计算密集型操作,目前我们设计的是加入一台高性能的加密机,如果实现计算高可用,是不是应该引入多台加密机?</div>2020-12-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/57/98/d1bde15d.jpg" width="30px"><span>gt</span> 👍（2） 💬（1）<div>老师，我有一个问题，对于那种已经分配给某台服务器处理的任务，如果处理任务的服务挂了，这些未处理完的任务要怎么处理，有些什么方案</div>2019-08-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/88/52/03795b59.jpg" width="30px"><span>天明</span> 👍（2） 💬（1）<div>请求转发面临着重复计算幂等性问题？如何解决这个问题呢？</div>2019-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/a1/e6/50da1b2d.jpg" width="30px"><span>旭东(Frank)</span> 👍（2） 💬（1）<div>请问有哪些指标表征架构的高可用，高性能？</div>2019-05-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/ce/3d/385b8263.jpg" width="30px"><span>星火燎原</span> 👍（2） 💬（1）<div>存储高可用架构的复杂度在于节点数据的一致性上，计算高可用架构复杂度在于主从节点的选举上 不知对不对</div>2018-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/37/1b/82310e20.jpg" width="30px"><span>拿笔小星</span> 👍（1） 💬（3）<div>1）计算高可用有主从，主备，为啥没有主主呢？两个服务器，随机发任务。
2）主从和集群，感觉没啥区别啊？唯一区别就是自动切换还是人工切换？
3）什么样的任务会要分主从机器执行呢？</div>2023-03-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/28/60/b7/4a665c73.jpg" width="30px"><span>小鬼爱风雪</span> 👍（1） 💬（1）<div>感觉上面主从主备跟后面的对称非对称有很多类似的，比如主从和后面非对称也就是恢复机制靠自动还是人工，而集群的定义更倾向于能提供服务的多节点，那么上面的主从主备都算集群吧。</div>2021-06-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/9f/c0/86febfff.jpg" width="30px"><span>Master</span> 👍（1） 💬（1）<div>老师有一个问题，计算高可用，集群方式里面的非对称集群方案，有什么生活里的实例案例吗， 总觉得这个方案很鸡肋啊，什么场景得吧计算任务给master搞，计算任务再给我follower搞，是逻辑顺序？感觉也说不通啊</div>2021-05-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/d1/29/1b1234ed.jpg" width="30px"><span>DFighting</span> 👍（1） 💬（1）<div>计算高可用虽然也是集群，但是如果仅仅是用作执行计算任务，不需要处理数据一致性等问题，复杂性比存储高可用降低不少；不过话说回来，执行任务肯定会有执行结果，结果怎么存储不需要任务介入？比如单机的DB存储失败，任务也得有相应机制处理的，所以除非完全的计算集群，不然存储高可用也得在设计的时候考虑吧</div>2021-05-13</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epmAicDUiaUdtLhVwSs6fT0yx69ibWy6ia46ZD4vblGtyee8QFz71icKZJkzccAFG3zHnMngSz7WeGBtKw/132" width="30px"><span>小神david</span> 👍（1） 💬（1）<div>计算高可用和存储高可用架构单从图中看确实有类似之处，但是复杂度的对比不在同样的维度上。首先，计算高可用可以认为是无状态的，而存储高可用是有状态的，这是最主要的区别；其次，存储高可用要解决节点间通信的问题，而计算高可用架构不是必须的。</div>2020-12-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/2d/ca/02b0e397.jpg" width="30px"><span>fomy</span> 👍（1） 💬（1）<div>感谢老师的分享，让我系统性地学习了高可用。原来高可用分存储高可用和计算高可用的。
那Zookeeper本身属于计算高可用还是存储高可用呢？首先它们都是有保存了其他节点状态的，但是它们又需要实现计算高可用的。我个人观点觉得是计算高可用多一些，不知道老师觉得怎么样？

课后问题：存储高可用肯定更复杂一些，有状态信息的需要保证数据一致性，比如网络原因造成同步延迟问题，这种问题不但难定位而且难解决。计算高可用可以通过重试来解决，比如dubbo分布式框架有负载均衡算法解决计算高可用。</div>2019-11-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/8c/ee/5bd478b9.jpg" width="30px"><span>贺敏Minbo</span> 👍（1） 💬（1）<div>计算无状态，存储有状态（CAP）

两个问题：
1. 那热备和温备的区别是？
2.这里主备切换，是可以做成自动切换的吧？</div>2019-11-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/c8/34/fb871b2c.jpg" width="30px"><span>海罗沃德</span> 👍（1） 💬（1）<div>zookeeper在没有选出新的leader之前，整个系统是否处于downtime中？</div>2019-07-15</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLw3jpao45frYkSMkPtE1j9jPKGLsTpuhx6f2oQqu2kG26g3z4ucXZrYxoYcotSw5dRUWCGDCpubw/132" width="30px"><span>你说的真对</span> 👍（0） 💬（1）<div>计算高可用类似于状态机, 给定输入后, 任意一台机器上返回的应该是一致的计算结果; 但是存储高可用包含一个数据一致性的问题; 存储高可用复杂度会相对高</div>2022-08-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/b5/3c/967d7291.jpg" width="30px"><span>艺超(鲁鸣)</span> 👍（0） 💬（1）<div>主从和集群里面的非对称咋这么像呢</div>2022-07-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/ff/14/4d5dfbfb.jpg" width="30px"><span>lliill</span> 👍（0） 💬（1）<div>存储高可用和计算高可用，最大的区别点就是数据的复制</div>2022-01-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/66/9b/59776420.jpg" width="30px"><span>百威</span> 👍（0） 💬（1）<div>这些高可用方案都涉及了任务分配器，但是任务分配器要做高可用是不是也要依赖另一个任务分配器，这不套娃了么…</div>2021-04-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/17/48/3ab39c86.jpg" width="30px"><span>insist</span> 👍（0） 💬（1）<div>计算高可用和存储高可用的设计思路相同点是冗余、需要检测服务器状态，目的都是解决单点故障，能够快速手动或者自动恢复服务，但存储高可用还需要多考虑数据一致性问题，复杂度更高。银行业务中需要设计同城异地实时灾备，在计算高可用上无非是多部署一套服务，但在数据实时备份上，需要考虑网络延时、是否对生产环境访问产生影响等情况，更加复杂一些</div>2021-04-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4d/19/aaa93809.jpg" width="30px"><span>Geek_m5gw8j</span> 👍（0） 💬（1）<div>存储是有状态，计算一般是无状态的</div>2020-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/c9/ce/cc85c6c3.jpg" width="30px"><span>阿恒</span> 👍（0） 💬（1）<div>看评论区也是很好的学习呀，小伙伴们总结的很到位呀！哈哈</div>2020-03-29</li><br/>
</ul>