前面几期专栏，我跟你系统的聊了架构设计的主要目的是为了解决软件系统复杂度带来的问题，并分析了复杂度的来源。从今天开始，我会分两期讲讲架构设计的3个原则，以及架构设计原则的案例。

成为架构师是每个程序员的梦想，但并不意味着把编程做好就能够自然而然地成为一个架构师，优秀程序员和架构师之间还有一个明显的鸿沟需要跨越，这个鸿沟就是“**不确定性**”。

对于编程来说，本质上是不能存在不确定的，对于同样一段代码，不管是谁写的，不管什么时候执行，执行的结果应该都是确定的（注意：“确定的”并不等于“正确的”，有bug也是确定的）。而对于架构设计来说，本质上是不确定的，同样的一个系统，A公司和B公司做出来的架构可能差异很大，但最后都能正常运转；同样一个方案，A设计师认为应该这样做，B设计师认为应该那样做，看起来好像都有道理……相比编程来说，架构设计并没有像编程语言那样的语法来进行约束，更多的时候是面对多种可能性时进行选择。

可是一旦涉及“选择”，就很容易让架构师陷入两难的境地，例如：

- 是要选择业界最先进的技术，还是选择团队目前最熟悉的技术？如果选了最先进的技术后出了问题怎么办？如果选了目前最熟悉的技术，后续技术演进怎么办？
- 是要选择Google的Angular的方案来做，还是选择Facebook的React来做？Angular看起来更强大，但React看起来更灵活？
- 是要选MySQL还是MongoDB？团队对MySQL很熟悉，但是MongoDB更加适合业务场景？
- 淘宝的电商网站架构很完善，我们新做一个电商网站，是否简单地照搬淘宝就可以了？

还有很多类似的问题和困惑，关键原因在于架构设计领域并没有一套通用的规范来指导架构师进行架构设计，更多是依赖架构师的经验和直觉，因此架构设计有时候也会被看作一项比较神秘的工作。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/d5/31/b09432cc.jpg" width="30px"><span>@漆~心endless</span> 👍（89） 💬（4）<div>架构设计三原则；
合适原则最适合；
简单原则不简单；
演化原则需推进；
如若脱离三原则；
老板生气你苦逼。</div>2018-05-17</li><br/><li><img src="" width="30px"><span>桌小洛</span> 👍（52） 💬（1）<div>总结的很好，架构设计原则:

合适原则: 有多大的脚（复杂度），穿多大码的鞋。BAT或者业界领先的架构对很多团队和公司来说都是大码的鞋而已，穿上不合适的鞋，团队必定步履蹒跚，很难走的很远，还有可能摔倒（项目失败）。
但是如果能根据自己的业务需求，对BAT或者业界领先的架构进行仔细调研，进行删减，重新取其一部分组合成适合自己的架构，也是非常好的方法。

简单原则:  我感觉改成简洁原则更合适，简单+整洁。360行皆是艺术，架构也是一门艺术。一个复杂的系统，如果能用一个简洁的架构来实现，完全相当于一个艺术品。 相反，如果一个普通的系统，反而被设计成了一个错综复杂的复杂架构，相当于做了一个糟粕品。

演化原则:  通过 简化设计  +  重构 来保证架构的与时俱进。不要前期就对架构进行过度设计，毕竟无论你前期怎么设计，总会有你意想不到的变化产生，唯一不变的就是变化。等你的脚长大了，再去穿大码的鞋。</div>2018-08-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/2f/16/62210b6b.jpg" width="30px"><span>石同享</span> 👍（48） 💬（2）<div>合适原则是不是可理解为：确定了一定的系统复杂度之后，能承受其包括性能，可用性，可拓展性，成本，安全方面的最小代价解(简单原则)，而演化原则是对上述系统的迭代优化。这样和之前的内容都可以联系起来了。</div>2018-05-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/fc/34/c733b116.jpg" width="30px"><span>何磊</span> 👍（21） 💬（2）<div>三大原则：合适原则，简单原则，演进原则。
最重要的莫过于合适原则，如果不合适，无意欲削足适履，团队感觉难受，业务不稳定等，因此架构设计的第一原则一定是合适，合适当前的业务，合适当前的团队，合适当前的成本（时间与资本）
其二简单原则，这是一个相对原则，是在合适的基础上进行选择最简单方案，绝不能孤立，并且简单是自己业务的对比，比如：当前淘宝的架构每次迭代，他们选择一个简单方案，但他们的简单不意味着我们的简单。
关于演进原则，系统一定变化的、生长的，但是他们的起跑点肯定不同，比如大公司造的系统都是富二代，他会从微服务开始演进，十个人的小团队会从单体应用演进。
对于上面三个原则，演进原则其实我觉得考不考虑，他都存在，只要你的业务继续，不过好的架构有助于可扩展性，让后续演进更丝滑般流畅，不好的架构到了某个阶段只能重来。</div>2018-05-15</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIBTiafeS96oDlxq3HLYL8LL1ZgTxJbLQNgVY4TlZrdv3pdujqh4yArveiaiae6n2kwFPG13brVFQrHA/132" width="30px"><span>Geek_5420ac</span> 👍（16） 💬（3）<div>深有体会，刚来公司发现现有的项目写的跟shi一样，一直跟组长提出重构，虽然拖了大半年但还是重构了，到了自己负责重构的搭建时，又发现其实之前框架的很多逻辑其实是优于我设计的，最后设计出来的发现其实也不是自己想象中的那么完美，因为设计的同时既要保证原有功能不能丢失，而且还有考虑到后续的拓展，这两者在我看来一般是矛盾的，很难在两者中间取舍，说到底还是自己接触的太少了，加油干饭人！</div>2021-01-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/44/10/7bfc89a8.jpg" width="30px"><span>SHLOMA</span> 👍（15） 💬（3）<div>题外话，如何说服领导，合适大于先进😂</div>2018-05-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e9/01/6e6d80d1.jpg" width="30px"><span>Loy</span> 👍（15） 💬（7）<div>发现这三个选择放在爱情上，也完全没毛病</div>2018-05-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/f5/01/5389295c.jpg" width="30px"><span>查理</span> 👍（15） 💬（4）<div>演进很重要，很多人都喜欢过度设计，简单的东西搞复杂。其实以后系统怎样变化很多过度的预测都不准，还不如让系统在一开始保持精简一点，根据需求慢慢演进</div>2018-05-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7c/60/0d508466.jpg" width="30px"><span>Forrest Li</span> 👍（7） 💬（1）<div>面对不确定性，架构师始终要做出一个选择，而三个原则遵循着解决问题的思路，提供了选择的依据。首先是合适，能够解决问题，其次是从合适中挑选简单的、能hold住的方案，最后，不要指望一个方案能解决所有问题，总会有弊端、不足，在碰到未来无法预料的情况时再做调整就是。变是永远不变的。</div>2018-07-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/66/a3/5d3d49cc.jpg" width="30px"><span>十里坡剑神</span> 👍（6） 💬（3）<div>非互联网行业的程序猿路过。架构设计得是否复杂，是否高大上，关系到能申请到多少项目预算甚至能否立项</div>2021-01-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/bc/dc/108ad1eb.jpg" width="30px"><span>钰湚—付晓岩</span> 👍（6） 💬（1）<div>我们之前花了多年时间进行了一次全范围的架构升级，几乎重做了所有主力系统，这个过程中，我的体会其实跟三原则非常接近，尤其是演化原则，大公司的复杂系统永远不可能一步到位，甚至较长的工期本就会导致原有设计在最终实现时就已经落后，复杂系统的架构只能是演化迭代的，这其中即有技术因素也有业务因素，有工艺的复杂也有人的复杂；简单原则，实际上是对单一职责的追求，但是对大型系统而言，单一职责也会带来通讯的复杂，调用的复杂，大型系统清晰的逻辑分层并不容易实现，如果涉及多方协同施工，单一职责更难贯彻，尽管大家都认可，但是实现起来并不容易；合适原则非常正确，不过可惜的是，它经常不是甲方的原则。这三原则对于架构设计而言非常重要，但是保证它发挥作用的是架构师能够获得充分的保障履行职责。</div>2018-05-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/22/40/5b/851cfac7.jpg" width="30px"><span>天外来客～</span> 👍（4） 💬（2）<div>我们公司是做产品的，系统微服务化。由于业务的特殊性，客户要求不能上云，不能外网，必须部署在自己的服务器。问题来了，客户的服务器通常就一两台，配置也有限，而面对十几二十个微服务，性能问题尤为突出。这种场景，该如何优化设计</div>2020-10-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/5e/d6/87189c9d.jpg" width="30px"><span>shark</span> 👍（3） 💬（1）<div>华哥666，一语道破天机，三个原则相辅相成。合适是先决条件，选择一个不合适的架构，一开始就把简单个抹了，不合适的架构虽然可以演讲，但是这跟让一条鱼去陆地生活一样，虽然从进化的角度是可行的，但是成本大的吓人。简单就是承上启下，越简单越轻量的越容易适配，同时越简单也越容易演化。演化则是适合的升级，业务是不断的升级变化，就像环境不断的变化，物种不选择进化就会被淘汰一样，架构演化其实也是一个不断适合化的过程。</div>2021-03-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/94/a3/c8bcb28b.jpg" width="30px"><span>美国的华莱士</span> 👍（3） 💬（1）<div>早期业务单一的时候如果把事情想得太全会带来很多内耗,直接的结果就是吃的是奶挤的是草......很多老板线下落地能力非常强,到了互联网这一块恨不得你一个打十个,张口闭口就是直逼阿里京东携程(我真的遇到过),有的时候,复杂的架构更多是由老板想得太美丽造成的,造出来的东西没几个人用,还不如弄个简单的功能把钱花在推广上~所以说,那些不重要的功能,能不要就别要~</div>2020-05-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/b5/ca/bba4d696.jpg" width="30px"><span>牺牲</span> 👍（3） 💬（1）<div>合适最重要，不合适等于白费力气，做完也得重做。
简单复杂根据情况来，预算、时间和人力允许的情况下随意发挥，紧巴巴的时候就去繁从简吧。
演化是逐步解决问题的过程，跟随系统复杂度变化。变化无法一步到位，架构又怎么一步到位呢。</div>2020-05-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/07/2d/0ac560a6.jpg" width="30px"><span>易燃易爆炸</span> 👍（3） 💬（1）<div> 作者回复 架构师再牛气，首先得要有领导的信任😃 201...
极客时间版权所有: https:&#47;&#47;time.geekbang.org&#47;column&#47;article&#47;7071?device=geekTime.ios


哈哈哈，看到作者这句话，深感这才是第一重要的。个人感觉合适最重要，本着实事求是的态度，解决问题为导向，不求高大上，但是最各种体系都要熟悉，知道优缺点，了解具体试用场景，可能这是最好的状态吧。</div>2018-06-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/95/2a/572fc97c.jpg" width="30px"><span>lufeng</span> 👍（3） 💬（1）<div>我们既要仰望星空（演进），又要脚踏实地（合适，简单），so 演进是一种sense，这个要求对业务有深入的理解和对技术趋势有独到的见解，合适和简单是两个维度，就是功能和质量要求达标的情况下尽量简单，因为越简单的东西越稳定、性能，可用性和可扩展性相当于复杂系统要好. </div>2018-06-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/99/c9/5dc9fa46.jpg" width="30px"><span>Even</span> 👍（3） 💬（1）<div>我曾经在知乎上看到过老师推荐的书，其中一本就是Unix 编程艺术，看来是要真的去拜读一下了。关于这三个原则，我觉得首先是合适原则，因为架构的目的是为了业务而设的，再就是简单原则，在合适的基础上再简化架构，第三选择是演化原则，架构的变化是因业务的变化而演化而来的。</div>2018-05-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/7a/f5/54a5084b.jpg" width="30px"><span>简单猫</span> 👍（2） 💬（1）<div>确实有时候学了一堆架构 各种新技术却用不上
分布式架构 也试图搭建了一个
结果用不上 就2台服务器 却要用几十上百台服务器的架构 这不是聪明 而是愚蠢

既然是造自行车 就没必要按造火箭的设计去设计
最后连自行车也造不出来 团队解散

架构是和业务关联循序渐进的
先造了自行车 然后 电动车 电动汽车 燃油车 甚至飞机
最后火箭
技术 经验也是一步一步积累的</div>2022-02-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg" width="30px"><span>李二木</span> 👍（2） 💬（1）<div>架构设计迭代过程
    1） 设计出来的架构要满足当时的业务需要
    2） 架构要不断地在实际应用过程中迭代，保留优秀的设计，修复有缺陷的设计，改正错误的设计，去掉无用的设计，使得架构逐渐完善。

     3）当业务发生变化时，架构要扩展、重构，甚至重写；代码也许会重写，但有价值的经验、教训、逻辑、设计等可以在新架构中延续
</div>2021-03-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg" width="30px"><span>escray</span> 👍（2） 💬（1）<div>我是比较认可演化思维的，但是感觉比较困难的地方在于如何演化，如何在一开始的时候就留有演化的余地？

如何才能保留有价值的经验、教训、逻辑和设计？我觉的可能主要还是要靠人，靠架构师。

可是如果架构师换人了呢？可能需要架构师了解业务，并且理解原有架构的设计。好的代码会说话，好的架构也应该是自我表达的。

作为一个架构师，如果能够看到一个应用系统从小到大的成长和演化，并且追随业务和系统不断成长，那么真的是挺好的一件事情。

插一句，我们作为个体，面对现在这样一个不确定的世界，其实也同样适用合适、简单和演化三原则。</div>2020-09-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/14/a6/d00153f1.jpg" width="30px"><span>不再犹豫</span> 👍（2） 💬（1）<div>满足业务需求是核心原则，架构的演化也是在不满足业务或预料到将要不满足的前提下进行的，在演化设计过程中选择简单优于复杂。赶脚架构师应该有复杂问题简单化的能力，多复杂问题也要能说得清，讲得明！</div>2018-05-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e5/8a/9795f8e4.jpg" width="30px"><span>苏本东</span> 👍（2） 💬（1）<div>目前在做一个某行业的国际站，还未上线。其中多语言文案需要其他同事翻译，于是做了一个excel表格，在微信群里飞来飞去。然后领导说同行业某某公司有自己的管理后台，说我们的做法low了，可我认为这是目前最快也是最合适的方法。后续做大了再演进呀。</div>2018-05-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/ef/37/4b12b4cc.jpg" width="30px"><span>ZYCHD(子玉)</span> 👍（2） 💬（1）<div>合适原则，简单原则和演化原则是一体的，在合适的基础上简单，简单有利于后续系统因业务变化而产生的演化。很难说哪个原则最重要，三者都很重要。没有一尘不变的业务也就没有一尘不变的系统。</div>2018-05-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/86/f4/331f33a7.jpg" width="30px"><span>anchor</span> 👍（2） 💬（1）<div>“软件架构设计其实更加类似于大自然“设计”一个生物，通过演化让生物适应环境，逐步变得更加强大”，这个比喻很形象。面试中经常问的一个问题是在你维护的产品中出现过哪些问题？是如何定位的？采用了什么方案后达到了什么效果？</div>2018-05-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2a/d0/25/0424dcbf.jpg" width="30px"><span>Fly_wolf</span> 👍（1） 💬（1）<div>合适就像找对象，搞不好就要离婚（项目失败），这点更重要；简单就是生活作风好，不乱搞三者关系；演进就是修心过日子，保留优秀的，抛弃不好的，改进错误的，修正小错误！</div>2022-05-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/c5/61/a50108d7.jpg" width="30px"><span>Aiur</span> 👍（1） 💬（1）<div>三原则相互贯彻。
合适、演化遵循简单，也是简单的体现。合适是当前的合适，也将在未来演化。演化是动态过程，形成新的合适。
</div>2021-03-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/90/c6/0ba1789a.jpg" width="30px"><span>半夏</span> 👍（1） 💬（1）<div>拿我准备做的一个大数据监控系统来套

我们用prometheus做系统监控，应用监控有用python,shell,jmeter的


合适: 写一个单点的java exporter用多线程方式去采集各个组建信息，不仅能做可用性监控，也能做自愈，还能开发组件深度监控

简单: 虽然需要监控的组件比较多，但我们集群规模不大，启动一个进程就能解决了

演化: 如果集群能演化到100台，1千台，在根据监控需求拆成各个监控子系统

也不知道说的合理不，望老师给建议</div>2021-03-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/a7/65/1c2267e4.jpg" width="30px"><span>Orion</span> 👍（1） 💬（1）<div>不太理解，所谓的编程确定性和架构不确定性是如何证明的。如果说特定代码片段运行的结果是确定的，那么特定的架构设计落地后的结果也是确定的；如果不同的架构师使用不同的技术方案叫不确定性，那么不同的程序员实现需求时也会采用不同的算法，则编程也是不确定的</div>2020-07-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/21/78/732a2e33.jpg" width="30px"><span>M1racle</span> 👍（1） 💬（1）<div>说的太好了，合适是非常重要的，如果直接选择一步到位非常容易把项目作死了。在不了解别人架构的情况下直接照搬也很难受，根本不懂人家是如何演进的就没法很通透的用明白。现在非常赞同在其他地方看到的一句话，合适是第一位的，可以考虑适度超前，但步子不要迈的太大。可是做到这点很难啊</div>2020-07-01</li><br/>
</ul>