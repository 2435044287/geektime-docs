你好，我是郑建勋。

用最少的资源将程序的性能优势最大化，这不仅是每一个有追求的开发者的目标，更是企业为了达到更好的用户体验（例如更小的响应时间）、更低的成本面临的现实困境。

性能问题无处不在，从设计、开发阶段如何避免性能问题，再到如何发现问题，发现问题后如何分析、排查、调优，“性能”二字贯穿于系统的整个生命周期。

但是应该怎样攻破性能问题呢？性能问题涉及到的知识面广而且深刻，如果没有方法论的支撑，要解决它们无异于大海捞针。接下来的两节课，我会带你构建起一种分层的分析范式，并通过它对问题进行分层抽象，抽丝剥茧，将问题逐个击破。

## 过早的优化是万恶之源？

说到这里，你可能迫不及待想要看看我的这个分层分析范式，验证一下它到底有多大本事。先别急，计算机科学中有句名言：**过早的优化是万恶之源。**

不过，这个“过早”指的是多早呢？很多人习惯用这句话为自己不考虑程序性能的行为开脱，他们又有没有道理呢？其实，读懂这句话的上下文，这些问题就迎刃而解了。

**首先，不加思考，一上来就优化肯定是不对的，这是这句话隐含的第一层意思。**开发者应该更多地关注程序中的关键部分，忽略掉不关键的部分。有些开发者过于追求完美，希望考虑到所有的细节。但是，最快的代码是从未运行过的代码。你几乎总是能够使程序变得更快，优化通常是一种收益递减的游戏。
<div><strong>精选留言（7）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/17/bf/86/c0cb35f0.jpg" width="30px"><span>8.13.3.27.30</span> 👍（1） 💬（1）<div>第三是要合理选择与实际系统匹配的并发模型

如何合理选择？ 我理解我选择了GO,它得并发模型就定了。还可以使用GO的其他并发模型吗</div>2022-11-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/bf/86/c0cb35f0.jpg" width="30px"><span>8.13.3.27.30</span> 👍（1） 💬（1）<div>如何让服务随着负载的增加具有可扩展性？是否采用 DDD 的架构设计？如何进行分布式的协调？选择何种中间件、缓存数据库与存储数据库？使用何种通信方式？

能否具体描叙一下到底如何？</div>2022-11-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/24/9a/6f/c4490cf2.jpg" width="30px"><span>czy</span> 👍（1） 💬（1）<div>第几章进入代码环节呀？</div>2022-10-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/7f/d3/b5896293.jpg" width="30px"><span>Realm</span> 👍（11） 💬（0）<div>1 下载器和解析器解耦分离，通过chan联系起来，各司其职，不够就增加worker；

2 从《linux性能优化》专栏学习到，影响系统性能的有：
第一种资源瓶颈，如CPU、内存、磁盘和文件系统 I&#47;O、网络以及内核资源等各类软硬件资源出现了瓶颈，从而导致应用程序的运行受限。对于这种情况，我们就可以用前面系统资源瓶颈模块提到的各种方法来分析。

第二种依赖服务的瓶颈，也就是诸如数据库、分布式缓存、中间件等应用程序，直接或者间接调用的服务出现了性能问题，从而导致应用程序的响应变慢，或者错误率升高。这说白了就是跨应用的性能问题，使用全链路跟踪系统，就可以帮你快速定位这类问题的根源。

最后一种，应用程序自身的性能问题，包括了多线程处理不当、死锁、业务算法的复杂度过高等等，用火焰图辅助分析.</div>2022-10-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/46/72/cb6ada5c.jpg" width="30px"><span>G55</span> 👍（8） 💬（0）<div>第一个问题。所有要爬取的网页连接可以看做是一个DAG图。 可以采用BFS遍历的方式来实现爬取。维护一个待爬取url的channel, 每次从一个网页上获取到下一级的url就加入到这个channel中。 同时, channel的另一侧读取channel, 待爬取url channel 不为空时就读取url并启动一个新的协程去爬取对应url 并解析返回内容。</div>2022-10-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/e2/52/56dbb738.jpg" width="30px"><span>牙小木</span> 👍（0） 💬（0）<div>从上一个网络模型到了性能这里，有点突兀，^_^</div>2023-08-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/5c/da/0a8bc27b.jpg" width="30px"><span>文经</span> 👍（0） 💬（0）<div>这一讲有点抽象，后面遇到实际的例子再回头看看。</div>2022-11-26</li><br/>
</ul>