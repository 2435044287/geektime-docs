你好，我是康杨。

上节课我们聊了Java对象在JVM中是以怎样的形式存在的，这节课让我们来继续探讨，一个Java对象在JVM中是如何被生产出来的。通过这节课的内容你可以看到JVM在演进过程中是如何优化对象创建的，掌握这节课的内容，对你写出高性能的Java程序大有裨益。

## 对象创建的标准流水线

![图片](https://static001.geekbang.org/resource/image/2b/37/2b50cb50ee2c7c7487c51445c4b61837.png?wh=1920x704)

如果我们把JVM比作是创建对象的工厂，那么首先让我们来参观下JVM工厂中日常创建对象的标准流水线。之所以称之为标准，是因为这并不是JVM内部创建对象的唯一一条流水线，另一条流水线我会在后面为你介绍。现在让我们先把目光聚焦在这条标准的流水线上。

```plain
Book  book = new Book(); 
```

我们可以把上面这行代码看作是流水线收到的一笔订单。当JVM收到这笔订单时，它知道客户需要定制一个Book对象，这时候流水线开始启动。

### 类加载

流水线上的第一个节点就是类加载节点。如果以盖房举例，待生产的对象比作待修建的房子，而类正是盖房子需要用到的图纸。不管我们要盖的是别墅还是塔楼，首先我们需要拿到盖房用的图纸，所以第一步要做的就是准备好图纸。

类似的，当JVM 读到 new 指令，知道需要创建一个对象的时候，它首先需要明确这个对象的图纸也就是对相应的类，是否已经准备好，或者说类是否已经加载好。当它发现这个类还没加载好，或者这个类还没有经历完完整的加载、链接、初始化流程。那么它会先启动完整的类加载流程，或者继续执行之前未完成的类加载步骤。
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="" width="30px"><span>edward</span> 👍（1） 💬（3）<div>请教老师，jvm开启了逃逸分析的情况下，逃逸分析是什么条件下触发的？</div>2023-09-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（0） 💬（1）<div>请教老师两个问题：
Q1：既然内存是规整的，为什么还需要“碰撞”吗？
“指针碰撞”具体指什么？
Q2：两种方法是同时存在吗？还是只选择一种？</div>2023-09-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/da/d9/f051962f.jpg" width="30px"><span>浩仔是程序员</span> 👍（0） 💬（0）<div>指针碰撞这个词感觉不是很好理解，看图示其实就是指针移动</div>2023-09-27</li><br/>
</ul>