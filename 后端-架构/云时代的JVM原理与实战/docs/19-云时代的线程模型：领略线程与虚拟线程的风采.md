你好，我是康杨。

今天我们一起来聊一聊JVM中的线程模型以及JDK 21的关键特性虚拟线程。

在传统的进程模型中，线程是操作系统的基本调度单位，但是会存在一些问题，比如线程的创建和销毁开销比较大，线程之间的切换也会占用大量CPU时间。因此，在Java中，JVM通过使用内核线程来代替用户线程，以减少线程的创建和切换的开销。JVM线程也是Java多线程的实现基础，能够并发执行，共享JVM内存，而且开销比较小。

## 线程的模型

JVM采用了一对一的线程模型，即每个Java线程都对应一个操作系统的内核线程。这种模型通过调用操作系统的内核线程来完成线程的切换和执行，而且每个内核线程可以看作是操作系统内核的一个分身。这也就是操作系统能够处理多任务的原因。

## 线程的状态

在Java虚拟机中，线程状态的变化是一个非常重要的概念。线程状态代表了线程在它的生命周期中所处的不同阶段。在Java中，线程状态可以描述为5种。

1. 当线程对象被创建之后，它会进入新建状态，这个时候它还没有启动运行，也就是说，start()方法还没有调用。
2. 一旦线程启用了start()方法，它就会加入到运行状态。在这个状态下，线程可以继续工作，也可能暂停。
3. 当线程处于等待状态的时候，它会进入阻塞状态。比如，当一个线程在等待synchronized锁的时候，而其他线程已经占用了锁，那么这些线程就会进入阻塞状态。
4. 当一个线程正在等待另一个线程完成特定任务的时候，它会进入等待状态。
5. 当线程执行完所有任务后，它会进入终止状态。
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg" width="30px"><span>Demon.Lee</span> 👍（0） 💬（1）<div>1、“虚拟化进程是在网络平台进程之间运作的，单个网络平台进程可能包含数个虚拟化进程。同样，每一个平台线程也都对应着内核线程。由此，我们得到了这样一条结论：VT 代表一条虚拟线程。”

这里的虚拟化进程是啥，老师能否再解释解释。

2、“由于线程依赖的是操作系统的线程管理机制而不是 Java JDK 中的任务分配和调配模块，因此这个以 OS 为基础构建出来的线程没办法被后者控制。相反地，它是由底层硬件提供的、具有独立管理能力的“虚”态处理单元，即所谓的“VT”，也就是我们常说的虚拟化技术下的多核或超核心计算资源共享方式中的一种特殊形式的多路复用策略。”

虚拟线程由 JVM 管理，这一段实际上想表达的是？没太看懂，能否请老师再说说。</div>2023-11-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/59/95/a164fa5c.jpg" width="30px"><span>soddygo</span> 👍（0） 💬（0）<div>这个虚拟线程，能否和 kotlin 的协程做比较？看思路是一样的</div>2023-11-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/75/dd/9ead6e69.jpg" width="30px"><span>黄海峰</span> 👍（0） 💬（0）<div>那就是java已有协程了啊</div>2023-10-19</li><br/>
</ul>