你好，我是康杨。

上节课我们聊了JVM是如何定位一个待回收的对象的，这节课我们继续看针对已经定位的垃圾对象JVM是如何进行回收的，也就是JVM中的垃圾回收算法。

垃圾回收算法种类很多，它是不断演进的各种垃圾回收器的理论基础。掌握垃圾回收算法，能帮助我们看清JVM中垃圾回收器的本质和演进趋势。今天让我们从最简单的标记-清除算法开始学起。

## 标记-清除算法（Mark-Sweep）

标记-清除算法是最早提出并实现的垃圾回收算法，虽然和现在越来越智能的垃圾回收算法相比，标记-清除算法显得非常简单，但是它却是后面这些垃圾回收算法的思想基础和发展之源。可以认为我们现在使用的各种垃圾回收算法都是基于标记-清除算法的思想不断改进、演化而来的，所以标记-清除算法是必须要掌握的。

### 详细步骤

在标记-清除算法中，我们把垃圾回收的过程划分成标记和清除两个阶段。

1. 标记阶段

基于我们在上节课中提到的可达性分析算法，从根对象开始遍历所有的可达对象并标记它们。

2. 清除阶段

清除所有未被标记的对象。这个地方需要注意的是清除对象的顺序并不影响算法的结果。最简单的清除算法就是逐一检查每个对象并释放未被标记的对象。

### 优劣势分析

标记-清除算法的一个重要挑战在于**如何有效地处理空间碎片**，因为每次回收后内存中都会存在大量不连续的碎片，即使这些内存碎片的空间总和足够装下这个对象，也没办法有效地分配给大型对象，从而影响JVM的性能和可靠性。
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（1） 💬（0）<div>请教老师几个问题：
Q1：“清除”在物理层面是怎么操作的？擦除该部分内存的数据吗？
或者将该部分内存全都置为0吗？
Q2：复制算法的改进版本，“需要大量编程”，是业务层面的编码吗？还是指JVM实现部分的编码？
Q3：垃圾收集，是JVM创建线程进行收集吗？
Q4：程序员写程序能感觉到GC吗？</div>2023-09-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/7e/57/8c1051b6.jpg" width="30px"><span>3.0的A7</span> 👍（0） 💬（1）<div>标记清除和标记压缩，是一个东西吧，我看有的人说是标记清除，有的说是超级压缩</div>2024-03-01</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/OX13K2HgNMUMCEvEwnyic0xyIicy6YjRxicdWibjR1ODPj6tMeBmNahALGrYm4n0NbsXxsM8DQ0X9n20aSKKSL5ulg/132" width="30px"><span>。</span> 👍（0） 💬（0）<div>感觉讲的比较笼统，Eden，Survivor具体是指什么，感觉没讲明白。</div>2023-12-07</li><br/>
</ul>