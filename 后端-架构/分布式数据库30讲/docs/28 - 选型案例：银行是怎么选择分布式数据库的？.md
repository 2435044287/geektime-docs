你好，我是王磊，你也可以叫我Ivan。

在前面的课程中，我们已经介绍了分布式数据库方方面面的知识。这些知识，我觉得大概会在三个方面帮到你，分别是数据库研发、架构思维提升和产品选型。今天，我会通过几家银行的案例带你了解如何做分布式数据库的选型。

为什么要讲银行的分布式数据库选型呢？

你肯定在想，这是因为王磊老师刚好是在银行工作，更熟悉这个行业。这么说也对，银行业确实是我最熟悉的行业。但是更重要的原因是，数据库作为一款基础软件，稳定性和可靠性就是它的立身之本。而对稳定性要求最严苛的行业，就是金融业，尤其是银行业。所以，只有经过金融场景的考验，一款数据库产品才能真正扬名立万，让其他行业的用户放心使用。

也是因为这个原因，不少厂商都打出了“金融级分布式数据库”的旗号。

分布式数据库的应用场景主要特征是海量并发，所以理论上说，业务规模越大，使用分布式数据库的需求也就越迫切。无论从用户数量还是资产规模，国内最大的银行肯定是工商银行。

## 工商银行（分布式中间件）

工行之前的数据库主要是Oracle和IBM的DB2，这很代表性，过去的20年银行业基本上就是在这两种产品中二选一。

Oracle和DB2都是单体数据库，只能采用垂直扩展方式，在碰到技术天花板后就会限制业务的发展。作为业务量最大的“宇宙行”，工行面对这个问题的选择是，从单体数据库向以MySQL为基础的分库分表方案转型。
<div><strong>精选留言（8）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/16/16/48/01567df1.jpg" width="30px"><span>郑泽洲</span> 👍（6） 💬（1）<div>在4大银行之一干了十多年开发，又跳到互联网干了5年。提供一下内部的视角和比较的视角：银行对分布式架构升级的路线是保守的。原因之一可能是时间节点刚好不对，分布式数据当时还不成熟；原因之二可能和银行开发人员结构有关，在银行从来没遇到基础技术驱动的项目，都是应用为王，开发团队是盯劳某块业务，基础技术储备不足。所以工行邮储等选择了应用层变动比较大的方案，而没有投入技术力量研发NewSQL。所以，业务不同，技术团队不同，造成了银行和互联网企业选型的不同。
是个遗憾，在分布式数据库成熟并成为技术潮流的今天，银行团队本身也在变化，大概率要二次改造</div>2022-01-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/12/13/e103a6e3.jpg" width="30px"><span>扩散性百万咸面包</span> 👍（2） 💬（2）<div>此外，利用分布式数据库的多租户特性，转变成类似 Aurora 使用方式，还能降低数据库实例管理的复杂度。

还有这句话，多租户特性是什么意思呢？它是怎么降低数据库实例管理的复杂度的，老师可以再细说一下吗？</div>2020-10-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/12/13/e103a6e3.jpg" width="30px"><span>扩散性百万咸面包</span> 👍（1） 💬（1）<div>这也意味着，它对分布式事务这样的复杂操作没有那么强烈的诉求。最后，用分库方案就很好地解决了海量业务的问题。
这句话不是很明白，意思是说，分库分表方案在事务模型比较简单的情况下，比Newsql更有竞争力吗？从技术角度为什么是这样呢？</div>2020-10-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" width="30px"><span>tt</span> 👍（7） 💬（2）<div>作为银行IT从业者，对技术和业务的关系那是深有体会啊。

很多实际项目中，其实最本质上都体现了数据一致性乃至事物甚至分布式事物的需求，最日常的对账处理，内部账户的使用，都提现了性能和数据一致性的取舍。这又带来数据分析和监管满足的一系列问题。

尤其是涉及到大的三方商户、客户，又是复杂的业务流程时，业务的最本质还是数据一致性的维护，还是会回归到分布式事物或者长事物上来，没有成熟的底层中间件支持，在讨论方案时总是深入甚至陷入到异常处理的细节大海中，这个循环一再重复。</div>2020-10-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/83/e2/297518ab.jpg" width="30px"><span>佳佳的爸</span> 👍（4） 💬（0）<div>一个系统做产品选型，我觉得需要考虑以下几方面:
1) 开发工具选型：都知道用C和C++ 更适合做内核级和系统级的程序，但是你也得考虑人员成本，可能
挂的招聘岗位一年了都招不到一两个适合的C和C++的程序员;
2)开发框架选型：不是每个公司都能像阿里那样有这么多资金和耐心支持一个完全自研的产品，绝大多数公司研发新产品最主要的目的就是尽快推出产品，抢占市场，或者说从竞争很激烈的市场分得一块蛋糕;
3) 运维的便利度： 随着Ansible自动化运维工具和各种开源的监控工具的流行，运维的复杂度确实比以前降低了很多，因此容器化安装部署已经是一个趋势了,谁家的产品安装部署最方面，运维最便利快捷，就能在市场竞争中赢得先机。</div>2021-06-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/3e/e9/116f1dee.jpg" width="30px"><span>wy</span> 👍（1） 💬（0）<div>公司层面： 系统的目标是什么 产品成本
产品层面：稳定性 性能 运维难度 技术栈
其它： 生态 案例</div>2021-01-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg" width="30px"><span>Jxin</span> 👍（1） 💬（0）<div>1.语言，方便深入和二开
2.成熟度，降低故障风险
3.是否主流，降低招聘成本
4.成本，权衡收益很重要</div>2020-11-03</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoWfXendN7czHpsyaWKLPK6Na9P5czquJ7Wdre4TibZQ5SQib88edyuib3LpCVFkp0gII2wyvvR8tEIA/132" width="30px"><span>OM</span> 👍（0） 💬（0）<div>的确如作者所说</div>2023-04-27</li><br/>
</ul>