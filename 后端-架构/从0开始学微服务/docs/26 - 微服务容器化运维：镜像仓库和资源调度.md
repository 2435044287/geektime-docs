专栏上一期我给你讲解了容器化技术解决了单体应用拆分为微服务后，所带来的服务测试和发布运维复杂度提升的问题，可以说容器化技术天生就是为微服务而生。但微服务容器化后又带来了一个新的挑战，那就是容器如何运维的问题。

为什么微服务容器化的运维又成了新问题？

对于大部分业务团队来说，在进行容器化以前，服务都是部署在物理机或者虚拟机上，运维往往有一套既有的运维平台来发布服务。我就以微博的运维平台JPool来举例，当有服务要发布的时候，JPool会根据服务所属的集群（一般一个业务线是一个集群）运行在哪个服务池（一般一个业务线有多个服务池），找到对应的物理机或者虚拟机IP，然后把最新的应用程序代码通过Puppet等工具分批逐次地发布到这些物理机或者虚拟机上，然后重新启动服务，这样就完成一个服务的发布流程。

但是现在情况变了，**业务容器化后，运维面对的不再是一台台实实在在的物理机或者虚拟机了，而是一个个Docker容器，它们可能都没有固定的IP**，这个时候要想服务发布该怎么做呢？

这时候就需要一个面向容器的新型运维平台，它能够在现有的物理机或者虚拟机上创建容器，并且能够像运维物理机或者虚拟机一样，对容器的生命周期进行管理，通常我们叫它“容器运维平台”。
<div><strong>精选留言（9）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/4b/d4/b7719327.jpg" width="30px"><span>波波安</span> 👍（12） 💬（1）<div>p2p是去中心的。主从的是中心化的。我觉得p2p的模式更容易扩展，但实现起来更加复杂。</div>2018-11-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/69/4d/81c44f45.jpg" width="30px"><span>拉欧</span> 👍（17） 💬（0）<div>P2p应该是类似迅雷这样的分布式存储镜像，这种管理模式使用于10万或以上级别的虚机集群，在这种量级下，主从部署的镜像管理系统会因为网络带宽而出现瓶颈，如果只是小规模的虚机集群，主从应该是更简单更适合的方案。</div>2018-10-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/a2/97/fb8c01fd.jpg" width="30px"><span>格瑞图</span> 👍（2） 💬（0）<div>对于文中两种配置的物理机，一般跑多少个应用容器比较合适？每个容器的 CPU、内存、磁盘分配多少呢？这块有没有一个经验值可以分享呢？</div>2018-10-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/04/18/4b02510f.jpg" width="30px"><span>明天更美好</span> 👍（2） 💬（0）<div>我们公司也要集成docker了，但是有点迷茫，不知道这个环境怎么搞。</div>2018-10-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ee/d2/7024431c.jpg" width="30px"><span>探索无止境</span> 👍（1） 💬（0）<div>老师您好，一直对于服务器配置的选择全凭经验值，但有没有一个科学的推算过程，就是我们应该购买4核8G，还是8核16G，这个选择过程是否有一个可参考的计算推算方式？困惑了很久，还请老师给些指导，感谢！</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg" width="30px"><span>钱</span> 👍（1） 💬（0）<div>两年前还搞过一下DOCKER，后来来现在的公司都是运维搞了。
搞一万个和搞一个道理应该差不多，只是一万个肯定不能人肉搞，否则自己就会被搞死啦！
回忆一下：
1：安装DOCKER运行环境软件
2：把网络环境弄好
3：安装相关应用运行软件
4：生产镜像文件
5：远程操作服务器，传递相关文件
6：启动应用
大概是这样吧！大公司会把这些简单重复的工作抽象一下，可能变成一个容器管理平台+应用发布平台+容器监控平台+代码管理平台，这样水平扩展，批量发布就简单了</div>2019-06-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/04/18/4b02510f.jpg" width="30px"><span>明天更美好</span> 👍（1） 💬（0）<div>而且我们全是内网环境，根本访问不了外网，这个时候搭建docker和Jenkins持续集成怎么搞呢？而且本身对docker理解也不深入</div>2018-10-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/96/a2/c1596dd8.jpg" width="30px"><span>🤔</span> 👍（0） 💬（0）<div>现在不都用k8s调度了吗</div>2022-04-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ee/c6/bebcbcf0.jpg" width="30px"><span>俯瞰风景.</span> 👍（0） 💬（0）<div>容器化运维的两个关键：镜像仓库和资源调度。

镜像仓库是用作统一管理和部署Docker镜像的；而镜像仓库为了高可用，也需要采取集群部署的方式，这就涉及了集群的数据同步问题，一般是一主多从主从复制模式和P2P的复制模式。

资源调度问题是由于服务器资源的来源不一致，服务器资源的管理方式也不一样，需要把不同来源的资源调度差异性封装起来，对外提供统一的资源调度方式，以提高资源调度效率。</div>2021-10-08</li><br/>
</ul>