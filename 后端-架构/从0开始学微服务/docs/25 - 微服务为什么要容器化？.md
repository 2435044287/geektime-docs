专栏前面的文章，我主要给你讲解了微服务架构的基础组成以及在具体落地实践过程中的会遇到的问题和解决方案，这些是掌握微服务架构最基础的知识。从今天开始，我们将进一步深入微服务架构进阶的内容，也就是微服务与容器、DevOps之间的关系。它们三个虽然分属于不同领域，但却有着千丝万缕的关系，可以说没有容器的普及，就没有微服务架构的蓬勃发展，也就没有DevOps今天的盛行其道。

之后我还会具体分析它们三者之间是如何紧密联系的，今天我们先来看微服务为什么要容器化。

## 微服务带来的问题

单体应用拆分成多个微服务后，能够实现快速开发迭代，但随之带来的问题是测试和运维部署的成本的提升。相信拆分微服务的利弊你早已耳熟能详，我讲个具体的例子。微博业务早期就是一个大的单体Web应用，在测试和运维的时候，只需要把Web应用打成一个大的WAR包，部署到Tomcat中去就行了。后来拆分成多个微服务之后，有的业务需求需要同时修改多个微服务的代码，这时候就有多个微服务都需要打包、测试和上线发布，一个业务需求就需要同时测试多个微服务接口的功能，上线发布多个系统，给测试和运维的工作量增加了很多。这个时候就需要有办法能够减轻测试和运维的负担，我在上一讲给出的解决方案是DevOps。
<div><strong>精选留言（22）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/ed/91/9cfdccbd.jpg" width="30px"><span>龙卷风</span> 👍（20） 💬（1）<div>老师，分布式事务还没讲</div>2018-10-18</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/ynEtBO8iayrGrbbekL9g8CJ7Mnl1u2Dom2Bt4XNPNZyTJ5woicYTewvxwTEhEyQ2UEBszRLEj5TkJxicaEb5rW0Cw/132" width="30px"><span>郁</span> 👍（2） 💬（1）<div>目前遇到最头疼的问题就是docker宿主机的防火墙如何优雅处理！</div>2018-10-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/ad/eb/c972abcf.jpg" width="30px"><span>王必成</span> 👍（1） 💬（1）<div>老师，什么时候讲API网关呀</div>2018-10-19</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/IIkdC2gohpcibib0AJvSdnJQefAuQYGlLySQOticThpF7Ck9WuDUQLJlgZ7ic13LIFnGBXXbMsSP3nZsbibBN98ZjGA/132" width="30px"><span>batman</span> 👍（1） 💬（3）<div>你们公司接口文档用的什么</div>2018-10-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/b3/c5/7fc124e2.jpg" width="30px"><span>Liam</span> 👍（14） 💬（0）<div>docker本质上还是依赖于Linux的内核，所以迁移的时候还是要求系统内核一致</div>2018-10-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/e3/02/0c228d1c.jpg" width="30px"><span>Tony</span> 👍（6） 💬（1）<div>虚机是一栋高层楼房里的一套房
docker是一套房里的一房间（厨房，卫生间，卧室）</div>2019-02-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/69/4d/81c44f45.jpg" width="30px"><span>拉欧</span> 👍（6） 💬（0）<div>虚机是一个操作系统，docker是操作系统内的进程，虚机占有资源多，启动慢，但隔离效果更好，一台物理机启动的虚机数量最多只能有几十个，但是docker可以有成千上万。</div>2018-10-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4b/d4/b7719327.jpg" width="30px"><span>波波安</span> 👍（4） 💬（2）<div>生产和测试的配置文件不一样。镜像怎么解决应用配置的问题。</div>2018-11-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4b/d4/b7719327.jpg" width="30px"><span>波波安</span> 👍（3） 💬（0）<div>服务器虚拟化解决的核心问题是资源调配，而容器解决的核心问题是应用开发、测试和部署</div>2018-11-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg" width="30px"><span>亚林</span> 👍（2） 💬（1）<div>和我大的java【一次编译 到处运行】的理念是一样一样的</div>2019-06-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/b2/10/a6debd39.jpg" width="30px"><span>章洁</span> 👍（2） 💬（0）<div>感觉两个问题的本质还是一个，解决环境封装的差异性，带来测试部署便利！解决环境的随时部署。</div>2019-05-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/3a/db/791d0f5e.jpg" width="30px"><span>huizhou92</span> 👍（1） 💬（0）<div>Docker跟虚拟机最大的区别是，Docker的轻量级，创建销毁速度更快，体积更小。</div>2020-12-18</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/e6TFib156x0VEiaWPkwpgAqia1yvwcdoMibSRchXgd1GxVyy49yBhYHd10ibzDia0HN7X2gaZCEt5MfqHiaSDJDEUzx5A/132" width="30px"><span>浩淼海洋</span> 👍（1） 💬（0）<div>虚拟机隔离性、安全性相对docker更好；docker具有更好的灵活性，部署实施效率更高</div>2020-10-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/62/49/6332c99b.jpg" width="30px"><span>man1s</span> 👍（1） 💬（0）<div>多个docker可以复用上层镜像，多个虚拟机全文独立</div>2019-10-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/59/62/954065d4.jpg" width="30px"><span>步＊亮</span> 👍（1） 💬（0）<div>老师你好，我想请教一个问题。在服务器国产化驱动下，docker是否能较容易地解决不同平台(x86,arm,mips)下的web应用的移植问题呢？</div>2018-11-15</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/ynEtBO8iayrGrbbekL9g8CJ7Mnl1u2Dom2Bt4XNPNZyTJ5woicYTewvxwTEhEyQ2UEBszRLEj5TkJxicaEb5rW0Cw/132" width="30px"><span>郁</span> 👍（1） 💬（1）<div>bridge模式，在开了防火墙时，同一台宿主机上的容器间网络不通，遇到最大的麻烦就是防火墙和docker共存了！</div>2018-10-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ee/c6/bebcbcf0.jpg" width="30px"><span>俯瞰风景.</span> 👍（0） 💬（0）<div>微服务拆分后增加了系统的复杂性，由于一个功能的上线和运维都涉及到多台服务器，所以增加了测试和运维的工作量和工作难度。

通过Docker 镜像技术可以快速迁移服务运行环境。
  对于测试来说，可以快速获得相应的测试环境。
  对于运维来说，可以快速进行扩容和缩容。</div>2021-10-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/97/d6/c324a7de.jpg" width="30px"><span>兰兰的天</span> 👍（0） 💬（0）<div>&lt;a href=&quot;https:&#47;&#47;www.1685100.com&#47;view&#47;xingyft&#47;pk10kai.html&quot;&gt;幸运飞艇&lt;&#47;a&gt;
&lt;a href=&quot;https:&#47;&#47;1685100.com&#47;view&#47;cjdlt&#47;index.html&quot;&gt;超级大乐透&lt;&#47;a&gt;
&lt;a href=&quot;https:&#47;&#47;1685100.com&#47;view&#47;shishicai_xy&#47;ssc_index.html&quot;&gt;幸运时时彩&lt;&#47;a&gt;</div>2021-05-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg" width="30px"><span>钱</span> 👍（0） 💬（0）<div>虚拟机和DOCKER乍一看确实很像，老师乍一问不知怎么回答。
不过实际工作中基本是用虚拟机模拟其他的操作系统环境，做实验做测试玩。
DOCKER用于部署各种应用，水平扩展非常方便，可以跑在物理机中也能跑在虚拟机中。
他们的定位我认为是不一样的，DOCKER更轻量化打包软件的运行环境，使开发、测试、运维更简单轻松。
</div>2019-06-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/bd/99/851b0db6.jpg" width="30px"><span>ylw66</span> 👍（0） 💬（0）<div>您好，我们公司在运行环境层按前端和后端分了两个微服务，前端from ngnix，后端from openjdk，我理解也是一种可行的实践吧</div>2018-12-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/9a/a9/dfea2c50.jpg" width="30px"><span>张龙大骗子</span> 👍（0） 💬（0）<div>docker的自动化运维和之前说的微服务治理是要相互结合的吧？</div>2018-10-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/c0/2c/b45cc122.jpg" width="30px"><span>极客达人</span> 👍（0） 💬（2）<div>问个问题，为啥要用rpc框架？</div>2018-10-19</li><br/>
</ul>