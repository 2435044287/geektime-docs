你好，我是任杰。这一讲我和你聊一聊如何实现正确的跨机房实时容灾。

这一讲我们主要从这三个方面的内容给你讲解容灾问题，它们分别是正确容灾、跨机房容灾和实时容灾。

因为“跨机房”和“实时”是两个标准的技术问题，所以有非常明确的方式方法和衡量标准，我们会在后面详细讲解。

相反，“正确”这两个字可能会因人而异，不同环境下可能会有不同的理解。因此我们在讲解技术问题之前，先看看怎么理解“正确”这两个字。

## 正确的定义

金融行业覆盖的面非常广，不同子行业对容灾的要求会不一样。一种分类方式是按照用户专业性来分类，这种分法会将用户分为一般性用户和专业用户两大类。

**一般性用户指的是非从事专业金融类工作的用户。专业用户指的是以金融类工作谋生的用户。**注意这里的用户并不限定为个人用户，其中还包括企业等机构用户。通俗来讲一般性用户指的是C端用户，专业用户是B端用户。

对于一般用户来说，日常使用最多的金融服务是手机支付。如果手机支付系统出现了问题，支付公司进行了容灾处理之后，我们能接受的“正确”的容灾结果一般有两个。

第一个是尽量在规定时间内恢复服务，比如在10秒内恢复。第二个是如果有限时间内不能恢复服务，那么要避免出现金额对不上的问题。比如说，我这边已经显示扣款了，商家那边却迟迟收不到钱的情况，就一定要避免。
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" width="30px"><span>tt</span> 👍（4） 💬（0）<div>三地九中心相比三地五中心的优势应该是可以容忍两个地方的数据中心同时故障。此时剩下的一个城市，仍然是一个raft集群，可以容忍数据中心级的故障。</div>2021-02-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/f9/e6/47742988.jpg" width="30px"><span>webmin</span> 👍（3） 💬（0）<div>1. 每一组中的某个节点发生故障只要不是对外提供服务的主主节点，就不会发生重新选主主节点，导致有可能让所有客户改变主主节点的问题；
2. 宕掉的是主主节点，选主主节点是在另换两个组中的主节点之间进行，这样选出主主节点会快一些，共识工作按范围做，这个和金字塔形的分层管理结构是一样；</div>2021-02-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e4/04/def0a7b6.jpg" width="30px"><span>宋丹</span> 👍（0） 💬（0）<div>说的不对，三个节点如果不能实现两个数据中心的灾备，那要灾备干嘛？灾备本来就是要求主机房挂了，灾备机房要能够接管主机房</div>2021-05-22</li><br/>
</ul>