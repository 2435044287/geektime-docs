你好，我是任杰。这一讲我想和你聊一聊，怎么理解最简单的分布式一致性算法Raft。

在[第14节课](https://time.geekbang.org/column/article/336686)里，我们学习了在有容灾的分布式环境下的各种不同一致性情况，其中最重要的是线性一致性。线性一致性有非常多的好处，但是它的实现却非常困难。20多年前，计算机科学家终于找到了一个算法，但是非常晦涩难懂。

直到2014年，才出现了一个通俗易懂的算法，它就是Raft。从此以后，各种具有分布式一致性能力的数据系统便层出不穷，普通人也有能力和大型互联网公司一样，设计出一个在分布式环境下正确的系统。

既然Raft算法通俗易懂，实现细节我就不展开了，这节课我们重点来看看，Raft算法究竟能做什么，以及它应该怎么使用。

## 分布式一致性能解决的问题

### 文件同步

能实现分布式一致性的算法也叫作共识（Consensus）算法。我们在[前一节课](https://time.geekbang.org/column/article/337308)说过，共识需要满足以下3个条件：

1.终止性（termination）  
2.一致性（agreement）  
3.有效性（validity）

我们不是理论科学家，不需要去理解这些深奥的定义，而且就算我们理解了，也不一定能指导实际的开发工作。所以，我们需要的是一个更简单的结论。通俗一点来说，**共识表示在多台机器之间，能同步一个内容不断增加的文件。**
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" width="30px"><span>tt</span> 👍（1） 💬（0）<div>我是这么想的。

协调者之所以是单点是因为各个节点如果单独保存自己的事务状态的话，其余节点无法知道对方的转态，比如a、b节点已经准备完毕可以提交的时候，无法知道对方的状态，只能借助集中的协调者来进行协调，以便同时提交或者同时回滚。

如果协调者采用主从结构的话，又面临信息同步的问题。

如果能保证各个节点是状态可以线性的保存到多个节点上，那么事务的提交就可以变为准备完毕、提交等消息的顺序写入，每个节点读取已经写入成功的消息就知道其余成员的状态，从而不需要协调者就实现了分布式的事务。</div>2021-01-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/ac/83/2f143a22.jpg" width="30px"><span>雪粮</span> 👍（1） 💬（0）<div>老师加油！争取年前更完，年后找工作，💪</div>2021-01-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/db/ae/41b6c60b.jpg" width="30px"><span>三产</span> 👍（0） 💬（0）<div>单点其实就是主节点</div>2021-02-01</li><br/>
</ul>