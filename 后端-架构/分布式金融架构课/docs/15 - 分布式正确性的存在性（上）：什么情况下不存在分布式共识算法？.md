你好，我是任杰。这一讲我们聊一聊，什么情况下不存在正确的分布式共识算法。

对于金融行业来说，系统的正确性要远高于系统的执行效率。打个比方，当你在网上和朋友聊天的时候，漏掉了一两条消息其实无所谓。但是如果你给朋友网上转钱，钱转丢了就是件大事了。

金融行业的信息系统和互联网企业一样，也是由很多台机器组成的集群提供服务。机器一旦多了就会出现分布式系统常见的各种问题，比如宕机、网络中断。

那这种情况下，我们怎么才能保证金融系统的正确性呢？套用一句知乎上经常看到的评论，我们在回答为什么之前，先要问问是不是。你有没有想过，万一正确的分布式系统并不存在呢？

这些问题其实是对分布式系统的深入思考，也是金融级软件对架构师的要求。只有知其然并且知其所以然了，客户才能对你做出来的金融系统有信心。

## 核心思路&amp;小结

共识是指多台机器之间达成统一的结论。这节课我们会证明可能是分布式系统里最重要的一个结论，那就是不存在共识算法。准确来说，**在一个完全异步的分布式系统里，如果至少有一台机器可能会出问题，那么就不存在非随机的共识算法。**

从结论可以看出，想要共识算法不存在，需要同时存在两个现象：一个是机器出问题，另一个是完全异步。只要我们能让任何一个条件失效，就存在共识算法。
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" width="30px"><span>tt</span> 👍（3） 💬（1）<div>这节课好难。说说自己的思考。

不准确的时钟之所以有效，是不是因为它可以打破论证的第三条，让不会终止的共识过程终止。

还有，这里其实没有所谓的准确和不准确，大多数节点持有的状态就是正确的状态，加上一个时钟可以标记出节点处于共识的轮次。

这里出错的节点就是崩溃的节点吧。检测出崩溃的节点，目的应该就是抛弃他们，从而依赖剩余的大多数节点来达成共识，同时要考虑通讯不稳定的情况。

完整性可以让正确的节点排除掉“每一个”故障节点，这是共识可以终止的条件，我觉得弱完整性就可以了。

但是完整性的前提是正确的节点不能被其余正确的节点误以为不正常了，只要一些正确的节点不要被怀疑，从而可以组成大多数就行了，即弱的正确性。</div>2021-01-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/a9/cb/a431bde5.jpg" width="30px"><span>木头发芽</span> 👍（2） 💬（1）<div>看到一半后面就看不懂了,需要学什么前置课程或推荐书籍</div>2021-05-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg" width="30px"><span>李二木</span> 👍（1） 💬（0）<div>共识算法不是(非)随机。到底怎么理解这个随机啊。</div>2022-03-28</li><br/>
</ul>