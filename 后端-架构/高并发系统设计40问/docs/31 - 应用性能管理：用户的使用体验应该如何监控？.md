你好，我是唐扬。

上一节课中，我带你了解了服务端监控搭建的过程。有了监控报表之后，你的团队在维护垂直电商系统时，就可以更早地发现问题，也有直观的工具辅助你们分析排查问题了。

不过你很快发现，有一些问题，服务端的监控报表无法排查，甚至无法感知。比如，有用户反馈创建订单失败，但是从服务端的报表来看，并没有什么明显的性能波动，从存储在Elasticsearch里的原始日志中，甚至没有找到这次创建订单的请求。这有可能是客户端有Bug，或者网络抖动导致创建订单的请求并没有发送到服务端。

再比如，有些用户会反馈，使用长城宽带打开商品详情页面特别慢，甚至出现DNS解析失败的情况。**那么，当我们遇到这类问题时，要如何排查和优化呢？**

这里面涉及一个概念叫应用性能管理（Application Performance Management，简称APM），**它的含义是：**对应用各个层面做全方位的监测，期望及时发现可能存在的问题，并加以解决，从而提升系统的性能和可用性。

你是不是觉得和之前讲到的服务端监控很相似？其实，服务端监控的核心关注点是后端服务的性能和可用性，而应用性能管理的核心关注点是终端用户的使用体验。也就是说，你需要衡量从客户端请求发出开始，到响应数据返回到客户端为止，这个端到端的整体链路上的性能情况。
<div><strong>精选留言（21）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/12/82/96/30aaaa68.jpg" width="30px"><span>mghio</span> 👍（14） 💬（2）<div>小公司一般能把服务端的监控搞起来就已经不错了</div>2020-05-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/5e/82/438c8534.jpg" width="30px"><span>longslee</span> 👍（9） 💬（1）<div>打卡。老师，我们也常做客户端问题分析，主要是浏览器，有跟头痛的问题是：如果客户端是因为网络不畅，本身这是应该被监控的，但是由于网络不畅连监控日志都发不出来，数据都丢了我们没法分析了。</div>2019-12-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/c2/cc/ca22bb7c.jpg" width="30px"><span>蓝士钦</span> 👍（3） 💬（2）<div>H5页面的接口请求如何加密，请问有没有好的方案</div>2020-01-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg" width="30px"><span>👽</span> 👍（3） 💬（1）<div>这节课说实话没太理解，是不是说客户端发生部分卡顿，但是不是由服务器造成时。
需要由客户端记录请求的信息，并上传给服务器？</div>2020-01-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/35/79/21647da2.jpg" width="30px"><span>Keith</span> 👍（2） 💬（1）<div>APM SDK和APM服务之间不需要通过消息队列连接吗? 这样直接将APM服务暴露到客户端的请求中, 会不会存在性能风险?</div>2019-12-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/15/69/187b9968.jpg" width="30px"><span>南山</span> 👍（1） 💬（1）<div>自己确实是只关注服务端，工作中也碰到过网络问题抓瞎的场景，现在至少有思路排查了，赞</div>2020-01-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg" width="30px"><span>旅途</span> 👍（1） 💬（2）<div>老师，上报的异常数据，下单失败等等，这些在日志中不是有吗，上报这些的目的是什么呢</div>2019-12-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/8f/7d/90598e6d.jpg" width="30px"><span>勇敢的心</span> 👍（0） 💬（1）<div>关于APM服务，对于中于型公司来说是自己搭建合适？还是买现成的服务比较合适呢？</div>2020-02-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/cb/07/e2df01d8.jpg" width="30px"><span>liuyu5337</span> 👍（0） 💬（2）<div>我们首先会分配给这个应用，一对 RSA 公钥和私钥，然后 SDK 在启动的时候，先请求一个策略服务，获取 RSA 公钥。请问老师，分配的RSA公钥和密钥是应用启动时向服务器请求的还是写在应用(硬编码或者配置文件)里？如果是启动时请求服务端得到RSA公钥和密钥，如果应用没有网络，该怎么处理？</div>2019-12-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/72/7f/5da093c5.jpg" width="30px"><span>水目沾</span> 👍（0） 💬（1）<div>请问下agent的标识是如何生成的？就是用户的账号id吗？</div>2019-12-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg" width="30px"><span>qinsi</span> 👍（9） 💬（10）<div>敏感信息加密的目的是什么呢？如果是要防止泄露给网络上的中间人的话走加密协议如https是不是就可以了？</div>2019-12-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/71/a3/b881f08c.jpg" width="30px"><span>L响</span> 👍（3） 💬（0）<div>我们游戏服务端写过一个APM，用来为游戏客户端服务，但那时不知道ES，遇到了数据存储量大的问题，还得分库分表，后来就放弃了，换成了第三方的APM。</div>2020-06-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/c6/65/64d1eaed.jpg" width="30px"><span>健少</span> 👍（2） 💬（0）<div>感谢老师分享！对系统监控又有一个深刻理解👍🏻</div>2019-12-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/c6/00/683bb4f0.jpg" width="30px"><span>正在减肥的胖籽。</span> 👍（1） 💬（0）<div>有没有开源的amp监控的工具？主要想学习下AMP的设计思想。</div>2019-12-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/3c/fa/e2990931.jpg" width="30px"><span>文敦复</span> 👍（0） 💬（0）<div>非对称加密加密对称加密的密钥，学到了。保证安全的前提下，也保证了性能。HTTPS也是这样的吧。。</div>2023-11-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/67/6e/ec7299ec.jpg" width="30px"><span>达芬奇</span> 👍（0） 💬（0）<div>涨知识了</div>2022-12-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg" width="30px"><span>钱</span> 👍（0） 💬（0）<div>想法是好的，全链路都监控起来对于排查问题大有帮助，不知道目前业内有哪些公司这么实现了？
服务端能把全链路监控做的不错的还没见到过，思路大概就是这样了，采集日志——转存日志——解析日志——呈现日志——利用日志发现问题、定位问题、解决问题。</div>2020-05-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/c3/48/3a739da6.jpg" width="30px"><span>天草二十六</span> 👍（0） 💬（0）<div>大佬，别浅尝则止啊。端到端监控都自己开发的工作量很大，特别对于小公司来说。服务端应用监控是很多了，可也还有一些是apm监控不到的应用内部信息，又该怎么样</div>2020-05-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/3d/6e/60680aa4.jpg" width="30px"><span>Li Yao</span> 👍（0） 💬（1）<div>“APM 通道服务在接收到消息后，可以使用同样的算法生成摘要，并且与发送过来的摘要比对，以防止消息被篡改。”
这一块有点不太明白，既然消息已被加密，为什么还有被篡改的可能呢？</div>2020-03-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/4a/3d/07df0cb7.jpg" width="30px"><span>老磨</span> 👍（0） 💬（2）<div>实际上我们都是傻瓜操作，把所有的用户操作全部记录下来，然后让ML系统去学习，然后自动设置警报，诶，再也不用自己去写log了，无脑操作</div>2019-12-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/36/f6/d65b7302.jpg" width="30px"><span>峰</span> 👍（0） 💬（1）<div>听了后不知道可以用哪些开源组件实现上讲和本讲的链路搭建</div>2019-12-04</li><br/>
</ul>