![unpreview](https://static001.geekbang.org/resource/image/0c/e7/0c5237f2bfd702bbb19423d36fafe4e7.jpg?wh=750%2A1515)![unpreview](https://static001.geekbang.org/resource/image/3d/08/3d6b93bdf72be3826c9be626b19f0308.jpg?wh=750%2A2110)![unpreview](https://static001.geekbang.org/resource/image/a0/db/a04a123eebb754cb04c3c055c47400db.jpg?wh=750%2A2522)![unpreview](https://static001.geekbang.org/resource/image/d6/7a/d6a832cc3fe1284e6274c1d43f44067a.jpg?wh=750%2A2881)![unpreview](https://static001.geekbang.org/resource/image/b9/da/b963b7e55dd6c3cf1fb3340ffb233fda.jpg?wh=750%2A1619)![unpreview](https://static001.geekbang.org/resource/image/69/fe/69f89c4662d71b1e434a85ba89ff87fe.jpg?wh=750%2A749)
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg" width="30px"><span>👽</span> 👍（38） 💬（8）<div>首先谈谈我对HashMap的理解。
首先，实现原理：基于数组和链表，JDK8以后也会在特定情况下转为红黑树。
以对象的Hash值确定数据所在下标，如果下标里已经有数据，则用链表存储。在链表超过8时转化为红黑树。
转红黑树的目的是：红黑树的查找时间复杂度是logn，而链表是n，红黑树保证了在同一个下标下数据元素过多时候的高性能。
为什么在8之后才转红黑树：因为转红黑树，以及维护红黑树的左旋右旋需要额外的性能开销。而在数据量较小的时候，优化时间复杂度意义不明显。（例如：二分查找在数据量小的时候，性能提升不大）自认为这一条回答也算是红黑树和链表的优劣势。
HashMap不是线程安全的，所以有ConcurrentHashMap。
ConcurrentHashMap的线程安全，是使用了加锁的方式。
1.8之后，对加锁的数据粒度更加细化。每次只锁一个node。所以1.8以后的ConcurrentHashMap在并发下性能大幅度提高。

关于redis的问题，说实话，我觉得跳表 和 红黑树，我觉得都是可以的。因为核心目的是高性能，这两个在查找的时候性能都不错。硬要说的话红黑树性能更高（看测评是更高，理论上讲实际差距不是特别大），但是同时也更耗费内存（因为跳表的内存消耗是可控的）。而现在2019年这个时间点，为了用户体验，更多的还是以空间换时间，所以，我个人认为，红黑树可能更合适。

然后是想请教的面试问题：
1，请问老师如何看待基础与技能广度的重要性对比？就是说，主流的分布式框架我掌握的并不全，但是我觉得我数据结构，算法，Java这些的基础比同期其他人都要好，我认为我可以很快掌握公司所需的技术。您会接受我这样的人嘛？
2，现在的公司，面试动不动就需要你有高并发经验。但是，没有高并发的经验就无法进入有高并发场景的公司。（一个先有鸡还是先有蛋的问题）关于这种现象，您怎么看？有没有什么建议？</div>2019-10-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg" width="30px"><span>小喵喵</span> 👍（25） 💬（7）<div>好多面试官喜欢数据来说话，比如做高并发系统时，面试官问，你做的高并发系统TPS是多少，QPS又是多少，日活跃是多少？负载用什么来做？为什么要做负载，每一台机器的配置是如何？（核数？CPU？内存？硬盘等？）对于这些数据化问题，心里没有底，随便回答一个数据，面试官一下子就看出来了，知道你在忽悠，没有真正做过高并发系统。请老师举例一些量化（数据化）的面试问题，并且如何回答？</div>2019-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/ca/bd/a51ae4b2.jpg" width="30px"><span>吃饭饭</span> 👍（14） 💬（6）<div>感觉自己有点笨了，老师举的案例我没有看明白是哪里的问题。问题是：存储用户认证信息的缓存命中率极低，只有 20% 发现，老师发现 slab class5 占用了 2G 内存中的 1.9G ，但是用户认证信息用的是 slab class6。既然单独的空间都是 2G ，class5 的占用跟 class6 有什么关系，class6 的空间很充足，为什么还是会自动剔除，难道这里自动过期吗，求解答？
</div>2019-10-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/3d/51/9723276c.jpg" width="30px"><span>邋遢的流浪剑客</span> 👍（14） 💬（2）<div>无论是为了面试还是个人成长，基础知识都很重要，其实开源组件会用是很简单的，真正涉及到开源组件的底层原理离不开数据结构、计算机网络、操作系统这些基础知识，这些知识可不是一朝一夕就能搞定的，现实情况是很多程序员往往忽略了这方面的学习</div>2019-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/5e/82/438c8534.jpg" width="30px"><span>longslee</span> 👍（7） 💬（2）<div>老师咱还真遇见过“刁难”的哈哈，比如Java的那几个HashMap问题，我觉得我都答了，他还问我“你是不是背的啊？”（😫不知道是何用意）。 另，非常希望老师站在面试官的角度，对我这种只有传统项目经验，没有实际高并发实战但平时也略有学习（比如学习您的专栏😊）的人，提出怎样的问题；针对面试中要求的一个中间件，我确实没有用过，面试官优先觉得这人不行，还是能根据所答基础知识推导出以后学习这项技能没问题呢？</div>2019-10-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/b7/ba/ae4cabd8.jpg" width="30px"><span>仙道</span> 👍（7） 💬（2）<div>咱们平时的工作大多数都是CRUD,如何在面试中介绍项目经验</div>2019-10-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/36/2c/8bd4be3a.jpg" width="30px"><span>小喵喵</span> 👍（6） 💬（2）<div>请老师举几个案例分析一下，工程师和架构师是如何做自我介绍的？</div>2019-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/4c/81/c877206a.jpg" width="30px"><span>次声波～～</span> 👍（4） 💬（4）<div>我最近刚开始当面试官，其实我觉得当面试官也很难...在有限的时间内真的很难看出来面试者是不是一个好的coder，能否高效写出逻辑清晰的代码。现在网上面试题那么多，多准备准备基本上java 和数据结构的题都能答得无懈可击。请问您一般是怎么招人的啊？</div>2019-10-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ec/29/bd1efa05.jpg" width="30px"><span>若尘2B</span> 👍（4） 💬（2）<div>老师，您上面说的Memcache案例直击到了痛点。但是引发出另一个问题，您那次的案例是基于出现问题之前去深挖了组建的设计、原理还是问题导向。那次案例时隔多长，您现在记忆犹新。我现在的矛盾深挖原理都爱是基于问题导向，在处理阶段可以掌握那些组建的使用和问题处理，但是时间一久就容易忘记，虽然也会写使用的经验，总结，爬坑日志，但问题不再出现之后，最多2月基本忘的干净。我们该怎么管理自己掌握的技能，在面对技术迭代更新都如此之快的时代我们要怎样才不会被淘汰?</div>2019-10-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/7a/3c/87e015f8.jpg" width="30px"><span>堵车</span> 👍（3） 💬（2）<div>我知道面试官要问什么，我就是答不出来。</div>2019-10-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/6b/f8/b4da7936.jpg" width="30px"><span>大魔王汪汪</span> 👍（3） 💬（9）<div>sortedset使用红黑树好还是跳表好</div>2019-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg" width="30px"><span>丁丁历险记</span> 👍（2） 💬（1）<div>redis 源码里面有个sort.c  不到600行，管他懂不懂，可以读一下试试。

zsl跳势 区间断差找更快。   实现简单，构建策略灵活(响应速度与开销上方便权衡)
再多说一句，sortedset  可不止是跳表， 这里可以继续挖坑。</div>2019-12-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg" width="30px"><span>helloworld</span> 👍（2） 💬（1）<div>老师的观点深度赞同！面试时问的一些原理性的东西其实就是再考察对组件最本质的一些东西。会用组件通通常是说在低并发，少量数据下能让组件跑起来，当所有的量都上去后需要解决问题或者优化时，知道汽车的具体构造和运行原理要远比只会看仪表盘的故障灯要做的高效。打卡05。</div>2019-10-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/03/f8/f98df0a7.jpg" width="30px"><span>vaccywen</span> 👍（1） 💬（1）<div>redis有序集合使用跳跃表不适用红黑树的一个重要原因是，有序集合要支持范围查找，红黑树不支持。redis是用跳跃表+zskiplistNode实现的。</div>2020-04-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/b1/33/8993eae0.jpg" width="30px"><span>黄展志</span> 👍（1） 💬（2）<div>唐老师，想问一下，运维需要了解像redis,memcached，mysql，zk，ceph，hadoop,elk,zabbix,分布式一致性算法等等众多组件的实现原理吗？</div>2019-12-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/f8/ba/d28174a9.jpg" width="30px"><span>Geek_zbvt62</span> 👍（1） 💬（6）<div>由于不懂memcached所以案例没看懂。
从描述上看，slab class没有足够空间，会查找更大的，但没提什么时候会剔除缓存，剔除哪些，猜想是剔除相同slab class的？
前面说单节点2G用了300M，后面又说slab class 5占了2G中的1.9G，莫非此2G非彼2G?
看起来像是内存不够用导致频繁剔除缓存，只不过memcached的机制会剔除相同slab class造成了这种现象？</div>2019-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/01/37/12e4c9c9.jpg" width="30px"><span>高源</span> 👍（1） 💬（2）<div>了解原理是解决问题一方面，我想问老师如何提高利用算法解决问题能力，工作忙刷题又坚持不下去，都是靠自己来学习提高。老师有什么好的方法吗😊</div>2019-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/ed/4b/0ddfa9ad.jpg" width="30px"><span>小刚z</span> 👍（0） 💬（1）<div>如果面试问这些问题我就开心了</div>2020-05-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg" width="30px"><span>钱</span> 👍（0） 💬（2）<div>缓存那个案例，老师有几个问题，请问一下（感觉描述的不清楚）
1：20%的命中率是怎么得知的？
2：你缓存的value是多大？
3：是空数据也放入缓存，此时怎么处理的，value是多大？为什么还不理想？正常来讲命中率会上去的即使里面存储的是特殊值？
4：slab class 5占了1.9G，其内部区域的每一个块占用多大？
5：slab class 6总共占了多少，每一块又占多大？

大体明白你的意思，不过你这些信息都没讲，假如我是面试官，我一定会问你这些的，否则逻辑上是讲不通的。作为案例讲解，这些内容也应该附上，否则感觉你只是也参与了这个问题的处理，不过细节上有碍逻辑的疏通。

基础确实无比重要，比如：0&#47;1在各种存储设备上都是以什么形式呈现的？理解这个就能明白为什么磁盘慢内存快，而且还是好几个数量级？

各种计算机原理＋数据结构与算法＋设计模式＋多线程＝真正的offer收割机（当然，不是一年两年能搞定的）</div>2020-04-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg" width="30px"><span>长期规划</span> 👍（0） 💬（1）<div>老师，红黑树我只了解一些，知道它是平衡树，但不是高度平衡树，而且算法实现很复杂，所以实际中貌似用得并不多，有必要再深入了解吗？</div>2019-12-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg" width="30px"><span>Dovelol</span> 👍（0） 💬（1）<div>老师好，想问下为什么会给slab class5分配1.9G，而其它加起来一共才100M呢，memecache内存分配策略是什么？最后是怎么解决的呢，修改配置吗？</div>2019-10-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/33/5c/8c0a372a.jpg" width="30px"><span>Fourty Seven</span> 👍（0） 💬（1）<div>比如我想提高对redis集群高可用的理解，除了看官方文档和书或者博客外，有必要自己搭建集群然后模拟单点故障看是否可以转移吗？
</div>2019-10-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/0c/d6/2677ec43.jpg" width="30px"><span>jack</span> 👍（0） 💬（1）<div>总结一点就是要夯实基础：算法，操作系统，数据结构，网络。</div>2019-10-04</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep7ur5hpV1dY5aO2TsDMLjZnM9Ph82fsdYGEcjjZDfTX7A8ecQ8vbpQemCvKDLOcrhkDjmeEr0LzQ/132" width="30px"><span>Geek_99fab9</span> 👍（0） 💬（1）<div>我基本说得出，但是一知半解，需要继续努力</div>2019-10-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/c5/1f/8e9ee163.jpg" width="30px"><span>良记</span> 👍（0） 💬（1）<div>之前面试的时候是有刻意去学习一下这些知识的，但是工作之后并没有用上，时间一长，又忘记了。</div>2019-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/6d/cf/ec335526.jpg" width="30px"><span>jc9090kkk</span> 👍（0） 💬（1）<div>当我刚会做网站的时候,觉得网站好简单; 当我刚会用数据库的时候,觉得数据库好简单;当我更了解网站和数据库后，觉得自己好简单，越了解，越敬畏，感谢老师分享，之前在面试中碰到过一次这样的经历：面试官问我，数据库分表策略有几种，我答：
1.范围分表
2.hash分表
3.根据路由表配置分表

面试官问：上面这几种策略都有优点和缺点，那有没有更好的分表策略呢？

我懵逼了，当时脑海里想的是这世界上哪有那么完美的事情，架构设计的原则是取舍，跟业务逻辑实现有很大区别，嘴上笑嘻嘻，心里MMP。。。</div>2019-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/13/bc/4ea47c0a.jpg" width="30px"><span>平平无奇古哥哥</span> 👍（6） 💬（0）<div>我个人觉得是这样的哈。首先我们使用某个技术或者是某个框架，类库，是用来解决问题的。对于这些技术，我们的心态应该是把它们当做工具。作为一个工具，我们肯定是先知道用它是来干嘛的，然后知道大概的运行原理，这对使用就足够了。如果使用过程中，发现这个东西太好了，设计得太优秀了，那可以带着兴趣去了解一下它背后的设计，甚至是去读一读源码。我觉得这应该是个正确的流程，而不是一上来就听别人说这东西面试考，所以我去囫囵吞枣学源码，这样心态很容易崩。要知道，世界上那么多优秀框架和技术，你不可能所有的都去学源码吧。个人觉得我们的心思还是要放在解决问题上，这个框架再好，我只关注它为我解决哪些问题。</div>2020-10-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg" width="30px"><span>William Ning</span> 👍（3） 💬（1）<div>一下读完了，自认欠缺很多</div>2019-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/23/49/10/9f702778.jpg" width="30px"><span>积极</span> 👍（2） 💬（1）<div>有些面试官问原理 问疯了 一上来就问websocket原理 我当时懵逼了 一个协议怎么有原理。我觉得问太过执着原理的面试官工作能力应该很差</div>2021-05-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/5d/eb/c6a53103.jpg" width="30px"><span>woshicai</span> 👍（1） 💬（0）<div>这方面确实薄弱，平时工作时间一般不会花在组件实现的原理上，后面要在工作之外补上这个薄弱点。</div>2019-11-24</li><br/>
</ul>