你好，我是唐扬，新年快乐！

过年嘛，都要吃好玩好，给自己一年的辛苦付出“加餐”，那咱们的课程也不例外，在新的一年里，我为你策划了两期加餐，今天先来聊聊在高并发下，我们如何发现和排查问题。

为什么要讲这个问题呢？是因为我在课程结束之后，发现有同学反馈说：

虽然课程里几乎涵盖了高并发系统设计的全部方面（比如数据库、缓存和队列的使用、分布式系统主要组件的原理，以及系统运维方面需要关注的重点），但自己按照课程中提供的方式正确使用了组件，在实际工作中仍然会发现系统中各种各样的问题，比如服务性能衰减、依赖资源的抖动甚至是服务整体故障。

尤其在高并发环境下，由于并发请求更多，对于资源和服务的压力更大，所以原本隐藏在冰山下的问题又都会在某一时间突然浮出水面。

**这其实就像墨菲定律说的那样：** 如果事情有变坏的可能，不管这种可能性有多小，它总会发生。这不是一个数据概率问题，也不是一个心理学效应，而是一种必然的法则。

在高并发场景下，一些细微的问题可能会迅速恶化，并且对系统中多个模块的SLA带来巨大的影响。比如，业务仅仅缓存的平均响应时间增加1ms或者缓存命中率下降1个百分点，都会带来灾难性的影响。这不仅增加了问题排查的难度，也对问题排查的及时性提出了更高的要求。
<div><strong>精选留言（6）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg" width="30px"><span>每天晒白牙</span> 👍（33） 💬（1）<div>感谢老师春节更新，我在工作中排查过几次cpu占用高，频繁fgc的问题
https:&#47;&#47;mp.weixin.qq.com&#47;s&#47;ji_8NhN4NnEHrfAlA9X_ag

https:&#47;&#47;mp.weixin.qq.com&#47;s&#47;IPi3xiordGh-zcSSRie6nA

https:&#47;&#47;mp.weixin.qq.com&#47;s&#47;fWsy26VeUvb8yPKON3OTmA</div>2020-01-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/62/81/ad80f427.jpg" width="30px"><span>Lane</span> 👍（3） 💬（1）<div>遇到过几次诡异问题。
明天零晨两点，服务器报警，看监控每天都这个点，以为crontab占用资源，后来发现，这个机器ping别的机器丢包严重，换网线好了。

重启服务报端口被占用，发现ffpemg的组件ffprobe也listen端口（是被服务用exec启的ffmpeg）。

有台新机器，基本上每天有十秒钟没有请求（nginx没有access.log），换网线网卡重装系统升级了内核，就是找不到原因，dmesg也没报错。

真叫人头秃</div>2020-02-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg" width="30px"><span>helloworld</span> 👍（2） 💬（1）<div>确实是，遇到问题，解决问题是提升自己的最快的方式，并且如何在遇到问题时不恐慌耐得住性子来排查问题也是需要好好学习锻炼</div>2020-08-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg" width="30px"><span>钱</span> 👍（14） 💬（3）<div>各种各样的业务问题排查过不少，还分门别类的整理起来写了一个问题排查手册，性能调优、网络超时、连接池超时这些问题也排查过，不过特别诡异的好像没有。
业务问题看对系统及业务的了解程度，系统问题看自己的基础知识，个人感觉日志太关键了，尤其对于不好复现的问题，公司如果基础设施好，排查问题的工具都是界面化傻瓜式操作能提高不少排查问题的效率，否则就看自己对各种工具的熟练程度了。
前几天还排查了一下使用Gosn和HikariCP的问题，Gosn是识别数据全部转换为Double在转Long会存在丢失数据精度，HikariCP的参数设置不对会出现连接不可用的问题，马上又要开始排查一下系统老报连接超时的问题了。
排查问题其实挺有意思的，尤其是大家觉得不好弄就这样吧！然后绞尽脑汁能把问题解决，即使没人点赞也很开心。</div>2020-05-10</li><br/><li><img src="" width="30px"><span>小胡</span> 👍（1） 💬（0）<div>感觉提供的案例问题很好解决，比如那个服务器系统时间的问题，正常人都会想到的</div>2021-09-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/57/31/6772744d.jpg" width="30px"><span>ちよくん</span> 👍（0） 💬（0）<div>消费重复消费</div>2020-01-27</li><br/>
</ul>