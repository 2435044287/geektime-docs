你好，我是钟敬。

通过前两个迭代的学习，对于一个开发组范围内的项目，我们应该可以从容应对了。不过随着项目范围变大，逻辑变得更加复杂，还会引出新的挑战，这时候又要如何应对呢？

在接下来的第三个迭代中，我们会结合“卷卷通”公司的新需求进一步思考和实战，深化DDD的相关技能，解决这些问题。

## 迭代二回顾

我们先复习一下迭代二的知识，然后再了解迭代三的内容和需求。

在第二个迭代，我们主要讲了聚合、值对象、限定和泛化，同时补充了一些必要的UML知识。我把迭代一和迭代二的主要模式和实践，合并成下面这张概念图。

橙色的椭圆代表《领域驱动设计》原书中的模式。黄色椭圆表示在书里提过，但没有算作模式的知识点。另外，我把代表迭代二内容的图标放大了一点，这样更加醒目，方便你识别。

![](https://static001.geekbang.org/resource/image/a1/91/a181f95fd7e39132c477c7485eaa9491.jpg?wh=3733x2297)

### 聚合

聚合（aggregate）是一组有整体部分关系，并且要满足一定不变规则的领域对象，其中只有一个实体表示整体，这个实体叫做聚合根。

聚合的整体与部分是强关联的，也就是一旦聚合根被删除，其他部分必然也被删除。由于这种强关系，所以外界只能通过聚合根来访问非根对象，因此，只有聚合根有业务意义上的全局标识，非聚合根实体只有局部标识。

对于那些单独存在，而不属于其他聚合的实体，可以认为是只有聚合根的、退化的聚合。
<div><strong>精选留言（6）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/1d/0a/7d/791d0f5e.jpg" width="30px"><span>子衿</span> 👍（8） 💬（4）<div>2. 已经实战过，困难一：目前案例中，都是应用服务和聚合下的领域服务，一一对应，比如EmpService中，只会调用EmpHandler，不会调用OrgHandler，如果一个应用服务下，既需要聚合A的领域服务的功能，又需要聚合B下的领域服务的功能，那么是应该新应用服务中组合A领域服务和B领域服务，还是新应用服务下组合A应用服务和B应用服务，如果应用服务EmpService下想使用Org中的服务，那么是组合OrgHandler还是OrgService，困难二：如果领域服务OrgHandler中想使用EmpHandler的功能，可以直接在OrgHandler中组合EmpHandler么，困难三：下层肯定是不能依赖上层，但同层间是否可以互相依赖，这会不会产生什么问题，最佳实践是什么样的</div>2023-02-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/b2/e0/bf56878a.jpg" width="30px"><span>kkxue</span> 👍（3） 💬（3）<div>老师，为什么你司CTO徐昊说CQRS是邪教呢？哈哈。</div>2023-02-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/0a/7d/791d0f5e.jpg" width="30px"><span>子衿</span> 👍（3） 💬（2）<div>再补充几点：一：DDD中涉及到反腐层，反腐层的最佳实践是什么样的，在领域层定义一个接口，适配器层对其实现，然后在实现中发起远程调用访问外部，但如果领域层这个接口中，也要有领域逻辑呢，是退化成抽象类吗 二：不同模块下的类互相调用，和同一模块不同包下的类互相调用，应该怎么处理，方案是一致的吗，应用服务层的服务间互相调用和领域服务层的服务间互相调用，逻辑是一样的吗，同一个包下多个领域服务间互相调用，和不同包下多个领域服务间互相调用，逻辑是一样的吗</div>2023-02-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/85/67/0d121bc4.jpg" width="30px"><span>神经蛙</span> 👍（0） 💬（1）<div>想问下子域里面的通用域是指什么？为什么书中说通用域不可以被复用？那他为什么叫通用域呢？能举个实际例子讲讲核心域 支撑域 通用域吗 主要是通用域</div>2023-03-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/55/a3/88cbb981.jpg" width="30px"><span>　</span> 👍（0） 💬（2）<div>请问一下文档里绘图的工具是什么？打算在工作中试用下ddd，但是找不到好的画图工具</div>2023-02-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg" width="30px"><span>aoe</span> 👍（0） 💬（1）<div>「限界上下文是化解大型系统的利器，也是架构设计的基础」
这个基础知识我才知道，离架构设计近了一步</div>2023-02-27</li><br/>
</ul>