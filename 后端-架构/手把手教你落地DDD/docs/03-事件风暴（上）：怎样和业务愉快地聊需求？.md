你好，我是钟敬。

上一讲，我们正式开始了第一个迭代，并简单分析了迭代一的需求。今天，咱们就要根据DDD的基本开发流程，使用事件风暴方法来进一步梳理需求。

你可能会问，上一讲的需求好像已经说得挺清楚了，为什么还要用专门的方法来梳理呢？

其实，在真实项目，尤其是敏捷项目里，领域专家很可能不会像我们上一讲那样，一开始就把需求都一一列出来，需求可能仅仅停留在领域专家的脑子里。所以，我们就需要一种方法，能够将这些头脑中的需求挖掘出来。

而且，即便领域专家已经把需求写出来，我们也很难保证没有遗漏，保证开发人员都彻底理解了。而事件风暴不仅能帮助我们尽量把需求补充完全，而且还能以协作的方式保证业务人员和技术人员对需求理解一致。

此外，事件风暴方法也能够帮助我们识别领域对象，这也是我们进行领域建模前的重要一步。尽管对于建模高手来说，通过“聊天”的方式就能把模型画出来，但对于多数开发团队而言，还是需要一种套路化的方法作为辅助，一步一步地做。

这节课我们从实践入手，让你真正掌握事件风暴的概念和具体操作。

## 事件风暴是怎么一回事？

那么，事件风暴是怎么来的呢？

一般来说，为了理解需求，我们首先要分析系统具有哪些功能，这些功能由什么人操作，会产生什么效果。这个过程传统上叫做“捕获行为需求”。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg" width="30px"><span>Jxin</span> 👍（85） 💬（10）<div>1.上诉场景，有一个非常关键的依赖，你有一个全知全能的PO。很遗憾这个依赖它并不可靠，大部分情况你可能无法在项目初期拥有这么一位PO。所以上诉事件风暴顺利沟通的场景它可能很难成立。
2.那怎么办？如果没有这么一位PO那我们就补位。那么问题就从与关键PO进行领域风暴编程了PO如何快速了解领域知识，沉淀认知概念。
3.那怎么做？
A.绘制干系人地图，通过与业务专家&#47;客户项目负责人沟通，把当前参与领域活动所有的角色都定义出来。
B。与参与度最高的角色，一起梳理业务全景（第一次时间会比较长，需要尽量不遗漏），重心在提炼顶层关键业务阶段，和该角色在这个顶层业务阶段下的所有用户旅程（用户旅程要包含 绩效指标 耗时 频率 参与人数 痛点等多维数据）。
C.拿着这个顶层关键业务阶段去和相同角色的其他一线人员碰（这里有框架了，主要在确认认知准确性和挖掘遗漏点）。
D.拿着顶层关键业务阶段去和其他角色重复上诉 B、C两个步骤。刻画全角色的用户旅程，得到业务全景。
E.拿着业务全景去跟领导层沟通，汇报 + 达成共识。这个环节最主要的是识别出战略重心&#47;关键目标。领域知识本身是没有偏向性的，企业的战略才有。做子域划分要定义核心域，这里的核心域定义和选择很大程度取决于领导层提供的战略方向&#47;关键目标。
F.有了业务全景和关键目标，拿着这两件产物和业务专家过事件风暴。这样在事件风暴一开始就有框架和目标，最后事件流的产出，成效会好很多（因为一开始就有了边界和收敛的方向）。

到这里没PO补位PO的玩法就完了。接下来把后续工作步骤也补充下。

G.事件流本身聚焦在&quot;关键写&quot;流程，修改删除查询不会过多刻画。这么做的原因在于，事件流后续产出物是领域建模（我习惯四色建模），重心是识别关键模型、模型角色及模型间关联关系。这个阶段的模型产出是比较粗的粒度。
H.追加业务全景里面的删改查场景，进一步增加模型、丰富模型上的属性、调整模型类型。
I.拆分子领域（这里与建模其实是并行的，提取完业务知识和关键目标就可以做，这是问题空间的事情，而建模是解空间的事情。多数时候它们是交织开展的，虽然概念上做了区分，但现实里它们就是交织在一起的，相辅相成）。基于关键目标，确定阶段核心域。两条个人观点：战略会变核心域也会变；关注点在核心而不是边界。
J.将问题空间与解空间合并。把聚合按业务相关性分类到子域上。结合物理因素&#47;复杂度&#47;组织结构&#47;安全&#47;调用频率等等一系列因素圈限界上下文。

</div>2022-12-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/80/ec/b6149cbf.jpg" width="30px"><span>老狗</span> 👍（10） 💬（6）<div>思考题：
1. 修改删除之类的，有相关的业务才需要列出来，比如合同签订了就只能违约，不能修改和删除，那就只有一个合同已违约，修改和删除甚至创建都一样是技术术语，事件风暴最好用业务术语。技术术语 创建，修改，删除 业务术语 添加（录入） 签订 违约等
2. 个人不觉得事件风暴是一种产出物，事件风暴只能做中间产物，产出物可以用多种方式记录，比如偏业务的用户旅程地图、服务蓝图 偏技术的UML 领域模型（带业务规则），这些图里面相对事件风暴更好记录，如果强行用事件风暴，觉得便利贴不好维护，可以推荐一波 BeeArt https:&#47;&#47;www.beeart.com&#47; 在线白板

</div>2022-12-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/74/aa/178a6797.jpg" width="30px"><span>阿昕</span> 👍（8） 💬（4）<div>尝试用事件风暴的方式梳理了支付系统的领域事件，放在了共享白板上，欢迎一起来头脑风暴

https:&#47;&#47;boardmix.cn&#47;app&#47;editor&#47;3ywv0CZURp_x5wm2IDm8pQ?inviteCode=kjG6ak</div>2023-01-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/e0/76/77afa881.jpg" width="30px"><span>公众号：业余草</span> 👍（8） 💬（3）<div>事件风暴是一项团队活动，领域专家与项目团队通过头脑风暴的形式，罗列出领域中所有的领域事件。

企业落地过程中，往往把事件风暴和头脑风暴混为一谈。
领域专家可能并不专业，往往谁的“权利大”谁说了算。
团队活动，参与人不明确，干系人选择性参与会议，比较佛系。
业务建模不关我的事，业务已经很清楚了，怎么做能不能实现是你们的事。
DDD是啥我们并不关心，对我们没有价值，没有DDD我们也做到了上市企业。
。。。

DDD实践是一个工程问题，践行时也是一个过程，在过程中只开一两次对齐会议是解决不了领域建模问题的。如果从利他角度来讲，在这个过程中的不同阶段每个人都可以受益，但不是同时受益，有可能要先解决哪部分人先受益的问题。</div>2022-12-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/de/cf/ef2e0501.jpg" width="30px"><span>奇小易</span> 👍（5） 💬（1）<div>2w2h笔记

What
Q1：什么是事件风暴？
是一种通过协助完成需求梳理的方法。

Q2：除了事件风暴之外，还有什么方法也可以帮助梳理需求？
用例，use case，传统需求梳理方法。

Why:
Q1：为什么要使用事件风暴来做需求梳理？
1、业务人员与开发人员之间会通过协助方式来完成，可以使双方对需求的理解达成一致、补充遗漏的需求。
2、辅助识别领域对象。
3、事件风暴是结果导向的思路来梳理需求，更容易把业务想清楚。（DDD大师的经验）

How
Q1：怎样进行事件风暴？
1、识别领域事件。
2、识别命令。
3、识别领域事件和命令中的名词性概念。（领域模型的基础）
整个过程是一个动态协助的过程。

Q2：怎样进行“识别领域事件”？
1、业务人员和开发人员双方写出自己理解的领域事件。
2、通过沟通、协助来迭代领域事件，明确业务规则，构建统一语言，最终达成一致的理解。

Q3：在识别领域事件中使用的关键概念有哪些？
业务规则、统一语言、必然的事件和可选的事件、业务流程的名称。

Q4：什么是领域事件？
业务过程中业务人员主要关注的业务结果。例如：项目管理过程中，客户已添加。

Q5：什么不是领域事件？
1、技术事件不是领域事件。例如：数据库已插入。领域事件是业务角度的事件。
2、查询功能不能算领域事件。例如：客户信息已查询，

How Good

DDD常识
1、在DDD中的各种命名，一般优先使用约定俗成的业务术语。</div>2023-02-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/fd/58/1af629c7.jpg" width="30px"><span>6点无痛早起学习的和尚</span> 👍（3） 💬（2）<div>2 刷，再来留言，自己在团队实践过这个事件风暴，但不是协作方式，是我自己脑暴，根据产品 prd 来脑暴，然后脑暴一波再去找其他同事+产品 double check，不协作是因为他们不愿意做这个事</div>2023-04-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7d/b6/abdebdeb.jpg" width="30px"><span>Michael</span> 👍（3） 💬（1）<div>有个问题请教老师，我在做事件风暴的时候，如果事件本身很简单，但是业务规则非常复杂，这种情况怎么去揭示复杂的业务规则呢？</div>2022-12-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg" width="30px"><span>靠人品去赢</span> 👍（3） 💬（1）<div>其实想问一件事，就是有时候产品经理会把需求一些其它“模块的小问题”，弄到一个需求里，有时候感觉他这些小问题甚至比这个主流程需求，更耗时麻烦。像这种应该怎么样处理，尤其是给你安排了一个什么都不会拒绝，又很喜欢压工期的研发经理。</div>2022-12-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg" width="30px"><span>escray</span> 👍（3） 💬（2）<div>对于思考题，以增加功能为主的领域事件，我觉得不需要列举修改和删除功能，一面冲淡了领域事件的聚焦。特别是对于修改和删除操作本身不复杂的领域事件，就更没有必要了；修改和删除所关联到的规则，可以在业务规则中说明。

业务规则可以从文字说明量化为领域事件的属性，或者是一对多、多对多之类的关系，采用代码来表达。</div>2022-12-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/9d/c0/cb5341ec.jpg" width="30px"><span>leesper</span> 👍（3） 💬（2）<div>极客时间上的课程中，要数ThoughtWorks的各位老师讲课讲的深入浅出，钟老师，徐昊老师和郑晔老师都很厉害，我从中学到了很多

抓个虫：最后一幅图中有一个灰色便利贴：“只能在项目有小区内才能报工时”，应该是“只能在项目有效期内才能报工时”，编辑同志该打屁股，哈哈

思考题：

1. 如果修改和删除涉及重要的业务流程，我觉得应该列出来，但可以慢慢迭代，不必一次就思考的那么全；

2. 用实体便利贴确实不容易维护，可以建模完成后拍照，或者用一些工具比如draw.io画下来保存在电脑上，建模的时候投屏</div>2022-12-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/bc/dd/c9413f59.jpg" width="30px"><span>铿然</span> 👍（3） 💬（3）<div>最大的问题在于业务人员会按上述的领域事件跟开发聊么？ 他们不会认为加上“已”就是领域事件了，我们是学了DDD，业务人员并没有学，他们还是会用自己的术语。 第一步应该考虑业务人员实际会通过什么来描述需求，怎么描述？要不要教他们DDD，还是说就应用当前业务人员的术语来描述领域事件。

对事件的定义是什么，举个例子，刺客某日刺杀总统算不算一个事件？这个事件并不需要加上“已”才是事件。再举个例子，订单生成后要发送电子发票给客户，通常会说触发发送电子发票事件，这个事件可能尚未发生，但也是一个事件。

所以对于领域事件定义是什么，要素是什么？

加了“已”之后，更像一个结果，一个状态。相比而言“添加客户”比“客户已添加”能更好的表达事件。</div>2022-12-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/fb/dc/38f969ed.jpg" width="30px"><span>HeM</span> 👍（2） 💬（1）<div>我有几个疑惑想问下老师，还请帮忙解惑一下：
1.事件风暴的基于背景是什么，是基于系统流程还是业务流程，也就是说，事件风暴的事件是系统中会产生的事件，还是业务中会产生的事件？
比如说“合同已签订”，我觉得是站在业务的角度来说的，因为不会在系统签订合同，系统只能是录入签订好的合同，站在系统角度来说就是“合同已添加”。
那么同理“客户已添加”是站在系统角度来说的，业务不会说添加了一个客户吧，那么我就感觉“客户已添加”和“合同已签订”所基于的角度不同。
2.客户是什么时候绑定客户经理的，合同是什么时候绑定销售人员的，为什么在事件风暴里没体现出来，只有更换客户经理和更换销售人员</div>2023-12-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/fd/58/1af629c7.jpg" width="30px"><span>6点无痛早起学习的和尚</span> 👍（2） 💬（1）<div>因为是第一次学习 DDD，对很多理论知识也缺乏，所以做个小笔记+理解
事件风暴：
是什么？
在开发过程中（“捕获行为需求”）：为了理解需求，我们首先要分析系统具有哪些功能，这些功能由什么人操作，会产生什么效果。
传统会用：“用例”
DDD用：事件风暴
怎么做？

识别领域事件：
● 找到业务流程中发生了哪些事情；
  ○ 这里就需要一定的业务领域知识，这个业务流程里需要做哪些事
  ○ 比如：海外支付，有些就是预授权+确定支付，而不是一步做了确认支付流程
● 业务流程中每个步骤引发的结果，关注结果
● 命名标准：完成时+被动语态，eg：订单已提交
  ○ 优先使用约定俗成的通用业务术语，eg：已立项代替项目已创建
● 误区：
  a. 不要把技术事件（事务回滚）当做领域事件
  b. 查询功能不算领域事件，是指这个事件对某个事物有了影响（事件创建、修改、删除）
识别命令：
进一步说明是什么角色，做了什么操作，导致上述事情的发生；
识别领域名词：
从领域事件和命令中找到名词性概念，为进一步的领域建模打下基础。

回答课后思考：
1. 需要列，如果业务有诉求就需要列，列全，也便于后面做其他分析需要
2. 换个地方，在线协作等工具</div>2022-12-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/85/6e/a09d9c1a.jpg" width="30px"><span>传说</span> 👍（2） 💬（1）<div>纸上得来终觉浅，绝知此事要躬行。</div>2022-12-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/bc/dd/c9413f59.jpg" width="30px"><span>铿然</span> 👍（2） 💬（2）<div>补充一点，“客户添加”和“客户创建”差别并不大，业务上不会说“客户添加”，而是“发展新客户”更合适些，发展了新客户才会到系统里添加客户，“添加”贴近系统操作，例如在excel里增加新客户信息。</div>2022-12-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/29/87/e1/b3edcc09.jpg" width="30px"><span>范飞扬</span> 👍（1） 💬（1）<div>原文：“员工分配背后的业务逻辑有点复杂，所以之前单独拿出来讲，其实员工分配是项目运作中的一个重要环节，放在项目管理中也没毛病。”

---
问题：员工分配放到项目管理，但企业管理不放到项目管理中。什么放进去什么不放进去，这个度是靠领域专家拿捏吗？还是有方法论呢？
</div>2024-03-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/0c/e1/f663213e.jpg" width="30px"><span>拾掇拾掇</span> 👍（1） 💬（2）<div>跟我们平时需求评审很像，产品和开发一起在办公室开会，大家讨论每个步骤会产生什么副作用</div>2022-12-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/76/1c/e709be94.jpg" width="30px"><span>Din</span> 👍（1） 💬（1）<div>1. 修改和删除要视情况而定：领域事件一定是领域专家所关注的，用的业务术语。如果修改会引起业务流程的变化，例如合同金额发生变化，那是需要单独列出来的。如果只是修改了某个备注字段，就不需要单独列出来

2. 可以利用互联网的协作工具，例如白板</div>2022-12-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/f5/80/baddf03b.jpg" width="30px"><span>zhihai.tu</span> 👍（0） 💬（1）<div>1、我觉得如果有新增功能，那么删除和修改不一定要列出来。但对于存量功能，添加了“修改”和“删除”功能，可以列进去。
2、可以使用电子看板。</div>2024-02-25</li><br/><li><img src="https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLm8skz4F7FGGBTXWUMia6qVEc00BddeXapicv5FkAx62GmOnUNEcE4scSR60AmappQoNdIQhccKsBA/132" width="30px"><span>末日，成欢</span> 👍（0） 💬（1）<div>对识别领域事件还有点困惑
本文中对领域事件的定义是, 业务流程已经发生的那些事。 

因为我在本文中对领域事件的理解, 领域事件主要还是从业务流程中已经发生的事情中提取一些关键信息的, 后续用来做建模用的，可能还是有点类似传统的软件工程中提取需求的理解。
而我在其他资料说看到的是, 领域事件发生通常会导致进一步的业务操作, 它们用领域事件来解耦, 关注侧重点就不一样，它有这个含义吗？

还有一些问题
1.假如说用户在网上购买了一本书, 如果我想对这个流程进行建模, 最终的领域事件是说商品已下单还是说订单已支付, 我们关注是最终的业务流程结果, 还是只要是有意义的业务流程结果？ 如果存在多个中间业务结果, 是不是每个中间的业务流程也算事件, 只不过最终的是一个大事件？
2.假设一些领域实体, 它们本身业务逻辑不复杂, 就是简单的读取数据,落表这种的, 领域层还有必要吗？  
3.假设某个业务流程中, 需要使用7&#47;8个领域实体, 并且这个流程业务规则很复杂, 比如A业务规则还需要依赖3-4个领域实体,是不是搞一个领域服务,在这种做逻辑？
</div>2023-08-24</li><br/><li><img src="https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLm8skz4F7FGGBTXWUMia6qVEc00BddeXapicv5FkAx62GmOnUNEcE4scSR60AmappQoNdIQhccKsBA/132" width="30px"><span>末日，成欢</span> 👍（0） 💬（1）<div>事件风暴法第一步： 识别领域事件， 业务步骤发生的结果。 
如果是A步骤+B步骤+C步骤-&gt;导致的这个结果
比如说客户挑选优惠商品, 使用了优惠券, 进行下单,支付了0元。 
这个领域事件往往包含了多个步骤。 
比如优惠券已使用, 下订单, 商品已支付 
我想问, 每个步骤的结果都是领域事件吗？还是选择一个最主要的？
第二个,我想问下, 优惠券使用条件的规则, 就需要在识别领域事件的时候开始识别了是吧？</div>2023-07-28</li><br/><li><img src="https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLm8skz4F7FGGBTXWUMia6qVEc00BddeXapicv5FkAx62GmOnUNEcE4scSR60AmappQoNdIQhccKsBA/132" width="30px"><span>末日，成欢</span> 👍（0） 💬（1）<div>想知道事件风暴梳理的粒度是不是都很粗，比如一些业务逻辑检验都在什么时间点下谈论</div>2023-06-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/ea/14/35abc3aa.jpg" width="30px"><span>Johnson</span> 👍（0） 💬（2）<div>员工管理： 员工已添加， 员工已分配部门，员工已分配项目，员工已等级工时，
为何我列出来的这么多，和之前重复的需要过滤掉吗？
不太明白</div>2023-05-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e5/ab/6fab2492.jpg" width="30px"><span>2018</span> 👍（0） 💬（1）<div>问题一：有明确的业务事件的删除、修改相关的领域事件应该也要列出来
问题二：MacOS 13 系统的无边记 APP 感觉挺适合用来作为事件风暴的记录的</div>2023-03-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d5/31/b09432cc.jpg" width="30px"><span>@漆~心endless</span> 👍（0） 💬（1）<div>如何对未使用DDD设计的系统进行改造，或者我要重新去梳理整个系统的设计，从哪些方面入手可以更好的贴近DDD的设计呐？</div>2023-03-16</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/KFgDEHIEpnSoiaOuJic93Mr1ObEFfebXQCIBvwotBPppVZTIZCAmZQQttI0lmpadSbVBibGN3Ob3OuHsibbwNia9YaDfDNDy2jibLR/132" width="30px"><span>jiaoxn</span> 👍（0） 💬（2）<div>钟老师，我们部门在实践事件风暴的过程中，遇到个一个问题，向您请假一下。

我们系统中有GIS服务管理、服务器管理这两个流程，其中GIS服务管理需要依赖服务器管理流程，在整理GIS服务管理这个流程中，需要写出“服务器台账已录入”这个事件吗？</div>2023-03-14</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/4UBeJ4vlwbBU8ibVz6hdgr2Qozco6xSaIgRfNd2zvPPU7BTINsgKcW3MuQmrZ2A3AB0dyiccoHubZxukLZWmHVibw/132" width="30px"><span>plimlips</span> 👍（0） 💬（1）<div>价值需求、相关方识别等高层需求和捕获行为需求的关系和顺序是怎样的？</div>2023-01-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/12/6e/3a0b4930.jpg" width="30px"><span>FiRerOUNd</span> 👍（0） 💬（1）<div>真实的项目中可能还存在QA、运营和数据分析的同事。前端项目可能还存在UI、UE的同事。他们需要办与事件风暴吗？</div>2023-01-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/68/a3/595aa5b7.jpg" width="30px"><span>lin63</span> 👍（0） 💬（1）<div>我们在实践前尝试在事件风暴前有个用户旅程，这样大家讨论起来时可能更明确。关于思考题：
1. 修改与删除除了明确不实现，否则还是建议考虑展开一下;
2. 实体便利帖实践过，电子版也实践过，个人觉得电子版方便些。可能便利贴用得比较少，大家用得并不习惯，就像敏捷的看板，在我印象里公司在实体便利贴与电子间摇摆了多次，最终还是放弃了便利贴。

另外，请教老师两个问题：
   1. 关于事件风暴，有没有个评估标准，因为这个发散的过程，感觉时间比较长，没个量化标准，很难解释这样做是否值得。（从参与者我来说通过大家集体思考对整体业务有更详细的理解，但这个理由有点难支撑消耗的时间）
   2. 查询功能不算领域事件，关于这点，现实中我们碰到一个这样场景，开发的系统核心功能就是提供时效信息的，根据用户输入的地址信息，根据一些人为配置的规则，再根据库存等信息，一系统复杂全是查询动作然后输出一个时间信息，这个过程是相对复杂的，很多语言上可能要拉齐产品业务达成共识，若不体现出来，后续如何与开发拉齐认识，感觉有些缺失？我现在的处理方案时我虚构了个订单创建的过程，只是这个单是虚构的。</div>2022-12-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/82/ef/0badf9dc.jpg" width="30px"><span>Ice</span> 👍（0） 💬（1）<div>后面会讲用DDD如何落地遗留系统吗</div>2022-12-25</li><br/>
</ul>