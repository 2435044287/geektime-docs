你好，我是钟敬。

上节课，我们学习了“泛化”，并用这个技术完成了“在子项目上报工时”的需求。如果你是第一次学的话，可能会觉得理解起来有一些难度吧。

今天，我们继续这个建模过程，首先考虑“在子项目上报工时”这个需求的更多细节，增加更多的灵活性。

然后，我们来考虑另一个需求——“为内部项目报工时”。我们会采用使用泛化和**不**使用泛化两种方式为这个需求建模，并且比较两者的异同，以便你更进一步理解泛化的思路。事实上，用不用泛化有时不是一个非黑即白的决定，而是一种权衡。

还是我当项目经理，你当架构师。

## 增强灵活性

我们先回顾一下上节课建立的模型。

![](https://static001.geekbang.org/resource/image/08/5e/087bcd7e7f7f6a1be8a20abc3f90a25e.jpg?wh=3359x2368)

到现在为止，我们的模型已经基本可以满足按**项目**、**子项目**和**普通工时项**来报工时的需求了。

我们简单复述一下目前的需求。

- “零零后公司”只能按项目登记工时。
- “九零后公司”只能按子项目登记工时。
- “八零后公司”既可以按项目也可按子项目，还可以按普通工时项登记工时。

现在我开始向你提几个更深入的问题。

**第一个问题**是：怎么控制“零零后公司”**只能**按项目，而不能按子项目报工时呢？反之，怎么控制“九零后公司”只能按子项目报工时呢？

为了解决这个问题，你决定为每个租户增加一个配置参数。

![](https://static001.geekbang.org/resource/image/1a/f6/1aaff247659e9ee43ef44aeef6a87df6.jpg?wh=3359x2368)

所有租户级的参数，都在**租户参数**这个实体里。我们商量了一下，把新的参数命名为**项目工时粒度**，有三个选项，分别是：“项目”“子项目”和“两可”。对于“零零后公司”只要把这个参数设置成“项目”，就说明只能按**项目**来报工时。对于其他两个公司的需求，道理是一样的。
<div><strong>精选留言（10）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/1d/0a/7d/791d0f5e.jpg" width="30px"><span>子衿</span> 👍（16） 💬（2）<div>1. 结合我原来的知识，我理解是否要使用泛化，其实讨论的就是到底是使用继承，还是使用一个状态位来表达区别，那最终其实就是对面向过程还是面向对象的一个权衡，如果不用泛化，而是新增一个属性表示区别，如果该属性只影响这个类的一小部分行为还好，只需在这一小部分行为中加入if..else即可，但如果这个属性，影响了这个类的大部分行为，那就会产生一堆的if..else，此时不如使用泛化，让代码更面向对象，对于上一个迭代，我觉得开发中心、直属部门和组织之间的区别在于他们的性质，而性质这个属性对他们的行为影响不大，可以考虑不使用泛化实现
2. 多重泛化不能使用继承是因为java中不支持多继承，如果非使用继承实现，就会造成类的泛滥，这其实就是设计模式中桥接模式解决的问题</div>2023-02-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/28/cb/c5/c1d7ca5e.jpg" width="30px"><span>赵晏龙</span> 👍（3） 💬（2）<div>1 考虑泛化后增加模型复杂度，并且没有提供任何的必要性或者好处，我倾向于不使用泛化。

2 java .net里不能有多个父类？那我CPP来！等等，我是不是泄漏了内存？为什么提示我地址非法？你们先设计模型，我解决完这些马上就来！</div>2023-02-16</li><br/><li><img src="" width="30px"><span>邓西</span> 👍（2） 💬（1）<div>1. 个人理解，是否需要泛化的评判标准应该是各差异属性是否可以归类，用枚举等方式便可区分。如果是，那就没有必要泛化。
2. 求解。语言特性决定？Java不支持多继承，但C++可以</div>2023-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/4c/a0/6cfdefa6.jpg" width="30px"><span>特修斯之船</span> 👍（2） 💬（2）<div>我怎么感觉泛化的图更好理解，不喜欢用注解</div>2023-02-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/74/aa/178a6797.jpg" width="30px"><span>阿昕</span> 👍（2） 💬（1）<div>思考题，开发中心、直属部门和组织之间，主要区别体现在类型、上下级关系之间，只有属性的差异，不用泛化</div>2023-02-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/32/c2/dc/78e809b7.jpg" width="30px"><span>NoSuchMethodError</span> 👍（1） 💬（1）<div>泛化不泛化取决于是否具有属性的差异</div>2023-04-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/fd/58/1af629c7.jpg" width="30px"><span>6点无痛早起学习的和尚</span> 👍（1） 💬（1）<div>思考题，看了老师给别人的回复，想到了目前代码里实现的一个点，就采用了泛化类似的想法，感觉这也是一个泛化
在代码里的领域层的对象，都继承了AuditableEntity，这个就是不同对象之间的共性，子类又有不同的个性（字段属性）

不知道这样认为对不对</div>2023-02-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/95/2f/d88950a1.jpg" width="30px"><span>颜如玉</span> 👍（0） 💬（1）<div>继承通常只能解决单维度的泛化问题，多重泛化有多个维度</div>2023-07-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/77/a5/c5ae871d.jpg" width="30px"><span>zenk</span> 👍（0） 💬（1）<div>JAVA 每个泛化一个方法，不同的实现对应不同的泛化，而且一一对应，只是子类比较多，是每种泛化种类的乘积</div>2023-03-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" width="30px"><span>tt</span> 👍（0） 💬（1）<div>我觉得开发中心、直属部门和组织之间确实是泛化的关系，但是在这个项目里它们几乎是会存在的实体，为了明确，可以不用泛化实现。

至于多重泛化，我觉得不像是继承，而像是C++模板中的“偏特化”，就是对于模板中的某个属性做特定的实例化。所以不适合用继承实现。</div>2023-02-05</li><br/>
</ul>