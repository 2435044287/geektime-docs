你好，我是俊达。今天我们继续看第三章的思考题。

## 第25讲

问题：我们都知道InnoDB中每个索引都由2个段（Segment）组成，每个段由一系列区（Extent）组成，每个区的大小为1M。类似我们测试中的这个表，只写入了几行数据，那么为这个表分配一个区，是不是会有大量的空间浪费？MySQL是怎么解决这个问题的？

@叶明 在评论区提供了这个问题的解答。

第26讲中对这个问题也有解释。InnoDB每个索引都有2个段组成。每个段都有一个对应的Inode结构，用来跟踪一个段由哪些页面组成。

Inode中，有一个碎片页数组，可以记录32个页面的编号。

![图片](https://static001.geekbang.org/resource/image/b9/18/b9f6d2379fa31f47b3921e2d83ac0618.png?wh=1920x1116)

在给一个段分配空间时，会先以1个页面为单位分配，只有当32个碎片页都分配后，才会按1个区为单位，分配空间。

一个表刚创建时，表里还没有写入任何数据。InnoDB会给每个索引分配一个Root页面，而每个索引对应的2个段，此时只有1个段分配了页面，另外一个段里暂时还没有任何页面。

创建一个空的表，会占用多少磁盘空间呢？这跟表上的索引个数有关，因为要给每个索引分配一个Root页面。MySQL最多可以建64个索引（包括主键索引），你可以测试下，建一个有64个索引的空表，看一下ibd文件的大小。我测试下来，建一个有64个索引的空表，ibd文件是8兆。