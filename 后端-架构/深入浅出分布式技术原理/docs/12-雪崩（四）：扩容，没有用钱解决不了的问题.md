你好，我是陈现麟。

在降级的学习中，我们掌握了降级机制的应用场景，手动降级和自动降级的实现原理，以及降级机制值得注意的一些关键问题，这样我们就可以引入分级降级策略，来快速降低系统的负载，确保核心服务的可用性了。现在我们已经学习完了分布式系统稳定性的三板斧：熔断、限流和降级，以后对维护后端系统的稳定性就更有信心了。

虽然熔断、限流和降级，很大程度上保障了系统的稳定性，但是从结果来看，它们都是通过放弃一定的用户体验和可用性，来确保系统在过载情况下依然正常运行的，这是一种通过有损节流，来降级系统负载的思路，那么有没有一种无损的方式，可以保障系统在过载下依然正常运行呢？

其实，这个问题就引出了一个典型的扩容场景，在这节课中，我们将一起讨论保障分布式系统稳定性的最后一个方法——扩容，了解需要扩容的原因，讨论如何实现扩容，最后再一起分析扩容机制与云原生的关系。这里要说明一点，因为缩容是扩容的逆向操作，所涉及的思路，原理和扩容一致，所以在课程中就不分开说明了。

## 为什么需要扩容

在“雪崩”系列的前三课中，我们分别介绍了解决分布式系统稳定性的三板斧：熔断、限流和降级，它们从系统底线的保障、核心服务的保障和非核心服务的牺牲这三个角度，全方位地保障着分布式系统的正常运行。但是，正如课程开始提到的，这些方法本质上都是对系统进行降级，通过有损的方式来保障系统不会雪崩。
<div><strong>精选留言（6）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/8f/60/be0a8805.jpg" width="30px"><span>陈迪</span> 👍（3） 💬（2）<div>过载判断那里没理解。
按排队时间或者响应时间来判断很容易理解，但怎么变成下面变成“硬件指标”了，没搞懂这个逻辑。
“满载”指的又是啥</div>2022-02-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/19/29/4a8214b7.jpg" width="30px"><span>Bug Killer</span> 👍（1） 💬（1）<div>我们可以依据请求在队列中的平均等待时间来计算服务的负载
请求在队列中的等待时间怎么算</div>2022-03-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/59/91/fa2d8bb2.jpg" width="30px"><span>不吃辣👾</span> 👍（0） 💬（1）<div>一台虚拟机部署一个服务，虚拟机的硬件指标是不是可以代表服务负载问题？</div>2022-03-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（0） 💬（1）<div>请教老师两个问题：
Q1：容器垂直扩容，升级的是节点资源，怎么图形中Pod变大了？（Pod图标变大应该是意味着Pod的资源变多了吧）
Q2：如果不上云，扩容&#47;缩容有框架吗？还是说需要自己开发？
        如果上云，云会提供自动缩&#47;扩容机制，对吗？</div>2022-02-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/ba/e4/6df89add.jpg" width="30px"><span>芋头</span> 👍（1） 💬（0）<div>原则：
1.有状态的服务一般采用垂直扩容VPA(Vertical pod autoscale)
2.无状态的服务采用水平扩容HPA(horizon pod autoscale )
3.节点资源不够时需要CA（cluster autoscale)</div>2023-04-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg" width="30px"><span>Jxin</span> 👍（1） 💬（0）<div>1.文中漏了一个点。决策扩容的依据是什么？ 没有pod可用这是一个结果。判断pod能否支撑当前请求，不能有没有其他pod可以，都没有创建新pod。这已经涉及自适应负载均衡了，而这个在高并发场景很难实现，感兴趣可以想想。

2.一年多没关注了，之前的解法是采用大集群走负载均衡而不是自适应负载均衡，最后基于定时的负载检测决策是否扩容。</div>2022-02-25</li><br/>
</ul>