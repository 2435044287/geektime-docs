上学的时候，有门计算机专业课叫做面向对象编程，学这门课的时候有个问题困扰了我很久，按照面向对象编程的理论，对象之间通信需要依靠**消息**，而实际上，像C++、Java这些面向对象的语言，对象之间通信，依靠的是**对象方法**。对象方法和过程语言里的函数本质上没有区别，有入参、有出参，思维方式很相似，使用起来都很简单。那面向对象理论里的消息是否就等价于面向对象语言里的对象方法呢？很长一段时间里，我都以为对象方法是面向对象理论中消息的一种实现，直到接触到Actor模型，才明白消息压根不是这个实现法。

## Hello Actor模型

Actor模型本质上是一种计算模型，基本的计算单元称为Actor，换言之，**在Actor模型中，所有的计算都是在Actor中执行的**。在面向对象编程里面，一切都是对象；在Actor模型里，一切都是Actor，并且Actor之间是完全隔离的，不会共享任何变量。

当看到“不共享任何变量”的时候，相信你一定会眼前一亮，并发问题的根源就在于共享变量，而Actor模型中Actor之间不共享变量，那用Actor模型解决并发问题，一定是相当顺手。的确是这样，所以很多人就把Actor模型定义为一种**并发计算模型**。其实Actor模型早在1973年就被提出来了，只是直到最近几年才被广泛关注，一个主要原因就在于它是解决并发问题的利器，而最近几年随着多核处理器的发展，并发问题被推到了风口浪尖上。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg" width="30px"><span>QQ怪</span> 👍（28） 💬（2）<div>老师，actor模式具体实现的产品有哪些?想知道这些更加理解actor</div>2019-06-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg" width="30px"><span>aoe</span> 👍（16） 💬（2）<div>感兴趣的可以看看《响应式架构  消息模式Actor实现与Scala.Akka应用集成》</div>2019-11-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/31/c8/a64e4aef.jpg" width="30px"><span>兔斯基</span> 👍（15） 💬（4）<div>这种并发模型现实应用多么？系统往往很少有可以接受丢失消息的吧？</div>2019-06-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/5f/81/1c614f4a.jpg" width="30px"><span>stg609</span> 👍（12） 💬（1）<div>虽然一个actor 是不会有并发问题，但要是同时发给多个actor去处理呢，每个actor 都可能访问同一数据库或者redis 这种共享资源，那还是有并发问题吧</div>2020-05-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/d1/29/1b1234ed.jpg" width="30px"><span>DFighting</span> 👍（7） 💬（1）<div>Actor读起来好像流数据处理模型中的Operator，不过Flink解决一致性语义(exactly-once)使用的是轻量级一致性快照，即在每个节点内部缓存当前整个系统执行到何处的状态，不过代价就是需要在计算拓扑中传递状态，算是一种内存换一致性吧，不过现在存储愈发可得，这个代价应该也是可以接受的。</div>2019-10-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/ff/0a/12faa44e.jpg" width="30px"><span>晓杰</span> 👍（5） 💬（3）<div>请问老师actor模型的效率是不是会比较低</div>2019-06-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/24/33/76/9582bf05.jpg" width="30px"><span>浩</span> 👍（2） 💬（1）<div>老师怎么把actor用在实际开发中，在spring boot中集成
</div>2022-07-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/a0/cb/aab3b3e7.jpg" width="30px"><span>张三丰</span> 👍（2） 💬（1）<div>很长一段时间里，我都以为对象方法是面向对象理论中消息的一种实现，直到接触到 Actor 模型，才明白消息压根不是这个实现法。


老师是认为面向对象调用方法不叫消息？那么面向对象调用方法这种数据传递方式叫什么？</div>2019-10-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/48/f3/65c7e3ef.jpg" width="30px"><span>cricket1981</span> 👍（1） 💬（1）<div>&quot;也不保证消息送达的顺序和发送的顺序是一致的&quot; …… 想问下什么情况下会发生这种情形？MailBox不是类似Queue一样FIFO结构吗？</div>2019-06-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/fc/c8/15c85ee4.jpg" width="30px"><span>潭州太守</span> 👍（1） 💬（1）<div>请问老师，Actor是不是不适合低延迟场景，或者有没有策略保证低延迟。</div>2019-06-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/04/18/4b02510f.jpg" width="30px"><span>明天更美好</span> 👍（0） 💬（2）<div>遇到一个线程问题，我们有个业务要通过mq去通知第三方，但是第三方能力比较差，我们同步的时候mq堆积很多。后来改成用woker-thread模式，队列设置了2000线程用了64个机器是64核的，拒绝策论是当前线程执行该任务。结果发现队列很快就被放满了，一段时间后mq又堆积了。因为客户端没有及时签收消息，导致broker限流了直接不销费了，这种问题老师您有什么好的建议吗？</div>2019-06-04</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIcmZIPiaKWfMosmDmkejiac8TDhJKz3cygJ2pRJIBHmoeUCNUssSmjETAV9dyozW6c0y8TibNCXqd8Q/132" width="30px"><span>翡冷翠</span> 👍（21） 💬（1）<div>累加器这个例子里只是启动了四个线程去发送消息，实际累加只是在一个线程(actor)里进行的</div>2019-07-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e1/5c/86606d9c.jpg" width="30px"><span>湮汐</span> 👍（8） 💬（3）<div>感觉就像消息队列，但是是用单线程顺序消费的模式。</div>2020-05-19</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/3XbCueYYVWTiclv8T5tFpwiblOxLphvSZxL4ujMdqVMibZnOiaFK2C5nKRGv407iaAsrI0CDICYVQJtiaITzkjfjbvrQ/132" width="30px"><span>有铭</span> 👍（4） 💬（1）<div>Actor模型的最佳实践目前还是erlang，Java的akka有些不伦不类</div>2019-06-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/17/ba/c56aa720.jpg" width="30px"><span>new life</span> 👍（3） 💬（0）<div>actor 模型没有性能问题，我觉得是因为我们加锁保证线程安全，这个期间只有一个线程在对共享资源的持有，而actor只有一个线程处理消息，一样的道理，还省略了线程抢资源时候的切换开销，不知道理解的对不对；</div>2020-04-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/94/b8/3ac880b9.jpg" width="30px"><span>焕澪</span> 👍（2） 💬（1）<div>如果actor的核心武器是单线程消费，控制流程，无锁，避免线程切换和共享资源争用，那么，直接写串行程序岂不是更省力，也具备这些特征</div>2022-04-25</li><br/><li><img src="" width="30px"><span>Cv</span> 👍（2） 💬（0）<div>我理解示例中的累加器只是用了4个线程把累计动作丢到队列里, 累加器还是单线程消费队列的, 实际效率并不高</div>2020-01-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/1d/13/31ea1b0b.jpg" width="30px"><span>峰</span> 👍（2） 💬（0）<div>感觉核心就是通过消息对列实现消息的暂存，然后actor就可以一个接一个单线程处理消息。有点像redis，但不同的是不同actor的调用线程可能不一样，只要保证同一时刻最多只有一个线程处理某个actor就行，并且actor直接可以消息通信，意味着可以用多个actor去组织起来完成一次请求。</div>2019-06-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/3e/d1/17f3160c.jpg" width="30px"><span>军</span> 👍（1） 💬（1）<div>这里的Actor工作方式很像游戏里的角色Actor，ActorSystem就是游戏里的World</div>2019-10-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7f/ca/ea85bfdd.jpg" width="30px"><span>helloworld</span> 👍（1） 💬（1）<div>老师说Actor模型并不能保证消息100%可达，也不能保证100%能被处理，可见Actor模式适用的情形还是受限狭窄的</div>2019-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/b3/c5/7fc124e2.jpg" width="30px"><span>Liam</span> 👍（1） 💬（0）<div>actor，看erlang</div>2019-06-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/07/bb/97ba4ccd.jpg" width="30px"><span>邱</span> 👍（1） 💬（0）<div>要是有数据库io和纯cpu结合的大数据量高并发的实际就更好😊</div>2019-06-04</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKR3ibELhjgVicCNShZCBwvaDxibnzibggG4wUzVkS2mkDxUBZyIs87nDEdJ7PiahJBVoZcuhQ84RxAziag/132" width="30px"><span>周治慧</span> 👍（1） 💬（0）<div>万物皆是面向对象 早上好</div>2019-06-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/60/22/92284df2.jpg" width="30px"><span>TeamCC</span> 👍（0） 💬（0）<div>感觉最后这个累加器，和多线程往一个队列写，然后有一个单线程消费，类似</div>2021-10-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/db/d2/e29f8834.jpg" width="30px"><span>lidashuang</span> 👍（0） 💬（0）<div>erlang&#47;elixir 的并发模型也是actor</div>2021-10-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/10/de/dbf2abde.jpg" width="30px"><span>萤火之森</span> 👍（0） 💬（0）<div>框架级的等待唤醒？</div>2021-09-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg" width="30px"><span>mgs2002</span> 👍（0） 💬（0）<div>开眼了，actor模式第一次看到</div>2021-05-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/4f/c9/88837387.jpg" width="30px"><span>😜哈哈</span> 👍（0） 💬（0）<div>actor模型在flink中相似的用法</div>2020-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/dc/9d/e20b37d7.jpg" width="30px"><span>机遇号</span> 👍（0） 💬（2）<div>老师您好，能不能在继承UntypedActor这个类里将消息保存到数据库？具体怎么实现？能不能指点一下</div>2019-06-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/da/ec/779c1a78.jpg" width="30px"><span>往事随风，顺其自然</span> 👍（0） 💬（0）<div>Scala 编写spark 内部实现也是用这个通信机制</div>2019-06-04</li><br/>
</ul>