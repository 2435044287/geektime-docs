你好，我是黄俊彬。

上节课，我们一起了解了Android系统的架构，讨论了厂商在定制Android系统过程中一些常见的耦合问题。耦合不仅仅是一种代码上的问题，也给产品的质量以及团队的效率带来了非常大的影响。

这节课，我们将会学习整机组件化的架构设计，看看如何来解决上节课提到的耦合问题。接着针对这些耦合问题，探讨具体有哪些针对性的解耦策略。

## 整机组件化

通过上节课的学习，我们知道了Android的架构设计本身就是采用了分层组件化的方式，只是由于厂商在定制的过程中，没有遵循架构设计来扩展，才出现了腐化。典型的问题包括应用间的耦合、应用与框架的耦合以及框架与框架间的耦合，如下图所示。

![](https://static001.geekbang.org/resource/image/4e/20/4eb94098fa466064d2d1d6e274f1d120.jpg?wh=2692x1968)

但是定制就意味着增加代码，所以关键问题是**如何管理扩展的代码，才能把对原生代码的侵入降到最低，同时又要让系统更独立地演进。**

其实解决方法也很简单，就是沿用 **Android系统的架构，让我们自己扩展的代码也形成组件，能够在Android原生系统之上灵活插拔**，你可以对照下图来理解。

![](https://static001.geekbang.org/resource/image/76/bf/762705dc7d9161eddd328d736ff186bf.jpg?wh=2637x1968)

可以看出，厂商主要定制的代码分布在应用、框架与内核层。我们分别从这几层来看看组件化改造的思路。

### 应用层

第一个是应用层。应用层其实分2种类型，第一种是完全自己定制的应用，第二种是扩展AOSP中原有的应用（例如桌面、电话本、短信等）。
<div><strong>精选留言（1）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（0） 💬（1）<div>请教老师几个问题：
Q1：从APP开发者的角度，厂商定制会对开发者有哪些影响？ 其中，会对APP的适配工作有很大影响吗？
Q2：应用B依赖应用A，用SDK，此SDK是由应用B开发、维护吗？，
Q3：class AMSImpl没有写implements interface IAMS，是笔误、忘记了吗？还是不用implements？另外，AMSImpl应该是谁维护？组件吗？
Q4 APP安全问题。APP开发完成后，安全性方面，有哪些工作需要做？代码混淆就够了吗？“加固”这个词是指什么？</div>2023-04-07</li><br/>
</ul>