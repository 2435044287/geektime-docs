你好，我是聂鹏程。今天，我来继续带你打卡分布式核心技术。

还记得在专栏之初，我和你分享的“分布式四纵四横知识体系”吗？截止到目前，我已经带你学习了四横和三纵，包括分布式计算、分布式存储与管理、分布式通信、分布式资源池化、分布式协同、分布式调度和分布式追踪与高可用的关键技术（由于分布式追踪、分布式部署虽属于支撑技术，但并不会影响业务的构成，因此我没有在专栏中展开）。

但学以致用才是最终目的，所以在接下来的模块中，我将通过两篇总结性质的文章，为你串联起前面讲到的核心知识点，看看它们在业务中是如何应用的。

今天，我就先以购买火车票的流程，带你串联下整个专栏涉及的分布式核心技术吧。

首先，为方便你理解，并抓住其中涉及的核心技术，我对购买火车票的流程做了一个简化，大致划分为三大核心步骤：

- 首先，铁路局向购票系统发布火车票；
- 然后，用户通过系统查询火车票，找到需要的火车票后购买；
- 最后，购票系统给用户响应，完成购票。

这个流程看似简单，但涉及了我们之前讲过的很多知识。

这里，我有个小建议，在学习后面的内容前，你可以先自己思考下这个过程涉及了哪些知识点，然后再与我接下来的讲述进行对比，以验证自己对之前内容的掌握程度。这样一来，你可以加深对已掌握知识的理解深度，也可以查漏补缺进而有针对性地复习其他内容。
<div><strong>精选留言（9）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg" width="30px"><span>安排</span> 👍（4） 💬（2）<div>主备和主从的区别是什么呢？ 为什么有时候说主备，但是又把被叫做slave节点，都搞混了</div>2019-12-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d8/d6/47da34bf.jpg" width="30px"><span>任鹏斌</span> 👍（8） 💬（1）<div>老师能不能讲讲高并发下的库存扣减方案？如果完全依赖数据库的话容易出瓶颈吧？一般的大厂如何做这一块的？是不是要借助缓存？缓存的话要考虑缓存和数据库的一致性。感觉这一块要做好不容易。</div>2019-12-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/99/27/47aa9dea.jpg" width="30px"><span>阿卡牛</span> 👍（5） 💬（0）<div>分布式系统里面涉及太多知识点了，细节才是魔鬼</div>2019-12-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/3b/47/f6c772a1.jpg" width="30px"><span>Jackey</span> 👍（3） 💬（0）<div>发现前面的知识忘差不多了😂需要规划一下二刷了</div>2019-12-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg" width="30px"><span>随心而至</span> 👍（3） 💬（0）<div>重要的文章看三遍👀</div>2019-12-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（3） 💬（0）<div>现在的系统RMDB真正承担的是和付款相关的事情，MQ和NOSQL 承担了上面的环节。我记得这套系统早期是单独用了sybase,然后跪了，换了oracle效果提升不明显。
    如同老师之前课程所说的电商案例：拆分成了多个库，付款环节都有等待时间，这个时间才是真实与数据库的交互；最近看到的一些系统这方面做的很不好，导致数据库异常以及有时压力过大，这也是引发今年我仅仅是数据库性能优化问题然后就把组成原理和系统架构以及老师的分布式技术原理不惜一遍的原因。
    从原理的角度去看：有时有些业务问题更加看的清楚更能明白问题的根源所在；知道问题的根据就知道后续如何真正去处理和解决。
    谢谢老师今天的分享：一路跟随的过程其实很快，不知不觉发现课程居然快结束了，从初秋已至深冬了。谢谢老师一路的教诲，期待老师下周的分享。</div>2019-12-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg" width="30px"><span>钱</span> 👍（2） 💬（0）<div>回想一下我们的系统使用了那些分布式技术：
1：分布式负载均衡，几乎所有的服务都是分布式的，所以，负载均衡策略必不可少
2：分布式锁，比如控制只有一个业务用户可以导入数据或者刷新缓存
3：RPC、MQ、REDIS这些标配也少不了
4：有集群那分布式选主，故障隔离和恢复也必不可少
回想一下老师讲的这些都是会使用到的，在分布式系统中，这些好像是自行车的链条一般一个紧扣一个少了那个环节，整个链条就不再完整了，那自行车想跑起来就困难啦！
这一整套技术信息量比较多，也不是一个人或一个团队就能搞定的，就像分布式系统一样研发团队也是分布式的。有不同的研发小组就像一个小集群，里面会有一个小组长，然后有了需求组长会负责负载均衡的分发出去，根据不同组员的能力采用不同的策略。</div>2020-02-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/6b/f8/b4da7936.jpg" width="30px"><span>大魔王汪汪</span> 👍（2） 💬（0）<div>老师问下，是否采用半同步复制技术这种需要视业务场景而来吧，如果对于数据一致性要求很高是否完全采用同步方案呢</div>2019-12-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/9b/6e/edd2da0c.jpg" width="30px"><span>蓝魔丶</span> 👍（2） 💬（3）<div>文中“比如，用户 A 购买 2019 年 10 月 12 日北京到上海的 T12 的火车票，已购买成功，座位号为 3 车厢 23B。假设主节点和备节点之间数据不一致，主节点上已经减去该火车票，但未在备节点上减去。此时，若主节点故障，备节点升主，用户 B 此时申请购买相同火车票，系统将 3 车厢 23B 火车票又卖给了用户 B。等到乘车时，用户 A 和 B 就难免“打架”了”这个问题的解决方案是什么呢？</div>2019-12-14</li><br/>
</ul>