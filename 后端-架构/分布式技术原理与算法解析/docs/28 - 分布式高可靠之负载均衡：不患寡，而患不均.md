你好！我是聂鹏程。今天，我来继续带你打卡分布式核心技术。

到目前为止，我已经为你介绍了分布式起源、分布式协调与同步、分布式资源管理与负载调度、分布式计算技术、分布式通信技术和分布式数据存储。可以说，掌握了这些内容，基本上就掌握了分布式的关键技术。

然而，只有可靠的分布式系统才能真正应用起来。那么，分布式系统的可靠性又是如何实现的呢？

不要着急，接下来几篇文章，我会和你一起学习分布式可靠性相关的知识，包括负载均衡、流量控制、故障隔离和故障恢复。

在这其中，负载均衡是分布式可靠性中非常关键的一个问题或技术，在一定程度上反映了分布式系统对业务处理的能力。比如，早期的电商抢购活动，当流量过大时，你可能就会发现有些地区可以购买，而有些地区因为服务崩溃而不能抢购。这，其实就是系统的负载均衡出现了问题。

接下来，我们就一起来打卡分布式高可靠之负载均衡。

## 什么是负载均衡？

先举个例子吧。以超市收银为例，假设现在只有一个窗口、一个收银员：

- 一般情况下，收银员平均2分钟服务一位顾客，10分钟可以服务5位顾客；
- 到周末高峰期时，收银员加快收银，平均1分钟服务一位顾客，10分钟最多服务10位顾客，也就是说一个顾客最多等待10分钟；
- 逢年过节，顾客数量激增，一下增加到30位顾客，如果仍然只有一个窗口和一个收银员，那么所有顾客就只能排队等候了，一个顾客最多需要等待30分钟。这样购物体验，就非常差了。
<div><strong>精选留言（12）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/3b/47/f6c772a1.jpg" width="30px"><span>Jackey</span> 👍（2） 💬（1）<div>对一致性哈希+资源那有点不理解。想请问老师和各位大佬，如果空闲资源相同的话，是不是还要加入其他影响因素，否则多个节点在环中就等同于一个节点了。另外空闲资源一直在动态变化，这样还能保证相同的key的请求落在同一个节点吗？</div>2019-12-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/22/c8/f2892022.jpg" width="30px"><span>科科</span> 👍（1） 💬（1）<div>之前读陈述老师的高性能Linux服务端设计，研究分析了各种类型的服务端模型。
多进程的好处就是可以提高可用性，其实我们的分布式技术的话，也算是多进程的一种任务模型。同一台机器多进程来处理业务会产生会有限制。
现在我们可以增加多个节点，多台主机这样就产生了对分布式程序的需求。任务均分到各个机子上，可以提高整个系统的吞吐量，提升响应速度。同时均分也可以更好的利用所有节点的一个CPU的性能，不会出现局部空闲情况。
最后氛围多进程还是能提高的可用性，鸡蛋不要放在同一个篮子里</div>2020-06-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/69/88/528442b0.jpg" width="30px"><span>Dale</span> 👍（7） 💬（0）<div>1、提高系统的可靠性，避免出现单点故障
2、作为对外请求的统一入口，安全可控
3、通过添加或减少服务器数量，系统可以方便伸缩</div>2020-01-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg" width="30px"><span>随心而至</span> 👍（2） 💬（0）<div>提高可用性。
假如一个实例挂了，可以自动切换到其他实例，对系统整个影响不会太大。</div>2019-12-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg" width="30px"><span>钱</span> 👍（1） 💬（0）<div>在分布式系统中，负载均衡技术除了各节点共同分担请求外，还有什么好处呢？
1：提高性能
2：提高吐出量
3：提高系统可用性，7*24的服务保障就是这么来的
4：提高扩展性，加减机器比较容易
5：提高系统的可维护性，摘除异常机器简单
6：提高安全性，统一的对外请求入口，更容易控制
负载均衡方法小结：
1：随机
       一般随机
2：轮询
       顺序轮询
       加权轮询
       平滑加权轮询
3：哈希
       一般哈希
       一致性哈希
       带负载的一致性哈希
       带虚拟节点的一致性哈希
4：根据特定资源类型或者特点业务类型进行请求的分发</div>2020-02-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/aa/85/1fc30ee8.jpg" width="30px"><span>Leric</span> 👍（0） 💬（0）<div>基于随机数的负载均衡也是可以实现带权重的负载分配的呀</div>2022-07-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/7c/25/70134099.jpg" width="30px"><span>许凯</span> 👍（0） 💬（0）<div>可以提高系统的高可用、高性能、高扩展，同时消耗更多能量，安全性和监控变复杂</div>2020-06-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/25/00/3afbab43.jpg" width="30px"><span>88591</span> 👍（0） 💬（0）<div>1、提供统一入口，增加易用性，方便统一管理。
2、增加系统的容错能力，减少单点故障，提高可靠性
3、还可以增加系统的可扩展性。可以动态增加减少节点
</div>2020-04-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/20/b7/bdb3bcf0.jpg" width="30px"><span>Eternal</span> 👍（0） 💬（0）<div>负载均衡是分布式系统实现高可用的前提，没有它就只能玩单机了，</div>2019-12-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（0） 💬（0）<div>       典型且常规的负载均衡其实就是读写分离：现实场景中的多种负载均衡同时存在；这种平衡性我觉得很多时候才是难以把握的方面。web层大多用的是轮询策略、DB层大多是哈希和一致性策略，站在整体系统架构的角度，各种轮询负载均衡的合理使用我觉得这是最难的地方。</div>2019-12-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/99/27/47aa9dea.jpg" width="30px"><span>阿卡牛</span> 👍（0） 💬（0）<div>可以处理由于单点故障引起的系统不可用问题，提高系统的可用性</div>2019-12-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/29/c6/7fd7efa3.jpg" width="30px"><span>xingoo</span> 👍（0） 💬（0）<div>还可以实现高可用，一个节点坏掉，其他的也可以提供请求。</div>2019-12-02</li><br/>
</ul>