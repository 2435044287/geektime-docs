你好，我是聂鹏程。这是专栏的第一篇文章，我们先来聊聊什么是分布式。

与其直接用些抽象、晦涩的技术名词去给分布式下一个定义，还不如从理解分布式的发展驱动因素开始，我们一起去探寻它的本质，自然而然地也就清楚它的定义了。

在今天这篇文章中，我将带你了解分布式的起源，是如何从单台计算机发展到分布式的，进而帮助你深入理解什么是分布式。为了方便你更好地理解这个演进过程，我将不考虑多核、多处理器的情况，假定每台计算机都是单核、单处理器的。

## 分布式起源

### 单兵模式：单机模式

1946年情人节发布的ENIAC是世界上的第一台通用计算机，它占地170平米重达30吨，每秒可进行5000次加法或者400次乘法运算，标志着单机模式的开始。

所谓**单机模式**是指，所有应用程序和数据均部署在一台电脑或服务器上，由一台计算机完成所有的处理。

以铁路售票系统为例，铁路售票系统包括用户管理、火车票管理和订单管理等模块，数据包括用户数据、火车票数据和订单数据等，如果使用单机模式，那么所有的模块和数据均会部署在同一台计算机上，也就是说数据存储、请求处理均由该计算机完成。这种模式的好处是功能、代码和数据集中，便于维护、管理和执行。

单机模式的示意图，如下所示：
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/11/52/33/abf321b7.jpg" width="30px"><span>吾皇万岁万岁万万岁</span> 👍（227） 💬（28）<div>之前去会所，一口气叫上十个嫩模，到房间之后，我就给她们讲Quorum协议怎么实现节点选举，蒙特卡洛方法的实际应用，MVCC怎么实现事务的并发，tcp怎么做到传输可靠…她们很感兴趣，我也很愉快的就回来了。
后来我朋友听了，他们也想去，于是去了五个人（五人同行，两人免单），这次可以服务50个嫩模，每人10个，在不同的房间，我们又给她们讲了Quorum协议…蒙特卡洛…MVCC…tcp传输等等，她们很开心，我们也开心的回来了。
再下次的时候，也去了5个人，但这次我们想服务更多的嫩模，于是我们进行了现场分组，想听Quorum的和第一个朋友走，想听蒙特卡洛的和第二个朋友走，想听MVCC的和第三个朋友走……于是我们每个人只讲一个知识点就回来了，很轻松也很开心，所以我们经常去会所。

上面三部分，依次单机模式、数据并行、计算并行。

后来，会所里面的姑娘都有了正经的职业，叫程序员鼓励师！</div>2019-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/93/c7/86352ccc.jpg" width="30px"><span>1024</span> 👍（31） 💬（3）<div>## 分布式起源
### 单兵模式：单机
将服务和数据都部署到同一个节点(服务器)上
存在的问题：单点故障，单点性能瓶颈
### 游击队模式：数据分布式
实际上是水平分层
1. 数据分层
2. 将数据分离
就是针对不同的请求，去路由到不同的数据节点上
存在问题：对提升单个任务的执行性能及降低时延无效

### 集团军模式：任务分布式
实际上是垂直分层
拆分服务到不同节点，一个任务可能要请求多个服务，多个服务并行执行
类似于不同兵种，各司其职，协同作战
存在问题：数据的全局一致性（各节点通信），数据的可用性保证（副本），各节点的调度（哪个节点可以响应服务）
### 总结
我理解的分布式：将一个任务，拆分成多个子任务，每个任务都对应一个服务，每个服务又都部署到不同的节点上，实现一个任务，多服务并行响应，最后通过调度、统筹返回请求的结果
为什么会有分布式：是我们对性能、可用性、及可扩展性的不懈追求

### 课后问题
传统的并行计算是时空上复用多处理器
分布式是空间上给任务分配多处理器</div>2019-09-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/cf/3b/679b518b.jpg" width="30px"><span>臧咔嚓</span> 👍（18） 💬（3）<div>&quot;分布式其实就是将相同或相关的程序运行在多台计算机上，从而实现特定目标的一种计算方式。“
这就相当于说 ”分布式是一种计算方式“，感觉有点别扭，套用到分布式协调、分布式计算、分布式存储上，感觉更别扭。</div>2019-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/c7/ba/4c449be2.jpg" width="30px"><span>zhaozp</span> 👍（9） 💬（1）<div>打卡文章学习：
    1、分布式是系统架构不断演进的结果，是对系统性能不断追求的结果。单机模式的缺点是性能瓶颈并且有单点故障。这时系统中往往最先出现的数据瓶颈所以先出现数据并行（分库分表，读写分离)等，任务也会水平扩展增加节点通过负载均衡路由，缺点就是对提升单个任务的性能和时延无效。随着系统的复杂性提升，任务的执行成为系统瓶颈，这时需要对任务进行拆分，拆分成小粒度的子任务，容器技术也实现了子任务单独部署，当然缺点是引入了系统的复杂度。
    
2、分布式其实就是将相同或相关的程序运行在多台计算机上，从而实现特定目标的计算方式。结合&quot;四横&quot;：数据并行就是对数据存储和管理的分布式化、任务并行就是对计算方式的分布式化，也会涉及资源池的分布式和通信的分布式。结合&quot;四纵&quot;：数据和任务拆分后怎么解决分布式协同、分布式调度、分布式高可用的问题，容器化技术也致力于解决分布式部署问题。

课后思考：
    我理解传统的并行计算还是运行于单服务器，其核心在于充分利用服务器的CPU、内存等资源，可以通过多线程并发技术实现。而分布式是把任务拆分到不同的服务器上，是业务解耦，提高可用性和可扩展性。但是也引入了系统设计复杂度。</div>2019-09-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/b9/ff/ea6c2e86.jpg" width="30px"><span>景梦园</span> 👍（5） 💬（1）<div>世界上的任何事物都是在做Trade-Off，根据奥卡姆剃刀原则，能用简单的就不用复杂的。虽然在学分布式，但是也要看到三种模式各有优劣的。另外最近也在学并发编程，感觉并发编程是”微观“的分布式，系统级是”宏观”的，触类旁通。</div>2020-05-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/52/32/bb570f48.jpg" width="30px"><span>向往的生活</span> 👍（3） 💬（1）<div>厉害</div>2019-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4e/90/a8d19e7b.jpg" width="30px"><span>张理查</span> 👍（1） 💬（1）<div>分布式技术原理与算法#Day2
今天打卡了第一节和第二节课，解决了两个议题，第一个是究竟什么算分布式，第二个是如何评价分布式系统。
首先我们将系统抽象成代码和数据。所谓单机模式就是部署在一台机器上，但第一是性能有瓶颈，第二是挂了系统就没了，存在单点问题。我们解决这个问题的思路是分数据和分代码：分数据，又叫并行计算，就是将数据分多台机器，跑同样的代码，这样好处是解决了性能瓶颈，但有三个问题，一是分配均匀的问题，可以引入负载均衡器，二是分布后的数据如果单一入口访问，会有IO瓶颈，可以通过读写分离解决，其实就是增加入口，三是热点数据的问题，我们通过缓存机制可以解决。分数据相当于通过增加员工数量解决项目过多的问题，但无法解决单个项目的完成时间，这里假设一个人干一个项目。分代码，就是分解项目分工，通过增加工种数量来提升单个项目的方式，因此分代码包括业务拆分和子业务并行两个步骤，好处就是可以找到代码瓶颈，有的放矢，但这么做的代价就是引入了复杂性，毕竟工种多了，多个人干一个项目就有协调的问题。
那么什么是分布式呢？其实就是我们不满足单个机器的性能，可用性，因而将代码用多台机器来跑，如果任务简单就是数据量大，那我们就拆数据，代码不变，一起跑。如果任务复杂，那我们就拆代码，有性能瓶颈的任务多分点机器干。
当然，你肯定会想又切数据又切代码。这在生产也很常见。</div>2019-12-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/42/46/274d8dcc.jpg" width="30px"><span>summer</span> 👍（0） 💬（1）<div>赞</div>2019-09-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/71/4c/2cefec07.jpg" width="30px"><span>静水流深</span> 👍（0） 💬（1）<div>打卡第二天，谢谢老师分享</div>2019-09-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/75/6c/e054948b.jpg" width="30px"><span>c-xyy</span> 👍（12） 💬（0）<div>分布式强调拆分，如果面对的问题的瓶颈在数据量，则讲焦点集中在数据的拆分上，也就是数据分布式；如果问题的瓶颈在任务执行逻辑的复杂性上，则将任务进行拆分，也就是计算的分布式；讲相同的逻辑部署在多个节点上，一般称之为集群，平时我们经常说分布式集群系统，实际的包含了底层任务的拆分和多机部署的含义。</div>2019-10-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/31/c6/27225119.jpg" width="30px"><span>longhaiqwe</span> 👍（12） 💬（1）<div>首先，单核是无法实现真正的并行计算的，更多的是使用时间分片的方式，在各个“计算”之间跳动执行。
然后，多核是可以实现真正的并行计算的。那我们为何不在机器上增加CPU和内存，而是去研究分布式这样的技术呢?
我的思考哈，因为一台机器做好了放那儿，硬件是已经确定了的。假如我们需要更好的性能，也就是更多的CPU和内存，我们当然可以把机器拆了，然后现场改板子加CPU和内存，不过明显我只是为了强调不可行才说的“当然可以”。分布式的作用之一就在于我们不需要改变原来的机器，而是增加一台机器来达到增加CPU和内存的目的。这就是我理解的“可扩展性”，分布式能带来“高性能”无疑，不过不考虑在原来机器上增加CPU和内存的难度，我觉得不使用分布式技术也是可以做到的。
最后，假设我们在一台机器上增加CPU和内存是不需要任何成本的（服务不断），也存在假设这台机器挂了，我们的服务也就会中断的问题。而使用分布式，也就是多台机器，即使其中一台挂了，还有其他机器可以对外提供服务。这就是我理解的“可用性”。</div>2019-10-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/69/88/528442b0.jpg" width="30px"><span>Dale</span> 👍（9） 💬（0）<div>分布式核心在于将任务拆解分布在不同的服务器上，业务解耦，提高性能和可用性。并行计算核心在于充分利用服务器cpu，内存，网络资源，可以将单个任务以多进程多线程方式来运行。分布式中采用并行计算可以提高性能。</div>2019-09-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/4f/b2/1e8b5616.jpg" width="30px"><span>老男孩</span> 👍（8） 💬（0）<div>传统的并行计算，拿单核来说就算通过CPU的指令在多个进程或者线程间切换来实现宏观上的并行，微观上还是串行的。多核是可以真正实现并行的。传统的并行计算是同一个主机的不同进程或者线程，分布式是不同物理主机中的进程或者线程。</div>2019-09-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/2d/ca/02b0e397.jpg" width="30px"><span>fomy</span> 👍（3） 💬（0）<div>如果系统的瓶颈在数据量太大，则对数据进行分片，如MySQL的数据分片和Redis Cluster。
如果系统的瓶颈在于业务复杂，耦合度太高，则将任务拆分到各个微服务，分别部署到不同服务器上，这就是常说的分布式微服务。
如果系统的瓶颈在于单个微服务负载过高，难以处理高并发请求时，则使用集群部署，同一个微服务有多个实例，应该也可以叫做并行计算吧。</div>2019-11-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg" width="30px"><span>djfhchdh</span> 👍（3） 💬（0）<div>并行计算强调运算的同时进行，对于多核处理器，就是每个处理器都同时进行运算；而分布式更多是从数据、任务的并行上来考虑，通常是利用多台机器，较少考虑多处理器并行的问题</div>2019-09-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/1e/f2/453d5f88.jpg" width="30px"><span>seker</span> 👍（2） 💬（0）<div>单机模式是指所有应用和数据均部署在一台服务器上，由这一台服务器来完成所有处理。
个人理解：应用和数据库在不拆分的情况下，同时部署在一台服务器上，或分别部署在一台服务器上(应用一台服务器、数据库一台服务器)，均可视为单机模式。
优势：应用和数据集中，好维护、好管理、好执行。
劣势：从硬件层面说，CPU、内存、磁盘均有瓶颈，不可能无限制的升级，升级还需要考虑性价比，同时硬件也存在损耗。从软件层面说单应用单数据库如果因异常挂掉，那么将导致服务不可用，对用户使用造成影响，对公司业务造成损失。综上劣势归纳为一句话就是会存在单点失效问题。

数据并行&#47;数据分布式
数据不一定是指数据库，应用中是否包含数据？答案是包含的，比如从页面传递给服务端接口的数据、服务端接口返回给页面用于展示的数据、接口中计算产生的数据、接口为具体业务封装的可以装载数据的数据结构等。因此数据不仅存在于数据库中，也存在于应用中。只不过数据库中数据是做了持久化到磁盘的。
这种模式的一个关键点是利用多台计算机并行处理多个请求，且每台计算机都完整的执行一个请求。
优势：解决单机模式计算效率瓶颈问题，相同时间内可以完成更多的请求处理。
劣势：无法提升单个任务的执行性能及降低时延。

任务并行&#47;任务分布式
将单个复杂的任务拆分为多个子任务，从而使得多个子任务可以在不同的计算机上并行执行。多个子任务中独立的子任务(没有对其它子任务强依赖的任务)，可以在同一时刻被执行，这样就使得原本单个复杂的任务执行时间变短了。
优势：提高了任务执行性能、降低了延时
劣势：带来了设计上的复杂性，即业务拆分难题</div>2021-07-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/f1/a4/79c36b87.jpg" width="30px"><span>流云</span> 👍（2） 💬（0）<div>传统的并行计算通常是在一个计算机内，共享内存等设备，多个CPU直接的通讯走的是总线，这种通讯时延低可靠性也强；对于分布式系统，多个计算机是需要依赖网络来通讯，而计算机网络通常是不太可靠的，在物理距离内有不可逾越的延迟时间。</div>2020-03-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg" width="30px"><span>钱</span> 👍（2） 💬（1）<div>阅过留痕
哈哈，和自己的理解一致，假设单机的容量无限，性能极佳，永不宕机，那就没分布式啥事了啦！并且整个宇宙只需要一台计算机就行了，可惜假设不成立，但人类又希望有这样一台神一样的计算机，所以，分布式就出现了。
侠义的容量无限，性能极佳，永不宕机也就实现了，一台容量不够来两台，一台不够快来两台（要想快，必须并行着来，大任务或数据必须是可拆分的，且拆分后可以并行着来）一台挂了另一台顶上。
其他的一切都是围绕怎么拆？怎么合？怎么协调来做文章的啦！</div>2020-02-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ec/7b/708a8734.jpg" width="30px"><span>阿亮</span> 👍（2） 💬（2）<div>任务并行不是特别理解。如果有一个任务有多个任务组成，且是顺序执行的，前后有依赖，在这种情况下，无论怎么拆分也是不可能提高效率的吧，如果放到不同机器上，是否还会降低执行效率？</div>2019-10-02</li><br/><li><img src="" width="30px"><span>Geek_设计模式之美</span> 👍（1） 💬（0）<div>感觉这个课 还行 在盗版正版之间犹豫</div>2021-08-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg" width="30px"><span>旅途</span> 👍（1） 💬（0）<div>数据并行例子中，上面两个服务访问下面的数据库是不是应该是交叉的，每个服务都可以访问下面两个数据库,否则就是服务和地点有绑顶关系，按你接下来说的请求转发，那么就是根据查询的地点来指定特定的服务器，而不是负载均衡了</div>2019-10-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（1） 💬（0）<div>   关于分布式和并行计算的区别：
   1）从虚拟化这块来解释：分布式其实就是我们现在所最常用的Kubernetes或者docker,传统的并行就是Vmware
    2）从数据系统这块来来解释就是：RMDB和no sql DB的区别；RMDB严格遵守ACID特性，nosql 做不到只能在CAP中选择其中的2项。
   不知道这样的解释是否算是一种解释吧。</div>2019-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/e4/e5/82132920.jpg" width="30px"><span>亦知码蚁</span> 👍（1） 💬（1）<div>老师举的数据并行的例子 不是任务并行吗 让他们处理各自的地区的订单 只不过没把任务划分成更小的子任务</div>2019-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/e4/e5/82132920.jpg" width="30px"><span>亦知码蚁</span> 👍（1） 💬（2）<div>我还是不理解 数据并行和任务并行的区别 任务并行时 不会划分数据吗 老师说 通常结合两者使用 如何结合 能举一个例子吗</div>2019-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d3/40/0067d6db.jpg" width="30px"><span>AKA三皮</span> 👍（1） 💬（4）<div>集团军引入的复杂性，我的理解就是服务拆分引入的复杂性：数据聚合、分布式事务等等</div>2019-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/22/1b/e6/83a50274.jpg" width="30px"><span>荆轲</span> 👍（0） 💬（0）<div>你觉得分布式与传统的并行计算的区别是什么？
我谈谈我的想法，不一定对。
本质上我觉得从并行角度出发，传统并行计算和分布式都具备相同能力。那为什么还要引入分布式呢，可能是有几个问题：
1：传统并行计算单机会受到硬件限制
2：传统并行计算会存在单机故障（这个很致命）
从这两个问题来看，分布式可以做一些处理：
1：比如既然单机有限制，他就多机协调，从而突破单机性能
2：既然单机故障，我就多机协调，从而避免单机故障
，从而一定程度解决了上述问题，当然也带来了更加复杂的处理问题。</div>2025-01-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/fe/b4/295338e7.jpg" width="30px"><span>Allan</span> 👍（0） 💬（0）<div>传统的并行计算是什么样子的？本节也没说，我的理解传统并行计算就是对程序进行多线程的计算，实际还是利用了充分利用了单核的能力。而分布式，则是将一个程序分发到多个机器上， 充分利用都了多核能力。</div>2024-08-14</li><br/><li><img src="" width="30px"><span>Geek_06a17e</span> 👍（0） 💬（0）<div>如果瓶颈不是在数据库，而是在业务机器，那么需要扩展机器，这种没有必要去做数据的切分，感觉还可以再划分一个类别。</div>2023-09-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/37/da/ad/791d0f5e.jpg" width="30px"><span>SiyingLI</span> 👍（0） 💬（0）<div>个人理解，仅供参考。
分布式计算一定属于并行计算，且分布式中许多概念以及分析都是依托于并行计算。
但并行计算却并不一定是分布式计算，根本区别在于分布式数据存储与管理这一纵。
刚刚开始学习老师的课程，只能先依据本人之前的研究工作经验在此记录浅陋的回答。</div>2023-08-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg" width="30px"><span>张申傲</span> 👍（0） 💬（0）<div>【思考题】个人理解，传统的并行计算是任务单机上运行，利用多核CPU和线程调度等方式提升计算性能；而分布式则是运行在多台机器上，通过协作来执行任务。两者的根本区别在于是否需要网络通信。</div>2023-05-19</li><br/>
</ul>