你好，我是大明。

恭喜你学完第四章的内容，又到了要验收成果的时刻了。缓存这一章的内容很重要，知识也很系统，所以为了帮助你更好地掌握这部分内容，我们在这里设置了面试题。

你在回答的时候，最好是能够写成一个个文档，至少也要口头上说一遍。千万不要仅仅在脑海里面回忆一遍。因为在真正面试的时候，脑海中的记忆到嘴里说出的话，还需要一个转换。

## 31 为什么 Redis 不立刻删除已经过期的数据？

01. Redis 是怎么删除过期 key 的？
02. Redis 为什么不立刻删除已经过期的 key？
03. Redis 为什么不每个 key 都启动一个定时器，监控过期时间？
04. Redis 是如何执行定期删除的？
05. 为什么 Redis 在定期删除的时候不一次性把所有的过期 key 都删除掉？
06. 当你从 Redis 上查询数据的时候，有可能查询到过期的数据吗？
07. 当 Redis 生成 RDB 文件的时候，会怎么处理过期的 key？
08. 当 Redis 重写 AOF 文件的时候，会怎么处理过期的 key？
09. Redis 定期删除的循环是不是执行得越频繁就越好？
10. 如果设计一个本地缓存，你会怎么实现删除过期 key 的功能？
11. 你是怎么确定过期时间的？过期时间太长会怎样，太短又会怎样？

## 32 缓存淘汰策略：怎么淘汰缓存命中率才不会下降？

1. 你知道什么是 LFU，什么是 LRU 吗？可不可以手写一个？
2. 什么情况下使用 LFU，什么情况下使用 LRU？
3. Redis 支持哪些淘汰策略？你们公司的 Redis 上的淘汰策略使用了哪个？为什么用这个？
4. 你使用的本地缓存是如何控制内存使用量的？
5. 你业务里面的缓存命中率有多高？还能不能进一步提高？怎么进一步提高？
6. 假如说 A 和 B 两个业务共用一个 Redis，那么有办法控制 A 业务的 Redis 内存使用量吗？怎么控制？
7. 现在我的业务里面有普通用户和 VIP 用户。现在我希望在缓存内存不足的时候，优先淘汰普通用户的数据，该怎么做？
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（0） 💬（1）<div>请教老师几个问题：
Q1：前面讲过ThreadLocal吗？如果没有，能否加餐讲一下？
Q2：我准备做一个网站，需要用到Redis。是自己搭建Redis还是用云服务厂商的Redis？更进一步地说，整个网站，包括服务处理的机器，是采用云服务厂商的设备还是自己搭建？
Q3：本地缓存，有现成的框架吗？还是自己开发？</div>2023-09-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/24/da/54/33dabd0a.jpg" width="30px"><span>闫同学</span> 👍（1） 💬（0）<div>再分享一个常见面试题：手写一个LRU😁</div>2024-05-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/22/c4/9f/a01e4bd1.jpg" width="30px"><span>海浪</span> 👍（0） 💬（0）<div>先mark一下，正在准备面试，希望有帮助</div>2024-03-19</li><br/>
</ul>