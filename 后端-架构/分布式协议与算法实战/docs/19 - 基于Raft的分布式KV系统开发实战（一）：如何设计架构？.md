你好，我是韩健。

学完前面2讲之后，相信你已经大致了解了Raft算法的代码实现（Hashcorp Raft），也掌握了常用API接口的用法，对Raft算法的理解也更深刻了。那么，是不是掌握这些，就能得心应手的处理实际场景的问题了呢？

在我看来，掌握的还不够，因为Raft算法的实现只是工具。而掌握了工具的用法，和能使用工具得心应手地处理实际场景的问题，是两回事。也就是说，我们还需要掌握使用Raft算法开发分布式系统的实战能力，然后才能游刃有余的处理实际场景的问题。

我从这个角度出发，在接下来的2节课中，我会分别从架构和代码实现的角度，以一个基本的分布式KV系统为例，具体说一说，如何基于Raft算法构建一个分布式KV系统。**那么我希望你能课下多动手，自己写一遍，不给自己留下盲区。**如果条件允许的话，你还可以按需开发实现需要的功能，并将这套系统作为自己的“配置中心”“名字路由”维护下去，不断在实战中加深自己对技术的理解。

可能有同学会问：“老韩，为什么不以Etcd为例呢？它不是已经在生产环境中落地了吗？”

我是这么考虑的，这个基本的分布式KV系统的代码比较少，相对纯粹聚焦在技术本身，涉及的KV业务层面的逻辑少，适合入门学习（比如你可以从零开始，动手编程实现），是一个很好的学习案例。
<div><strong>精选留言（10）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/1b/b0/fd/740245c7.jpg" width="30px"><span>zzl</span> 👍（15） 💬（3）<div>consul的读一致性default模式，是从leader节点读的，为啥不一定是最新数据呢？zookeeper的leader节点，读取的数据一定是最新的吗？</div>2020-04-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/05/92/b609f7e3.jpg" width="30px"><span>骨汤鸡蛋面</span> 👍（2） 💬（1）<div>按照老师的表述以及对源码的理解，是否可以认为 应用层组件与 raft 库的分工
1. 应用层负责 设计协议接入层以及FSM 的实现（接入和底层存储）
2. raft 负责接入层和持久化之间（raft 也有log存储的部分）</div>2020-05-22</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoz2e0Ka1CFfMIgZ8XHaVukpJm0Upibh68Wplru5a6zv0SkibM668tVaIGdMjpUHN8wEmiaTVtWgiahKQ/132" width="30px"><span>lingjiango</span> 👍（2） 💬（1）<div>节点故障后是不是可以先容忍一部分，在容忍的过程中是不是部分节点又恢复正常了？</div>2020-04-07</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKhuGLVRYZibOTfMumk53Wn8Q0Rkg0o6DzTicbibCq42lWQoZ8lFeQvicaXuZa7dYsr9URMrtpXMVDDww/132" width="30px"><span>hello</span> 👍（2） 💬（1）<div>老师，请教您一个问题呀，数据的冷热分离，比如基于时间的日志数据可以比较好区分，如果没有明显时间跨度的数据有什么好办法实现冷热分离吗？或者都有哪些冷热分离的策略可供参考？多谢！</div>2020-03-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/99/27/47aa9dea.jpg" width="30px"><span>阿卡牛</span> 👍（2） 💬（3）<div>目前市面上有哪些成熟开源的分布式KV框架可直接用</div>2020-03-27</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erY7671v8F2joiaBbnCPsbJ6ExFruIMDsd9HRSORsOZgbzBrKibDibU9CRCGghI56hUiampklDWzMFc4A/132" width="30px"><span>华子</span> 👍（1） 💬（1）<div>请问老师以后会不会介绍multiple raft group相关内容？</div>2020-04-17</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/4uiaFspOvPSF8tzalkP0DvCDme7v53eDGkDMsZsibcm31W99Sib2thFe9m3714d4t7qtIcSeyuR1HiaTXZs4TG8enQ/132" width="30px"><span>钟友兵</span> 👍（0） 💬（1）<div>韩老师，有点不太明白使用boostrap启动，称为领导者。一般分布式系统，系统安装配置指定master 。这里的话麻烦解释一下</div>2020-05-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg" width="30px"><span>pedro</span> 👍（0） 💬（3）<div>问老师一个问题，如果POST请求新增一个kv键值对，第一个请求新增成功后，应该会给出成功的响应，但若是重复POST请求，第二次应该会失败，这样怎么保证幂等性呢？</div>2020-03-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/04/f3/a3ff8a58.jpg" width="30px"><span>roseduan</span> 👍（11） 💬（3）<div>我使用 Go 语言实现了一个单机版的kv数据库：https:&#47;&#47;github.com&#47;roseduan&#47;rosedb，后续改造为分布式的，多谢老师的指点。也希望大家一起来学习！</div>2021-05-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg" width="30px"><span>Heaven</span> 👍（0） 💬（0）<div>可以在多次发出同步日志的时候,都获得超时的恢复,考虑进行节点的替换,在RemoveServer函数中,可以通过传入失效这个节点的集群的ID来进行删除</div>2020-08-25</li><br/>
</ul>