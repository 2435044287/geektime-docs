你好，我是文强。

这节课我们来看一下如何在消息队列内核中支持 WebSocket。如果你以前了解过 WebSocket，就知道 WebSocket 是一个协议。我们在[第03讲](https://time.geekbang.org/column/article/670596)中讲过，消息队列在自身私有协议的基础上，还会支持像HTTP这样的公有协议。

那为什么需要支持WebSocket协议呢？又是如何支持的？带着这两个问题，我们开始今天的课程。

## WebSocket 是什么

首先，我们来了解一下 WebSocket 是什么。

WebSocket 是一种基于 TCP 传输协议的应用层协议，它设计的初衷是解决Web应用程序中的实时双向通信问题。它跟 HTTP 协议一样，也是一种标准的公有协议。所以它也有协议头、协议体、数据帧格式、建立连接、维持连接、数据交换等等各个细节。

这里网上的资料有很多，就不展开细讲了。你只要记住一个重点：**WebSocket 是一个可以在浏览器中使用的支持双向通信的应用层协议**，就可以了。

那什么是双向通信呢？

### 双工（双向）通信

回答这个问题之前，我们来回顾一下计算机网络基础中的单工通信和双通通信。

1. **单工通信**指的是数据只能在一个方向上传输，而不能在另一个方向上传输。例如，广播电台只能向接收者发送信息，接收者无法向电台发送信息，这是单工通信的一种。
2. **双工通信**指的是数据可以在两个方向上传输。例如，电话通信就是双工通信的一种，通话双方可以同时说话和倾听对方的声音。