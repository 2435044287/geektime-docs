你好，我是徐长龙，这节课我们讲一讲如何实现分布式链路跟踪。

分布式链路跟踪服务属于写多读少的服务，是我们线上排查问题的重要支撑。我经历过的一个系统，同时支持着多条业务线，实际用上的服务器有两百台左右，这种量级的系统想排查故障，难度可想而知。

因此，我结合ELK特性设计了一套十分简单的全量日志分布式链路跟踪，把日志串了起来，大大降低了系统排查难度。

目前市面上开源提供的分布式链路跟踪都很抽象，当业务复杂到一定程度的时候，为核心系统定制一个符合自己业务需要的链路跟踪，还是很有必要的。

事实上，实现一个分布式链路跟踪并不难，而是难在埋点、数据传输、存储、分析上，如果你的团队拥有这些能力，也可以很快制作出一个链路跟踪系统。所以下面我们一起看看，如何实现一个简单的定制化分布式链路跟踪。

## 监控行业发展现状

在学习如何制作一个简单的分布式链路跟踪之前，为了更好了解这个链路跟踪的设计特点，我们先简单了解一下监控行业的现状。

最近监控行业有一次大革新，现代的链路跟踪标准已经不拘泥于请求的链路跟踪，目前已经开始进行融合，新的标准和我们定制化的分布式链路跟踪的设计思路很相似，即Trace、Metrics、日志合并成一套系统进行建设。
<div><strong>精选留言（2）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg" width="30px"><span>👽</span> 👍（2） 💬（1）<div>请教一下，TraceID 是什么时候生成的呢？单体服务的时候，我们是filter层生成。微服务的话，因为起始服务是不确定的，应该在哪一步生成呢？我的初步构思实在网关层，比如spring cloud gateway这一层注入一个，然后每个组件依次传递。

不过也有别的问题，就是比如定时任务之类的系统自发的请求链路应该如何生成呢？</div>2023-04-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/d0/b4/a6c27fd0.jpg" width="30px"><span>John</span> 👍（0） 💬（1）<div>老师，我有个疑问想请教下，未来的趋势是使用open telemetry 规范来使用Metric &#47; Tracing &#47;Logging?
那么ELK 遵循了open telemetry 规范？两者之间是什么关系呢</div>2022-11-20</li><br/>
</ul>