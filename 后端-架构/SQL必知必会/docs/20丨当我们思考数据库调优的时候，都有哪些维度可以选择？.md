从这一篇开始，我们正式进入了SQL性能优化篇。在这一模块中，我们会关注如何提升SQL查询的效率。你可以思考一下，如何你是一名DBA或者开发人员，都有哪些维度可以进行数据库调优？

其实关于数据库调优的知识点非常分散。不同的DBMS，不同的公司，不同的职位，不同的项目遇到的问题都不尽相同。为了能让你对数据库调优有一个整体的概览，我把这些知识点做了一个梳理，希望能对你有一些帮助。

今天的课程你需要掌握以下几个方面的内容：

1. 数据库调优的目标是什么？
2. 如果要进行调优，都有哪些维度可以选择？
3. 如何思考和分析数据库调优这件事？

## 数据库调优的目标

简单来说，数据库调优的目的就是要让数据库运行得更快，也就是说响应的时间更快，吞吐量更大。

不过随着用户量的不断增加，以及应用程序复杂度的提升，我们很难用“更快”去定义数据库调优的目标，因为用户在不同时间段访问服务器遇到的瓶颈不同，比如双十一促销的时候会带来大规模的并发访问；还有用户在进行不同业务操作的时候，数据库的事务处理和SQL查询都会有所不同。因此我们还需要更加精细的定位，去确定调优的目标。

如何确定呢？一般情况下，有两种方式可以得到反馈。

### 用户的反馈

用户是我们的服务对象，因此他们的反馈是最直接的。虽然他们不会直接提出技术建议，但是有些问题往往是用户第一时间发现的。我们要重视用户的反馈，找到和数据相关的问题。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/19/f7/46/209ca424.jpg" width="30px"><span>Coool</span> 👍（32） 💬（1）<div>先选择好的装备，再选择好的作战路线，必要时请外援</div>2019-10-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/01/00/326f3d4d.jpg" width="30px"><span>庞鑫华</span> 👍（17） 💬（3）<div>老师，网上的说法是5.5之后都建议使用InnoDB了，不建议MyIsam了，这点您怎么看</div>2019-07-26</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKjX37aIYNjm4SOVDoACNe4TL5jFOkDPgFa7uTRKzDj0yN1uacEuyNzfyZt1DpIIjYL0Ribfhs9YIw/132" width="30px"><span>Geek_fzsbxd</span> 👍（7） 💬（1）<div>上面有个朋友说的很对，还可以通过修改参数进行优化。另外，还可以从硬件层面考虑优化</div>2019-08-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/5a/5e/a897cb0d.jpg" width="30px"><span>grey927</span> 👍（6） 💬（3）<div>老师你好，这部分内容，希望有些具体的实验用例，或者您可以推荐一些比较好的将数据库性能优化的书么？</div>2019-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/f9/2c/791d0f5e.jpg" width="30px"><span>zw_learn_2</span> 👍（5） 💬（1）<div>老师你好，请问比较好用的业务应用服务器资源监控工具有哪些？</div>2019-08-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/e7/a3/155e0fb9.jpg" width="30px"><span>张磊</span> 👍（3） 💬（3）<div>老师，您好，我想问下， 哪里 可以 买到 ， 你专门   比较 系统的 讲解 mysql 优化的 课程 ， 或者 您给 推荐下 买 哪个 课程 可以 学习到这方面的 课程 。      谢谢。 期待您的 回复。 </div>2019-11-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg" width="30px"><span>许童童</span> 👍（3） 💬（1）<div>前者可以理解为单兵作战，尽可能提升单兵的能力。
后者相当于直接组团，一起对外作战。</div>2019-07-26</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJKkThulMFj6MiaY8qlsmHWrlIzo1SEhwDjwpgLP2bhLYETx1f0DepRDsBdssd5dFKN35zzFUYnia1Q/132" width="30px"><span>luck_tou</span> 👍（2） 💬（1）<div>老师提到的宏观角度非常重要，平时我接收的一般都是零散的知识点，能有个框架把他们归类记忆非常重要</div>2020-03-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg" width="30px"><span>骑行的掌柜J</span> 👍（2） 💬（1）<div>对数据库优化有了一个概览 谢谢陈老师</div>2019-12-20</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIR9QrAn9TZOrJMSYMyN96PAuAjETVrN5SPp3hMbfUAGIWtHceWPEoQtPdXeuBn7VB7dagtxynAIA/132" width="30px"><span>ballgod</span> 👍（2） 💬（1）<div>老师会有专门的讲解B-数和B+数还有红黑树之类的章节吗？ 网上看到好多关于为什么mysql使用B+数的问题，很多讲的不是很清楚。</div>2019-12-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/98/ee/9d162043.jpg" width="30px"><span>文艺科技青年</span> 👍（2） 💬（1）<div>这个课程买的太值了</div>2019-09-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/0d/45/b88a1794.jpg" width="30px"><span>一叶知秋</span> 👍（2） 💬（1）<div>打卡</div>2019-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/04/c8/c75f4f2d.jpg" width="30px"><span>张小倔</span> 👍（1） 💬（2）<div>到了这个“优化阶段“，还真就少人了 ？</div>2019-09-05</li><br/><li><img src="" width="30px"><span>yezhulin99</span> 👍（1） 💬（2）<div>列式存储数据库也不一定就是NoSQL哦,  SAP HANA 了解下?</div>2019-08-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/37/e6/71bcbc93.jpg" width="30px"><span>渴望飞的哺乳类</span> 👍（1） 💬（4）<div>老师您好，请问文中“通常在重复度超过10%的情况下，可以不创建这个字段的索引。”这个10%是如何分析得来的，是经验所得吗？</div>2019-07-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/69/bf/58f70a2a.jpg" width="30px"><span>程序员花卷</span> 👍（0） 💬（1）<div>每篇都是纯纯的干货，以后都可以当字典来使用，老师太厉害了！</div>2019-12-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/00/bb/25a29311.jpg" width="30px"><span>森鱼</span> 👍（0） 💬（1）<div>这一章突然好抽象</div>2019-09-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg" width="30px"><span>奕</span> 👍（8） 💬（0）<div>对于mysql主从，主库写，从库读。这样的话从库的表引擎是不是可以和主库的不一样(主库使用InnoDB引擎)，使用MyISAM引擎了呢？希望老师解答</div>2019-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/5f/27/a6873bc9.jpg" width="30px"><span>我知道了嗯</span> 👍（6） 💬（5）<div>目前线上mysql的版本是5.6，有一张表的数据已经到了一亿，目前就对两个唯一流水号建了索引，我想对插入时间也建索引，这个会导致数据库奔溃嘛，另外我可以通过复制一年以前的数据到另外一张表并且删除当前表的数据嘛？</div>2019-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（5） 💬（2）<div>其实纵向切分就是分成主从表：不过主从表最大的隐患是如果此表过于重要必然带来大量的级联查询。
其实在优化方面可能您忽略了一点：参数优化。即用用了第三方库，参数优化还是可以一定程度的提升性能；应当是三者结合吧。</div>2019-07-27</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/AUfUPzmpoBhuFIlhXtteCL1otfTpMOw5w9grO1kJ2DWZ2eCibxdFskh7r6JKpCdFHGPzpUugM5Rxcic3zg3PyPoQ/132" width="30px"><span>彭潇</span> 👍（3） 💬（0）<div>反反复复学了二十天了 终于到优化篇了  从存储过程开始基本都刷三遍以上 这块实在用的太少了</div>2020-05-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/23/6c/785d9cd3.jpg" width="30px"><span>Snooker</span> 👍（2） 💬（0）<div>1.工作中，比较少能接触到数据库瓶颈，不过会留意新需求或优化中*新接口是否会涉及大数据量查询，接口设计、表设计是否合理等，然后再测试环境通过模拟生产数据量进行初步验证。
2.调优维度，大方针：从选型、从内到外，然后逐步分析内部原因有哪些，外部有哪些。比较能接触到的，内部：表设计精简字段（针对关键字段还是有一定长度冗余）、精简索引、部分表索引重建、使用explain查看SQL语句执行计划、查看分析运行日志，外部：redis热点数据缓存、数据推送大数据，借助大数据提供统计查询等、业务层处理（调用频率限制等）。</div>2020-08-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/9a/28/03613c22.jpg" width="30px"><span>track6688</span> 👍（1） 💬（0）<div>除了数据库层面的优化，我觉得还可以从业务代码上优化，例如：我们可以通过关联一次查出几张表的数据，也可以通过单表查询再拼接的方式，有可能比关联查询速度快。</div>2020-03-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg" width="30px"><span>钱</span> 👍（0） 💬（0）<div>作为程序员，动手的主要在查询优化上
1：链接配置
2：虚拟查询优化
3：物理查询优化
4：分库分表
5：主从分离
6：冷热分离
7：增加缓存或es</div>2024-08-22</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJpwMjZzzOb4weh6TicW1hlLiayFas1krJwGduPXhOx2bGvklcz6TQ8FapcXzPGLkH3P5HZ7B8Zvbrg/132" width="30px"><span>羊小高-1995</span> 👍（0） 💬（0）<div>小菜鸟的我有一个问题，这些数据库调优的方法，对于Spark SQL调优有用咩？在Spark中使用场景多吗？</div>2022-02-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/23/6c/785d9cd3.jpg" width="30px"><span>Snooker</span> 👍（0） 💬（0）<div>当然对比内部优化，还是要熟悉了解dbms底层实现原理，才能根据不同场景，修改系统默认值适应不同用户场景；当然大大佬们还可以直接通过修改源代码，让软件适应产品。</div>2020-08-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/b3/23/92eaa22e.jpg" width="30px"><span>CodeWolf</span> 👍（0） 💬（0）<div>很棒的一节课，介绍地蛮清晰</div>2020-07-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/6c/f1/9ab33f89.jpg" width="30px"><span>Geek_Song</span> 👍（0） 💬（0）<div>老师，针对那种需要多表关联的情况，是多表关联好呢，还是单表查询再拼接好呢？</div>2020-06-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/f1/7e/8925aba5.jpg" width="30px"><span>小熊</span> 👍（0） 💬（0）<div>这一节不错，受教了</div>2020-04-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/c8/84/6bed045c.jpg" width="30px"><span>听见风在歌唱</span> 👍（0） 💬（0）<div>学习打卡</div>2020-03-20</li><br/>
</ul>