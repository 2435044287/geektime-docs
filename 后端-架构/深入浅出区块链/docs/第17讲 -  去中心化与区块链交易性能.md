通过前面的文章我们了解了一些区块链的基本技术细节，今天这篇文章我将带你一起看看区块链争议的最大内容——去中心化与区块链交易性能。

比特币和以太坊的TPS一直被技术领域的人所诟病，或许这与工程师“高性能高并发”的情节有关。

那么说，去中心化与高性能TPS是否真的可以做到鱼和熊掌的兼具呢？区块链业界又采取了哪些方案进行改善呢？围绕这两个主题，我们开始聊聊今天的话题。

## 再谈去中心化

说到区块链的最大标签，莫过于“去中心化”，在任何讨论区块链的场合，这个词几乎都会被提起。

今年3月份，全球顶级数字资产交易平台OKEX的负责人徐明星曾经发文，他表示业界应该避免使用“去中心化”这样的词汇，而改用“点对点”，“点对点”一词后来甚至被直接冠到了比特币白皮书的标题上。

去中心化与点对点有区别吗？我认为是有的，去中心化是包含了一定政治主观色彩的词汇，点对点只是一个中性词汇，更适合用来描述系统的性质。

去中心化这种说法树立了一个无形的靶子，这个靶子可大可小，大到政府机关，小到小商小贩。

正如我们说的是P2P网络，而不是去中心化网络。所以在技术领域使用点对点，而不是去中心化，可以避免这种概念被过度消费，

说到了“过度消费”，我认为“去中心化”已经演变成了区块链行业对外宣传的消费概念，这是一种情怀消费，它消费了人们对强权者的不满，例如店大欺客的商家、死皮赖脸的中间商、缺乏诚信的供应商。

这些内容，你或多或少都在生活中经历过，当“去中心化”的口号响起的时候，人们终于找到了一个发泄口，强烈的共鸣放大了区块链的光环，造成了区块链能掀起一场大革新的错觉。

革新肯定是有的，但去中心化只是表象，如果我们加深层次去理解，就可以发现数字货币和数字资产带来更多的是交易效率的成倍提升。

人类的现代文明是建立在交易的基础上的，没有交易就意味着直接回到了农耕社会。所以交易效率的提升才是区块链的根本所在，那么说，区块链本来是这样看似低效的TPS，为什么说它提高了交易效率呢？

我们先回到传统的交易模式来看一看。

交易首先是基于中心化平台的，当我们进入某个中心化平台，在这个平台内部，交易效率是提升了，但是我们回顾整个交易的生命周期，就会发现这个平台可能只是交易的一环，平台和平台之间的协作似乎并不是那么顺畅。

跨境支付便是典型的例子，市值长居Top3的区块链项目Ripple就是为了解决跨境支付的难题而产生的。

我们再来看区块链点对点的交易模式，它的TPS看似低效，但是它提供了全局无缝衔接的资产流转过程，这减少了整个交易生命周期的步骤，这也是区块链提升交易效率的关键所在。

所以说，虽然中心化系统能提供优秀的高性能服务，但是慢在人工审核、平台之间衔接、内部审计，平台之间的协作业务推进，想必你一定也深有体会。

## 技术上的去中心化

我们在聊DPOS共识机制的时候，提到过一个TPS的计算公式，

**TPS = (block\_size * network\_bandwidth * witness\_performance) /**  
**(block\_time * witness\_count)**

其中witness\_count 记账节点的数目与准入门槛在业界的争议比较大，如果完全去中心化的话，首先就意味着记账节点没有准入门槛，记账的节点可以无限多，当然这只是一个理想环境，工程实施的可行性几乎为零。

比特币全球的全节点1.2万个，大大小小的挖矿节点只有几十个，常出块的只有5大矿池，但是比特币依然没有限制记账节点的准入门槛，以太坊也是如此。而在EOS中，既规定了记账节点的数目，又规定了门槛。

可以这么说，控制了记账节点的数量和准入门槛，就等于决定了区块链TPS的大小。

为了帮助你深层次地理解去中心化与TPS的关系，这时候我们再次回到之前一直提到的CAP定理中。

CAP定理中，C为最终一致性，决定了出块时间的长短。A是可用性，这个是必选的，必须要保证区块链7 X 24 X 365全部可用。

P是网络分区容忍性，P的含义在区块链上有两层，第一层是必须保证分区可容忍，也就是一旦出现因为网络分区而导致区块链分叉，必须有一种机制可以合并区块链；第二层含义是如果我们尽量避免出现网络分区，那么就可以避免P的出现，从而提升C的性能。

C和P是可以相互调整的，有两种情况。

- 情况1，如果我们选择调整C，也就是拉长了最终一致性的确认时间，那么对P的要求就会减弱，也就是网络产生分区不要紧，反正区块链有足够的时间恢复最终一致性。
- 情况2，如果我们选择调整P，也就是限制较少的记账节点的数量，并且对记账节点之间的带宽提出要求，降低出现网络分区的可能性，那么对C的要求就会减弱，就可以降低出块时间。

情况1就是比特币和以太坊的典型思路，情况2就是EOS的典型思路。

区块链属于分布式系统，通过简单分析我们可以知道，区块链交易TPS与去中心化的具有不可调和性，任何一个号称TPS过万的区块链项目肯定是极其中心化的（至少技术上是的）。

所以，那些试图兼具高性能与去中心化的工作大多都是徒劳的。
<div><strong>精选留言（12）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/54/ff/09a058f3.jpg" width="30px"><span>solar</span> 👍（3） 💬（2）<div>Pow +dag 一定程度可以提交tps，代表币种：xdag.</div>2018-05-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/47/7e/3f90b77a.jpg" width="30px"><span>宋文傑</span> 👍（2） 💬（1）<div>老师 后续没有看到你介绍DAG的 可以具体介绍一下吗</div>2019-01-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/63/af/226bf1b2.jpg" width="30px"><span>Clancey</span> 👍（2） 💬（1）<div>1、通过增加区块的大小提高tps不能满足要求吗？
2、未来可不可以通过提高带宽和其它物理性能来满足tps的要求？
3、除了当今的区块链，历史上还有没有其他的技术或运动来实现去中心化的目的？结果如何？</div>2018-05-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/7f/10/84a4caf6.jpg" width="30px"><span>徐威</span> 👍（2） 💬（1）<div>为什么说可用性上dpos和联盟链是一样的。类似bts也是稳定运行了5年啊。</div>2018-05-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/51/ed/b825f9ca.jpg" width="30px"><span>张坚</span> 👍（1） 💬（1）<div>如果dpos的节点本身就是DAC，分布自治社区，那dpos得去中心化效果是不是会更好点。eos的其中一个节点eosdac就是这样的。</div>2018-05-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/58/19/df089b23.jpg" width="30px"><span>bailang</span> 👍（2） 💬（0）<div>是的，去中心化 不是个好词。</div>2018-05-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/9a/89/babe8b52.jpg" width="30px"><span>A君</span> 👍（1） 💬（0）<div>在区块链里，CAP的核心是C和P，提升C的性能，减少一致性所需的时间，也就是减少出块时间，分区容忍性P就会降低，这就需要像dpos这类的共识机制通过减少挖矿节点才能实现。反之，虽然降低C的性能会让出块速度减慢，但这会带来更强的分区容忍性，即使局部网络有分区的出现也会自动同步到全网主链上。</div>2021-02-20</li><br/><li><img src="" width="30px"><span>红透天边</span> 👍（0） 💬（1）<div>老师，请问从测试的角度怎么测试区块链平台的性能呢</div>2020-02-25</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/g1icQRbcv1QvJ5U8Cqk0ZqMH5PcMTXcZ8TpS5utE4SUzHcnJA3FYGelHykpzTfDh55ehE8JO9Zg9VGSJW7Wxibxw/132" width="30px"><span>杨家荣</span> 👍（0） 💬（0）<div>极客时间第二期
21天打卡行动 15&#47;21
&lt;&lt;深入浅出区块链17&gt;&gt;去中心化与区块链交易性能
回答老师问题:
还存在哪些提升 TPS 的方案呢？各有什么样的优劣？
off-chain
大致方案就是交易双方锁定准备金，把海量的交易打包以后上链，链上只保存交易的最终结果。通过智能合约和线下的多重签名机制，作弊方将会被罚没准备金。
闪电网络中锁定的比特币只能用在闪电网络中，只有交易通道关闭的时候才能真正成为链上承认的货币，这在理论上会出现类似银行挤兑的情况。如果大家对闪电网络失去信心，集中关闭通道，会拖垮比特币网络。但，这个似乎也不是很大的问题，只要闪电网络没有爆出什么漏洞，比如说签名算法被攻破之类的。
2.交易是在链外执行，链上无法验证提交的交易是否最新版本，虽然脚本保证了提交旧版本交易的攻击者有被罚没准备金的风险，但前提是要防御者监控网络并提交更新版本交易的证据。也就是说从原来比特币的被动防御（私钥不丢失就能保证资金安全）转变成主动防御。从这个角度看也算是降低了Security吧。这个主动防御的操作交给用户也不太现实，最终必然会衍生出一些服务公司，代替用户保存链外交易凭证，并防止作弊。某种意义上面又从“去中介化的信任”转变为需要信任中介了。这个角度看，似乎也是牺牲了Decentralization。
3.闪电网络中只有保存最终的资金状态保存，中间的交易细节全部被忽略，支持者认为是保护了用户的隐私，反对者认为是损失了交易数据。
4.因为通道需要准备金维持，不可能任意两个用户间都存在交易通道，用户之间转账可以通过中转的方法，最终很可能会有大资金形成中心化的中转节点。
[出自链接：https:&#47;&#47;www.jianshu.com&#47;p&#47;48faf520c42b]
今日所学:
1,TPS = (block_size * network_bandwidth * witness_performance) &#47; (block_time * witness_count)
2,CAP 定理中，C为最终一致性，决定了出块时间的长短。A 是可用性，这个是必选的，必须要保证区块链 7 X 24 X 365 全部可用。
3,Sharding 分片
4,分片技术有以下优势：首先是 TPS 可以从十几笔提升至少两个数量级，也就是千笔每秒，这不但对应用友好，也提升了用户体验；其次 TPS 的提升可以带来更多应用，这些应用在共识的激励下可以水平扩展区块链的性能，形成一种良性循环。
5,网络分片是我们按照网络进行分区，区域内的交易归集在一起并在区域内进行验证，这样区域内的用户可以享受低延迟高吞吐的 TPS，但是会带来跨区域分片的复杂性;
6,状态分片是在以太坊上提出的方案。</div>2020-01-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/50/d7/f82ed283.jpg" width="30px"><span>辣么大</span> 👍（0） 💬（0）<div>目前闪电网络应用如何了？请问sharding分片和闪电网络哪个胜出？</div>2019-12-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/2f/f4/2dede51a.jpg" width="30px"><span>小老鼠</span> 👍（0） 💬（0）<div>若我刚加入比特币，我下载整个比特币区块需要多久，若区块上产生一个新块，我同步这个块又要多久？(假设100M带宽网络)</div>2019-12-10</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK9RytLsauRVYGjupDIaibibAK5iaicEicONrMFc0O3icAGf5mD1buxoQ2ePPn9YurFhRbuf3AR1qJDy0GQ/132" width="30px"><span>星文友</span> 👍（0） 💬（0）<div>感觉p 分区容错是必选的啊 控制记账节点数量 是提升了p吗</div>2018-07-17</li><br/>
</ul>