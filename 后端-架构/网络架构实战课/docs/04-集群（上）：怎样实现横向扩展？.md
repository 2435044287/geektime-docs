你好，我是谢友鹏。

你是否经历过这样的情景？系统最初只用几台服务器就能轻松应对业务需求，运行稳定、毫无压力。但某天，随着业务量飙升，服务器频繁告警，用户投诉增多，甚至网站直接宕机。

面对这种情况，我们有两种解决方案：一种是纵向扩展（Scale Up），即通过增加服务器的性能来提升处理能力；另一种则是横向扩展（Scale Out），也就是通过增加服务器的数量来分担负载。

![](https://static001.geekbang.org/resource/image/32/24/326d44a408d89f8fa670ed1f3ba4fd24.jpg?wh=5157x2936)

接下来的两节课，我们将通过深入探讨横向扩展的策略，分析网络路径上各个转发设备的横向扩展方法。通过这些方案，我们将一步步构建出弹性和抗压性更好的集群系统，让你的架构能够应对更高的流量和更复杂的业务场景。

## 横向扩展架构要思考的几个问题

所谓横向扩展就是将多个具有相同功能的机器组建成一个集群，整体对外提供服务，如果集群性能不够了，可以通过增加机器解决。关于横向扩展，我们有两个问题需要想清楚。

- 怎样将请求按照预期算法调度到各个机器上？
- 怎样避免将请求调度到故障的机器上？

## 整体网络架构的横向扩展

为了解决以上疑问，我们需要先了解整体网络架构的横向扩展过程，理清网络请求各个环节的横向扩展点。

如图所示，从客户端发出的请求经过LB到达服务器的过程中，至少有三个关键节点可以进行横向扩展。**首先，客户端可以在多个LB集群之间进行轮询。其次，可以组建LB集群来提升分发能力。最后，可以扩展服务器集群以应对更大流量。**
<div><strong>精选留言（2）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/25/66/4835d92e.jpg" width="30px"><span>潘政宇</span> 👍（1） 💬（2）<div>&quot;一致性哈希（CONNASH）： 适合按请求资源分配机器的场景，如通过这种方式提升 cdn 命中率。&quot;一致性哈希，跟cdn有什么关系啊</div>2025-02-17</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/ibD5qS2OcJj7aWf4SVJFUVLicicDkSkmzTHRhTSd2cXKzYO1LRDwcoEOo7EjV8KFaSzmgqA1ZcXLWBUibHsKTovWHA/132" width="30px"><span>Geek_706285</span> 👍（0） 💬（2）<div>1.在lb的nginx配置文件中将up_stream中配置中添加新server的ip端口，重启nginx服务 2.我自己把nginx配置文件中的http注释后重启服务发现不行，是因为http是应用层而tcp是传输层的缘故吗</div>2025-02-17</li><br/>
</ul>