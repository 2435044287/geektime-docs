你好，我是王新栋。

在前面几讲学习授权码许可类型的原理与工作流程时，不知道你是不是一直有这样一个疑问：授权码许可的流程最完备、最安全没错儿，但它适合所有的授权场景吗？在有些场景下使用授权码许可授权，是不是过于复杂了，是不是根本就没必要这样？

比如，小兔打单软件是京东官方开发的一款软件，那么小明在使用小兔的时候，还需要小兔再走一遍授权码许可类型的流程吗？估计你也猜到答案了，肯定是不需要了。

你还记得授权码许可流程的特点么？它通过授权码这种临时的中间值，让小明这样的用户参与进来，从而让小兔软件和京东之间建立联系，进而让小兔代表小明去访问他在京东店铺的订单数据。

现在小兔被“招安”了，是京东自家的了，是被京东充分信任的，没有“第三方软件”的概念了。同时，小明也是京东店铺的商家，也就是说软件和用户都是京东的资产。这时，显然没有必要再使用授权码许可类型进行授权了。但是呢，小兔依然要通过互联网访问订单数据的Web API，来提供为小明打单的功能。

于是，为了保护这些场景下的Web API，又为了让 OAuth 2.0 更好地适应现实世界的更多场景，来解决比如上述小兔软件这样的案例，OAuth 2.0体系中还提供了资源拥有者凭据许可类型。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="" width="30px"><span>Geek_4b64df</span> 👍（15） 💬（3）<div>可以，微信小程序就用的授权码，通过ajax获取code</div>2020-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/4d/54/9c214885.jpg" width="30px"><span>kylexy_0817</span> 👍（9） 💬（2）<div>感觉用户名密码获取到的access_token，和sessionid很像，只是session id只要用户有操作，就会自动续约，但access_token，会定期更新？</div>2020-07-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/5f/81/1c614f4a.jpg" width="30px"><span>stg609</span> 👍（5） 💬（1）<div>写的很不错！ 有几个疑问:
1. 使用隐式许可类型的时候，在请求授权服务器的时候，redirect uri 并不是必须的，而且也没有app secret, 那授权服务器是如何验证client的合法性的？ 随便给一个 app id 如何？ 
2. 除了隐式许可不需要app secret，其他几种是否都是强制的 
3. 授权码及隐式许可类型在注册 client 的 时候，redirect uri 是否都是必须的？但是在第一次访问授权服务器的时候redirect uri 都不是必须提供？
4. 对于SPA, 隐式许可现在已经不再推荐了，更推荐 使用PKCE 的授权码模式，课程是否有介绍？</div>2020-08-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/5c/11/7198f98e.jpg" width="30px"><span>龙堂修罗</span> 👍（5） 💬（2）<div>隐式授权使用appid请求acesstoken是不是有点多余，因为appid肯定会被抓到的。这种方式是不是就没用了</div>2020-08-06</li><br/><li><img src="" width="30px"><span>suhuijie</span> 👍（4） 💬（2）<div>资源拥有者凭据许可，直接用用户名密码是前端登陆还是后端登陆？例子中还需要携带appID和秘钥，那就是需要后端登陆。那这样的情况就是，官方出品所的产品都要自己提供登录接口，然后后端服务绕一圈去登录？能否直接在前端直接用用户名和密码登录？</div>2020-07-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/50/1f/5563ddc2.jpg" width="30px"><span>蒋胜琳</span> 👍（4） 💬（1）<div>搜索了好多博客，都没有把各种许可讲明白的，在这里可算明白了</div>2020-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/96/0f/d9d878f8.jpg" width="30px"><span>leros</span> 👍（4） 💬（1）<div>理论上讲，没有浏览器的情况下，也可以实现授权码许可流程。这种流程需要一个user agent让用户和第三方软件互动，并接受来自授权服务器的重定向，而浏览器只是最常见的user agent，不过不太清楚具体实践中这一块怎么处理的。</div>2020-07-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/94/56/4b8395f6.jpg" width="30px"><span>CC</span> 👍（3） 💬（1）<div>有一个疑问想请教老师：用户登录是否应该采用 OAuth 的形式？

假如一个 React Web App 应用，自己有后端，用户注册、登录以及获取受保护资源都是采用 OAuth 的方式。比如，用户登录成功后，后端直接给前端返回 access token，前端把 access token 保存在内存中（比如 Redux Store）里面。

这种案例还属于「授权」吗？如果是，又是属于什么类型呢？

看到老师在评论里面回复，“登录和授权是两个通路的事情，任何授权都是在用户登录之后进行的。” 根据这点，我认为例子中的登录即使采用 OAuth，也可能不属于 OAuth 的讨论范围，但不是很确定。</div>2020-08-11</li><br/><li><img src="" width="30px"><span>Geek_9d0e04</span> 👍（2） 💬（2）<div>使用 资源拥有在凭据许可和隐式许可 方式时，没有了最终用户选择授权的过程，都是直接获取access_token，那授权服务做权限校验时，如何控制呢？？</div>2020-08-08</li><br/><li><img src="" width="30px"><span>Geek_7b4330</span> 👍（1） 💬（2）<div>老师，如果小兔是京东的官方APP，然后小兔本身除了账号密码登录，还集成了微信登录，登录流程又会是怎样呢？</div>2020-08-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/f2/62/f873cd8f.jpg" width="30px"><span>tongmin_tsai</span> 👍（1） 💬（1）<div>老师，如果类似于传统使用session那样，如果我每次使用access_token请求后，希望重置过期时间，怎么做才是最佳实践？</div>2020-07-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/8a/a3/aee7ded7.jpg" width="30px"><span>在路上</span> 👍（1） 💬（7）<div>王老师，公司内部的统一登录，一般选用OAuth那种验证类型呢?</div>2020-07-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/61/78/e7aa4e04.jpg" width="30px"><span>al-byte</span> 👍（1） 💬（2）<div>在这里系统的学习了一下oauth2.0，讲的很清楚，收获很多</div>2020-07-15</li><br/><li><img src="" width="30px"><span>Geek_9ae2b9</span> 👍（1） 💬（1）<div>对比了授权码许可类型，本文介绍的三种授权流程中，都不需要经过用户小明的“授权”操作吗？</div>2020-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/2a/a5/625c0a2e.jpg" width="30px"><span>hhhh</span> 👍（1） 💬（2）<div>对于授权服务而言，支持隐式类型还要对注册的域名增加跨域支持吧？</div>2020-07-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/50/e5/4048aa15.jpg" width="30px"><span>Zhou</span> 👍（1） 💬（2）<div>client_credential不需要refresh_token，是不是意味着每次调用api之前都要调用auth server拿token?password模式还是需要refresh_token的吧？</div>2020-07-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/30/5e/c42bc33f.jpg" width="30px"><span>Younger Ku</span> 👍（0） 💬（2）<div>突然有个疑问❓app secret是干啥的？隐式授权不需要那么其他三种授权怎么用呢？</div>2020-08-17</li><br/><li><img src="" width="30px"><span>Geek_4b64df</span> 👍（0） 💬（1）<div>您是 隐式许可 讲的最透彻的一位老师</div>2020-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/4d/16/848d2722.jpg" width="30px"><span>DB聪</span> 👍（0） 💬（2）<div>请问”如果小兔软件是官方出品，那么可以直接使用客户端凭据许可；”是否应该是”如果小兔软件是官方出品，那么可以直接使用资源拥有者凭据许可；”？</div>2020-07-12</li><br/><li><img src="" width="30px"><span>Geek_9d0e04</span> 👍（0） 💬（1）<div>总结部分：如果小兔软件是官方出品，那么可以直接使用客户端凭据许可；这个写错了吧，应该是使用资源拥有者凭证许可。还有一个问题，隐式许可时，没有refresh_token，那accesss_token过期了，每次过期都需要资源拥有者参与，再走一遍认证过程嘛？？这不是没法在生产中使用吗</div>2020-07-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/da/79/9b093890.jpg" width="30px"><span>大秦皇朝</span> 👍（0） 💬（1）<div>老师好，文中说的“因为使用授权码的目的之一，就是把浏览器和第三方软件的信息做一个隔离，确保浏览器看不到第三方软件最重要的访问令牌 access_token 的值。”，这个没有理解，因为没有后台服务呀，直接请求完的access_token不直接返回给浏览器了么？为什么浏览器看不到access_token？</div>2020-07-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e6/00/39c7a054.jpg" width="30px"><span>岁月不饶人</span> 👍（0） 💬（1）<div>如果内网两个服务器需要鉴权通信，就可以使用隐式授权？</div>2020-07-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg" width="30px"><span>码小呆</span> 👍（0） 💬（0）<div>看了一下公司的用户中心项目,终于明白了,以前对一些字段,理念都不是很清楚,终于有点清晰了</div>2022-10-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/78/99/6060eb2d.jpg" width="30px"><span>平凡之路</span> 👍（0） 💬（0）<div>老师，您好，oauth怎么实现sso呢</div>2022-06-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/4b/da/c93eaab5.jpg" width="30px"><span>18610296143</span> 👍（0） 💬（0）<div>老师好，有两个问题想请教一下，我们现在的公司想做一个开放平台，主要包含两方面业务：
1、将用户的报表数据通过接口的方式暴露出去；
2、输出自己的计算能力，用户输入一些数据经过我们计算之后将结果返回给用户；
第一种业务场景很容易联想到授权码许可模式；
第二种业务场景我不能确定是使用哪一种授权模式；

我的问题：
1、第二种场景使用哪种方式比较好？（感觉应该是资源拥有者凭据许可）
2、如果使用的是资源拥有者凭据许可，那么password应该传什么？
3、这种场景下如果要使用授权码模式，应该怎么使用？

麻烦解答一下困惑，谢谢！
</div>2022-03-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/20/52/be/dcf03363.jpg" width="30px"><span>聪亮</span> 👍（0） 💬（0）<div>每种许可类型，是不是在授权平台能使用的scope也不一样，另外access_token也需要记录对应的许可类型。否则会存在通过 不安全 的 隐式许可授权拿到的 access_token，去访问其他安全性要求高的资源接口。</div>2022-02-23</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJrqLEic7DVicYY1s9ldH0vGBialDoplVGpicZUJ0Fdaklw27Frv8Ac67eicb5LibhL74SUxAzlick2nfltA/132" width="30px"><span>jiangb</span> 👍（0） 💬（0）<div>老师说的很明白。</div>2022-02-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/51/b0/d32c895d.jpg" width="30px"><span>熊能</span> 👍（0） 💬（0）<div>请教下老师，为啥只有授权码模式有scope，其他三种都没有？所有的授权应该都会有一个授权范围的呀</div>2021-10-31</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLIuRQaZX70dsBg6khub2VPM1eQAP9IWRWxgOFed3ia4kXyNJInFRicWJ0ibf2YmLsOvJa1sGygGpmJg/132" width="30px"><span>胖子</span> 👍（0） 💬（0）<div>隐式许可授权流程提及第三方软件小兔实际上是嵌入浏览器中执行的应用程序，不是十分理解。代码示例是Servlet，在浏览器中能运行吗？还会出现两次重定向吗？</div>2021-01-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/87/2e/ea54c240.jpg" width="30px"><span>风行者</span> 👍（0） 💬（0）<div>老师一再强调登录认证和授权是两回事。让我对很多糅杂在一起的场景突然清晰了起来。
授权码模式是否能应用在无浏览器场景，目前还未在PC里应用过，希望有类似的应用案例</div>2021-01-05</li><br/>
</ul>