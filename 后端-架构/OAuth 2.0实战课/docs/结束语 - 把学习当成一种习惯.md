你好，我是王新栋。

当你来到这节课的时候，我们的课程已经接近尾声，相信你在课程的学习中都有所收获。在最后的这节课，我想跟你谈一谈如何学习OAuth 2.0 这门技术。

在谈起如何学习这个话题的时候，我很愿意跟你分享我的一些经历和经验。我个人认为，**学习从来都不是一件容易的事情，夸张一点讲有点“反人性”**。你想啊，谁不愿意，在工作忙碌了一天后，晚上回家多陪陪家人；又有谁不愿意，到了周末去找几个朋友打打篮球或者陪女朋友看看电影呢。但是，学习一定要养成一种习惯。我在《程序员思维修炼》这本书中读到这么一段话，分享给你：

> 知识投资也是一样。你需要定期投资最低限度的时间量。养成一种习惯，如果需要的话。躲到你的家庭办公室里去或者走进有无线网络的咖啡厅。并非每期学习都同样富有成效，但是只要定期安排学习，长期来看一定会成功。如果你一直在等待空闲时间或者等待灵感的突现，那么它永远都不会发生。

在具备了上面所述的“定力”以后，我再和你谈一谈具体的学习方法。

我按照层次由低到高把学习分为**基础学习、分析学习和主题学习**：

- 基础学习，就是从知识点最基本的理论开始学习；
- 分析学习，就是对知识的结构脉络做梳理，并带着问题去学习；
- 主题学习，就是对同一个知识点，分别找到不同的资料来学习。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="" width="30px"><span>Geek_883762</span> 👍（7） 💬（1）<div>当老师说再见的时候，我哭了。</div>2020-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/97/1a/389eab84.jpg" width="30px"><span>而立斋</span> 👍（7） 💬（2）<div>马上买了一本《程序员思维修炼》，哈哈</div>2020-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/8a/a3/aee7ded7.jpg" width="30px"><span>在路上</span> 👍（4） 💬（2）<div>感谢老师的精彩讲解，现在每次授权登录时，都想到老师讲些的后台流程。</div>2020-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/6e/27/430ea477.jpg" width="30px"><span>zeroki</span> 👍（2） 💬（1）<div>“鉴权”是建议在开放平台的网关做呢，还是授权服务做呢？</div>2020-08-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/03/e2/5768d26e.jpg" width="30px"><span>inrtyx</span> 👍（2） 💬（1）<div>难说再见，谢谢老师</div>2020-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/fa/dd/f640711f.jpg" width="30px"><span>哈德韦</span> 👍（0） 💬（1）<div>老师好，微信PC扫码登录就是一个标准的OAuth 2.0流程，用户扫码后，手机微信弹出确认框。用户确认后，微信重定向到开发者回调网址，带上code，之后开发者网站使用code换取accessToken等。但是也有网站（比如石墨文档），PC扫码登录实际上利用了微信的带参二维码，用户扫码后直接跳转到了其公众号，而微信服务器直接将用户信息发送给石墨服务器，石墨利用这些信息直接将用户登录。请问这种利用带参二维码形式的PC扫码登录，其安全性会比标准的OAuth 2.0差吗？由于微信服务器发送用户信息给开服务器时是加密的，是否可以保证其安全性呢？</div>2020-08-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/88/23/a0966b4d.jpg" width="30px"><span>Tim Zhang</span> 👍（0） 💬（1）<div>老师 不是很理解你回答的刷新逻辑在授权服务。
前提 我的oauth服务是我自己写的，并非第三方服务。
我一个请求首先访问了网关，网关进行了鉴权，然后请求打到了后面api，但是actoken过期了，需要拿着refreshtoken去刷新actoken，难道不是受保护资源自己去调用我的oauth服务拿actoken么？这个逻辑如果每个受保护资源自己做，那是不是每个受保护资源都需要引入这个sdk呢？</div>2020-08-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/7f/24/719ce9d4.jpg" width="30px"><span>AgCl</span> 👍（0） 💬（1）<div>老师，看到留言，我有点疑惑，我们这边正想用oauth2的实现，如果网关做了验证和粗粒度的授权
但是资源服务器可能有更细粒度的权限管理，如果用的是spring security 的框架，资源服务器获取到用户id, 然后我们自己初始化好securitycontextHolder的内容；这样的话是不是我们直接网关就做转发，资源服务器自己去做token的验证以及权限验证，谢谢老师</div>2020-08-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/88/23/a0966b4d.jpg" width="30px"><span>Tim Zhang</span> 👍（0） 💬（1）<div>请问下假设2个服务 a和b，首先调用a的&#47;a，然后a会调用b的&#47;b，在网关层只能针对&#47;a进行权限校验，&#47;a执行完毕后调用&#47;b，这个时候已经不会访问到网关了，请问权限校验是否只能在&#47;b的应用上通过横切逻辑类似filter进行校验过滤</div>2020-08-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/88/23/a0966b4d.jpg" width="30px"><span>Tim Zhang</span> 👍（0） 💬（1）<div>老师，还有疑问，求解答
1、scope与api的映射表，缓存在网关，网关进行鉴权。那么如果粒度很细，一个api(url路径+ http方法)就需要对应一个scope，那么可能有成千上万个api，都需要在表里面定义么
2、网关已经校验过了scope，并且通过，请求调用到了受保护资源的某个api，还需要针对于这个api进行比如 @Precheck(hasRole(&#39;admin&#39;)) 或者 @Precheck(hasAuthority(&#39;xxx&#39;)) 的鉴权么，因为据我了解网关可能针对于粗粒度的api 比如&#47;A&#47;**  实际上访问的&#47;A&#47;aa还有更细粒度的比如rbac中的权限鉴定，所以其实不仅网关一层对于scope进行鉴权，访问到某个特定api还需要通过rbac进行鉴权，是这样么
3、如果刷新token，重定向等针对于oauth2的逻辑实现在网关，后续api假设有2个 a和b， 网关首先调用了a，a计算完成还需要调用b，这个时候假设accessToken过期了，但是刷新token逻辑在网关，a调用b不经过网关了，那么这些刷新逻辑是否还需要在b的filter切面层进行拦截处理</div>2020-08-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/88/23/a0966b4d.jpg" width="30px"><span>Tim Zhang</span> 👍（0） 💬（1）<div>请教一下 refreshtoke的刷新以及一些重定向可以全部交给spring security，但是这部分逻辑应该实现在网关 还是每个受保护资源都需要实现一下</div>2020-08-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/bc/25/1c92a90c.jpg" width="30px"><span>tt</span> 👍（0） 💬（1）<div>感谢老师，收获满满，对OAuth2.0的理解更扎实了</div>2020-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/a2/fb/94af9cf1.jpg" width="30px"><span>Alex</span> 👍（0） 💬（1）<div>感谢老师，跟着重新梳理了一遍OAuth2.0的知识体系。学习要坚持，复利的效果十分惊人。</div>2020-08-04</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/GjFJHox9V8qh53zIrExw4NK0KG9WBvRH8RJVjm9jp78RSpWfa2xzyq11dTNItpK2icQniaK4bibTv6ksRGiasjTvMg/132" width="30px"><span>Adong0678</span> 👍（0） 💬（1）<div>当把具象的事物能用自己简短语言总结概括出来，说明真正理解，掌握了。具体的事物会被更迭，但思想永远闪闪发光！传授知识者，都应尊称老师，十分感谢王老师！</div>2020-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg" width="30px"><span>亚林</span> 👍（4） 💬（0）<div>知止而后有定，定而后能静，静而后能安，安而后能虑，虑而后能得。物有本末，事有终始，知所先后，则近道矣。（By《大学》）</div>2021-06-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/69/c3/9bf5016f.jpg" width="30px"><span>动物不困</span> 👍（1） 💬（0）<div>日拱一卒，功不唐捐。加油！</div>2021-10-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/f3/44/3390c377.jpg" width="30px"><span>巭</span> 👍（0） 💬（0）<div>讲的不怎么样 东拼西凑的东西 还好意思要那么高的价格</div>2023-04-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/ce/7f/26c4d186.jpg" width="30px"><span>武将。。。</span> 👍（0） 💬（0）<div>感谢王老师的带领学习，以前知识了解，并没有这么系统深入地学习，这次听了王老师的课程，对其有了更加深入地了解，感谢！</div>2022-10-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg" width="30px"><span>码小呆</span> 👍（0） 💬（0）<div>没有女朋友,😭😭😭😭😭</div>2022-10-16</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epb9WYgYQJCMF3XrBbYxnzoXchW2DHfrXHeI2iasiasFdHzJ1XEMjKIN1WdqCgqIQqWU2ibQmYbCic6Gg/132" width="30px"><span>陶乐乐</span> 👍（0） 💬（0）<div>很认同老师的观点，一个就是学习的三个阶段：由基础的理论学习--》针对问题的思考学习---》全面系统的认知的过程。另外一个重点便是：一定得想办法输出，很多学习如果仅仅是看，因为没有自己的思考加工，很容易就会忘记。总结并形成图形，文字是很重要的过程学习</div>2022-04-15</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJrqLEic7DVicYY1s9ldH0vGBialDoplVGpicZUJ0Fdaklw27Frv8Ac67eicb5LibhL74SUxAzlick2nfltA/132" width="30px"><span>jiangb</span> 👍（0） 💬（0）<div>感谢老师，对OAuth2.0的知识体系有了深入的了解，下一步要实践SpringSecurity OAuth2，应用在公司产品上。</div>2022-02-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/00/12/7048984b.jpg" width="30px"><span>Krystal</span> 👍（0） 💬（0）<div>老师，关于输出倒逼输入这个学习方法，我非常认同，学习后做技术分享，但是作为一个管理者，可能在团队中执行的时候，不会宣导这个目的，最终在团队中执行的时候搞得队员不认可，没几周就停止了，后面他们都说学习是自己的事情，这个分享让他们不舒服，他们不乐意做，不知道老师有没有遇到过这种情况，或者能否给下指导意见？谢谢</div>2021-11-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/ec/0c/f20586b1.jpg" width="30px"><span>良胜</span> 👍（0） 💬（0）<div>老师，我现在要做一个需求，app侧打开H5页面，这个要用授权码登录，但是spring oauth2获取授权需要处于登录态,这个怎么处理；另外默认的授权码是报存在数据库里的，怎么扩展成jwt存储的格式</div>2021-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d7/cd/6ebfc468.jpg" width="30px"><span>王刚</span> 👍（0） 💬（0）<div>才看完，感谢分享！</div>2020-11-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/87/62/f99b5b05.jpg" width="30px"><span>曙光</span> 👍（0） 💬（0）<div>谢谢老师的分享，我也是输出倒逼输入，想在工作中使用Oauth2.0，提升安全性，在两周内学完理论。下一步是跑通案例代码，在应用到工作中。谢谢老师</div>2020-09-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/05/fc/bceb3f2b.jpg" width="30px"><span>开心哥</span> 👍（0） 💬（0）<div>酣畅淋漓，学的痛快！感谢老师，快上新课😃😃</div>2020-08-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/30/5e/c42bc33f.jpg" width="30px"><span>Younger Ku</span> 👍（0） 💬（0）<div>江湖路远，有缘再见（抱拳）</div>2020-08-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/30/5e/c42bc33f.jpg" width="30px"><span>Younger Ku</span> 👍（0） 💬（0）<div>感觉scope和api的对应关系跟角色和资源url的对应关系很像，但是角色通常分配给用户，scope通常分配给第三方应用。是这样的吗？</div>2020-08-20</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJM8KGX6C2mga90B9DVJQyxguR6qp8vnqbkESNhia9y1klp6aGPBFBEk9A0EdU5Gt6luLef9tozVyA/132" width="30px"><span>喜欢搬砖的小菜鸟</span> 👍（0） 💬（0）<div>感谢~ 每天地铁通勤看了两周，收获挺多。再去刷一遍~</div>2020-08-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/88/23/a0966b4d.jpg" width="30px"><span>Tim Zhang</span> 👍（0） 💬（0）<div>请问下既然网关层scope与api进行鉴权了，那么访问都后端api的时候，是否还要通过rbac进行hasRole hasAuthority进行每个api验证</div>2020-08-06</li><br/>
</ul>