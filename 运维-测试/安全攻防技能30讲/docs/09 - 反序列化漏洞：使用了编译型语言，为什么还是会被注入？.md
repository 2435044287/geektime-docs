你好，我是何为舟。

我们都知道，Java是一种高层级的语言。在Java中，你不需要直接操控内存，大部分的服务和组件都已经有了成熟的封装。除此之外，Java是一种先编译再执行的语言，无法像JavaScript那样随时插入一段代码。因此，很多人会认为，Java是一个安全的语言。如果使用Java开发服务，我们只需要考虑逻辑层的安全问题即可。但是，Java真的这么安全吗？

2015年，Java曾被曝出一个严重的漏洞，很多经典的商业框架都因此受到影响，其中最知名的是[WebLogic](https://baike.baidu.com/item/weblogic/451978?fr=aladdin)。据统计，在网络中公开的WebLogic服务有3万多个。其中，中国就有1万多个外网可访问的WebLogic服务。因此，WebLogic的反序列化漏洞意味着，国内有1万多台服务器可能会被黑客攻陷，其影响的用户数量更是不可估量的。

你可能要说了，我实际工作中并没有遇到过反序列化漏洞啊。但是，你一定使用过一些序列化和反序列化的工具，比如Fastjson和Jackson等。如果你关注这些工具的版本更新，就会发现，这些版本更新中包含很多修复反序列化漏洞的改动。而了解反序列化漏洞，可以让你理解，Java作为一种先打包后执行的语言，是如何被插入额外逻辑的；也能够让你对Java这门语言的安全性，有一个更全面的认知。
<div><strong>精选留言（18）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/11/47/31/f35367c8.jpg" width="30px"><span>小晏子</span> 👍（8） 💬（1）<div>用过fastjson，Fastjson 1.2.24就有反序列化漏洞，这个漏洞能让黑客在服务器上执行任何命令，如果服务器开了open api，且接受参数中有json数据，json解析引用了fastjson 1.2.24，那就有很大的安全风险，拒绝服务攻击，被删除服务器文件，服务器系统被破坏，都是完全可能的。</div>2019-12-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ae/97/ba512167.jpg" width="30px"><span>darren</span> 👍（3） 💬（1）<div>公司安服，说禁止使用jackson、fastjson，我能用什么呢，protobuf这类会安全些吗?</div>2020-09-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/88/21/50b2418a.jpg" width="30px"><span>alan</span> 👍（3） 💬（1）<div>一般说运行web服务时，不要使用root权限，这跟反序列化漏洞的风险也有关系吧？</div>2019-12-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/16/bd/e14ba493.jpg" width="30px"><span>翠羽香凝</span> 👍（2） 💬（2）<div>老师给的示例代码，难道只有我一个人没有重现出来吗？重现的时候代码运行，报java.lang.Override missing element entrySet错误</div>2020-04-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/85/b2/18f3a4ea.jpg" width="30px"><span>Zane</span> 👍（2） 💬（1）<div>JSON反序列化可能有风险，所以大多数App的网络请求数据使用表单么？</div>2020-03-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/47/fd/895f0c27.jpg" width="30px"><span>Cy23</span> 👍（1） 💬（2）<div>漏洞是不是反系列化的同时执行了某个代码，
问个本课外问题，最近有台JAVA服务器，密码被破解，通过后台上传功能，上传*马图片和各种后缀页面，通过webshell获取服务器账号，访问sql2000数据库等，暂时还没想好怎么破，隐藏上传图片功能</div>2019-12-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/0a/4e/21c545f6.jpg" width="30px"><span>goarulin</span> 👍（0） 💬（1）<div>请问老师，我这执行了这段代码一直报Exception in thread &quot;main&quot; java.lang.annotation.IncompleteAnnotationException: java.lang.Override missing element entrySet</div>2020-09-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/96/d2/ed0f408b.jpg" width="30px"><span>Teresa</span> 👍（0） 💬（1）<div>Jackson Databind漏洞、apache log4j反序列化漏洞，我只知道通过及时升级jar包版本修复漏洞。</div>2020-03-23</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIicr82CnrdEjibibAvyeKRQHszSzIAqoCWxN0kqC442XcjEae6S9j6NDtKLpg4Da4CUQQeUFUicWqiaDw/132" width="30px"><span>有学识的兔子</span> 👍（0） 💬（1）<div>老师您好。像常用的渗透工具 metaexploit 里面提供的meterpreter&#47;reverse_tcp是不是也是利用系统的反序列化的工作流程，执行一段黑客插入的恶意指令程序.</div>2019-12-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d7/f6/e2e9f8cd.jpg" width="30px"><span>geek.flare</span> 👍（0） 💬（1）<div>我是做.net 开发，在编写服务之间的通讯时经常会用到序列化和反序列化，以前真没想到会有这种漏洞。请问.net有类似的RASP工具吗?</div>2019-12-28</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoaJI2EYKYEmIwtEECSg8RqlHe3OVJ7yOfH6NdPZ7vGIFTneHvJ2EdTPticoIvvIcV649geuPjUqWQ/132" width="30px"><span>cambrian</span> 👍（1） 💬（0）<div>Apache shiro反序列化漏洞</div>2020-09-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/39/d0/82/791d0f5e.jpg" width="30px"><span>大将</span> 👍（0） 💬（0）<div>反序列化漏洞涉及的机制相对其他漏洞更为复杂，同时大部分时候解决反序列化漏洞又都是通过更新第三方版本实现，从而容易忽视原理部分的学习。本文是针对这一现象的一个很好的补充。</div>2023-11-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/e8/f7/1b45fa46.jpg" width="30px"><span>wcf</span> 👍（0） 💬（0）<div>在 ubuntu20 桌面上, 命令换成 gnome-calculator &amp; 没有复现出来. jdk1.8_201, commons-collections:3.2</div>2022-04-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/d0/78/a11a999d.jpg" width="30px"><span>COOK</span> 👍（0） 💬（0）<div>加强反序列化的认证和检测，报文签名</div>2020-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/d0/78/a11a999d.jpg" width="30px"><span>COOK</span> 👍（0） 💬（0）<div>老师讲原理很透彻，多读几遍很有收获</div>2020-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/41/59/78042964.jpg" width="30px"><span>Cryhard</span> 👍（0） 💬（0）<div>嵌套100层HashSet的反序列化攻击的例子——对CPU的消耗可能与哈希碰撞后退化为链表，进而加大遍历的复杂度有关。不知道Java新版本是否会有相应的基础性对策……</div>2020-01-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（0） 💬（0）<div>RASP方式听说过不少，只知道要去用，不知道为何，毕竟主业是运维不是网络相关的；学习中不断补充强化自己。谢谢老师的分享。</div>2019-12-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/ec/68/06d59613.jpg" width="30px"><span>柒月</span> 👍（0） 💬（0）<div>没后台经验  前几节web的受益良多 这里就只能大概了解下概念了 </div>2019-12-27</li><br/>
</ul>