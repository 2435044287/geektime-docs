你好，我是何为舟。

在上一讲中，我们探讨了业务安全和黑产（也叫黑灰产），知道了业务安全的本质就是资源对抗，业务安全的防护手段就是提高黑产的资源成本，并且针对不同的资源类型，我们需要采取不同的方法来进行对抗。

在基础安全中，我们提出了“黄金法则”作为总体思路，来对各个防御手段进行梳理。那么，在业务安全中，我们有没有什么方法论可以作为参考呢？这一讲，我们就来聊一聊提高黑产资源成本的方法，以及如何从根本上防御黑产。

## 业务安全中的防御框架是什么？

在[安全标准和框架](https://time.geekbang.org/column/article/192220)中讲过，我们可以通过NIST的安全框架IPDRR，在基础安全中构建出一道比较全面的纵深防线。在业务安全中，IPDRR同样可以指导我们与黑产进行对抗。这里我总结了一张对比表格，你可以先了解一下IPDRR在基础安全和业务安全中的异同点。

![](https://static001.geekbang.org/resource/image/3a/2e/3a37f5f15d5e39505573ccc975a6422e.jpg?wh=1602%2A911)

接下来，再看我对业务安全中IPDRR内容的重点讲解。

- **Identify（识别）**：和基础安全一样，业务安全的识别阶段主要是进行威胁评估的工作。我们需要找到黑产可能获取到的业务逻辑中的投入成本，比如，应用发放的红包、优惠券等。
- **Protect（保护）**：在业务安全中，我们是通过产品方案来实施认证和授权过程的。比如，对于登录过程增加双因子认证和验证码等，就是加强认证的安全性。
- **Detect（检测）**：检测阶段主要是风控系统发挥作用。
- **Respond（响应）**：发现黑产的攻击后，我们可以通过封禁账号、拦截操作、拒绝提现等方式，来阻止黑产获取利益。
- **Recover（恢复）**：最后就是对整个系统进行恢复了。在业务安全中，黑产可能已经盗取了某些账号，或者已经领取了部分红包。这时，我们就需要通过合适的运营机制，将账号返回给原用户，把红包退回到奖金池中。
<div><strong>精选留言（6）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（6） 💬（2）<div>通过今天的课程：最佳实践方案应当是如下几条；
1.提高监控效果，利益越大、控制适当越大，适当的增加用户操作
2.提高操作复杂度，操作越复杂，黑产的复杂度越大，成本就越高
此外利益层尽量随机性越大且利益额度适当控制：获利空间越不确定且空间不可控；那么利润可能就越薄，导致付出与收益成鸡肋。记得中学曾有一古文有此解释“鸡肋：食之无味，弃之可惜”，黑产越不确定收益才越可能减少产品的被攻击概率和次数。
    以上是个人对于今天的课程的理解：期待老师后续的分享；谢谢。</div>2020-02-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/76/f5/e3f5bd8d.jpg" width="30px"><span>宝仔</span> 👍（2） 💬（1）<div>老师你好你这里的满10减10怎么就不需要黑产付出任何成本了呢？为了这个满10减10的红包，也是需要获取大量新用户身份的呀</div>2020-02-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg" width="30px"><span>追风筝的人</span> 👍（0） 💬（2）<div>老师   对于登录过程web端的双因素登录认证环境怎么在linux系统搭建(第一次PAP用户名密码认证，第2次动态口令OTP认证）？</div>2020-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/23/6c/785d9cd3.jpg" width="30px"><span>Snooker</span> 👍（2） 💬（0）<div>邀新：唯一设备id、判断虚拟手机号码。</div>2020-05-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/23/6c/785d9cd3.jpg" width="30px"><span>Snooker</span> 👍（0） 💬（0）<div>场景：某东的某台预约抢购活动
平台防御：
	1.提高账号预约资格成本，plus会员才享有预约资格
	2.听说平台会对账号做标识：黑号、白号，只有白号才可以抢到
	3.接口层限流处理，频率过高做限流处理（可能会有）
	4.用户账号身份、收件人信息风控等
	5.未开放购买期间，禁止将商品加入购物车
黑产应对：
	1.使用外挂抢购
	2.通过QQ&#47;微信群，从个人抢购到的手中收购
	3.代下单地址信息，使用个人手机号、约定规则作为地址（片区快递员看得懂）

能想到的绕过和防御。</div>2020-08-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/f9/e6/47742988.jpg" width="30px"><span>webmin</span> 👍（0） 💬（0）<div>安全攻防的极端手段都在“无间道”这部影片中。</div>2020-02-19</li><br/>
</ul>