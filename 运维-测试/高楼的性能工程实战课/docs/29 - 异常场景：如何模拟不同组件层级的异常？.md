你好，我是高楼。

上节课我们讲到，在具体的项目中，异常场景如果想做得细而全，是不可能的，成本高不说，收益看起来也并不大。

不过，我们在判断异常场景的范围和设计异常场景的时候，还是要注意把整个架构中的所有层级的组件都覆盖全，不能遗漏。这就要求异常场景的设计者必须对架构有足够的了解，这也是设计的难点。

在当前的技术市场中，应用异常、操作系统异常、容器异常和虚拟机异常是大家经常考虑的几个异常场景，而这些场景也基本上模拟了微服务分布式架构中非常常见的异常问题。

因此，这节课，我就带你从这几个异常场景出发，看看怎么解决设计上的一些难点。

## 应用异常

在应用的异常场景中，我会用限流、降级熔断这两个示例来给你讲解。在传统的异常场景中，并没有这两个异常场景。不过，在当前微服务发展迅猛的技术市场中，限流和降级熔断是必不可少的。

这里我选择用Sentinel工具（如果你对工具本身不熟悉的，请搜索下网上的资源），它是面向分布式服务架构的流量防护组件，主要以流量为切入点，从限流、熔断降级、系统负载保护、热点防护等多个维度来帮助开发者保障微服务的稳定性。

当然你也可以用其他的工具来实现，只要在设计上符合我们在上节课中讲的这张图就可以了：
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/KhQRc8hIxHHyPV3Og2Fc5l8w2y7ibGwGn6odmzl3wTt6fPrNv589uHmia1rgiaZhRiaLVHv9ibhzkxFx1zo42uNIS9A/132" width="30px"><span>道长</span> 👍（4） 💬（1）<div>1、系统能够快速恢复
2、是否能够恢复以及错误率是否能够接受</div>2021-05-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/09/dd/1cddcda1.jpg" width="30px"><span>李沅峰</span> 👍（2） 💬（1）<div>如果在生产环境中出现CPU 或内存问题的话，请注意，最重要的是系统能不能快速恢复。因此，如果你在执行异常场景时，看到 CPU 或内存消耗高、TPS 下降或者响应时间增加等问题，并且在模拟异常没有停止的时候，TPS 和响应时间也一直没有恢复，那你就可以报 Bug 了。因为我们期望的是业务能恢复。

这段话：在模拟异常没有停止的时候，TPS 和响应时间也一直没有恢复。没有停止自然不会恢复呀？  应该是停止了 没有恢复么？？</div>2023-04-30</li><br/><li><img src="" width="30px"><span>CoK</span> 👍（0） 💬（1）<div>怎么动态调整依赖服务的响应时间？</div>2021-10-17</li><br/>
</ul>