你好，我是高楼。

今天是我们这节课的第一讲，我要带给你一个全面的性能概念——RESAR性能工程，它跟性能测试的逻辑不太一样，具体哪儿不一样？下面我就具体给你讲讲。另外，在这个过程中，我也会让你全面、系统地感知到性能工程都要做些什么工作。相信这节课不仅会改变你对性能的认知，也能对你的性能项目全过程有一个指引。

## 要为性能负责，就不能局限在“测试”上

在[《性能测试实战30讲》](https://time.geekbang.org/column/intro/264)专栏中，我给出了性能测试的概念：

> 性能测试是针对系统的性能指标，建立性能测试模型，制定性能测试方案，制定监控策略，在场景条件之下执行性能场景，分析判断性能瓶颈并调优，最终得出性能结果来评估系统的性能指标是否满足既定值。

到现在，我仍然认为这是对“性能测试”最合理的描述。实际上，这一概念在出来之后引起了一些争论，主要在于：**性能测试的团队需要去做瓶颈定位和优化吗？**

我们先抛开概念本身，考虑这样一个问题：如果性能测试团队不做瓶颈定位和优化，那是否可以给出“上线后生产系统不会产生性能问题”这样的答案呢？

如果不能，那要这个性能测试团队有什么用？仅仅是找找初级的技术问题吗？这就像一个病人去医院看病，手术做了，药也吃了，一顿折腾后问医生：“我什么时候可以好呢？”要是医生说：“我也不知道！”你想想病人心里会是什么感受，有没有一种遇到庸医的感觉？
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIVR2wY9icec2CcZl0E9JnNhqbz4O5STS16oLxUK6gMW84zqpiaiaIW90c6uiadYraEhqMabL1hnZrvuw/132" width="30px"><span>xmherz</span> 👍（6） 💬（1）<div>性能模型不好构建，如果是升级类系统还好，还有历史数据可参考，如果是新上线的系统，无论是谁定的需求，基本都是拍脑袋得到的。

我也不敢保证我压过的系统上线会百分百不死，一般我会在心里给个预测，80%～99%不死，测试时间越充分，覆盖范围越全面的，越有信心，不敢保证百分百是因为测试的基本理论“测试无法发现所有的问题”。然后很多项目你懂的，根本没给那么多时间进行充分压测。对于带地雷上线的系统，一旦挂了，最有价值的事情就是线上快速定位出来然后挖掉它。

国内性能压测市场越来越不受重视，我觉得原因有几点：1.公司为了省钱，系统挂了再马上找问题，不在乎死几次；2.性能测试人员没有体现自己的价值，很多只会做做脚本，甚至连脚本都做不好，这类人拖累了性能测试的形象，长此以往，整个项目团队，从领导到架构开发运维，都觉得要性能测试何用？顺带吐槽下，这类性能测试人员，很多都是培训机构从非计算机专业生源中改造出来，又不思进取的，堪忧！

看你的文章会有很多共鸣点，不由多感慨几句！</div>2021-05-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/f4/0f/3718fb2a.jpg" width="30px"><span>2021加油</span> 👍（5） 💬（3）<div>听完直播间就购买了课程，可以知道老师的微信吗？想加入讨论群。</div>2021-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/b0/c4/b2fa127f.jpg" width="30px"><span>Coby</span> 👍（3） 💬（2）<div>所以， RESAR 是什么缩写呢？
请教老师，有些项目根本不可能拿生产数据，如银行保险等，如何定性能场景？
第二，老师能否花时间写个优秀性能工程师技能路线图，好对比查漏补缺。</div>2021-03-31</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/MHUoh5fxqRiacWziafAe43fKGcJXKa5gYWHuic9WkoIncApibXq3mmuicgRjhtvkSsaibicW4MDzAWu1abr85ibX6BhbDQ/132" width="30px"><span>Geek_435bc9</span> 👍（2） 💬（1）<div>性能工程和全链路压测、DevOps 等概念有什么区别？描述下你理解的 RESAR 性能工程？
1.性能工程是一个性能评估的体系（从需求分析==&gt;建模==&gt;实施==&gt;评测==&gt;优化==&gt;生产监控==&gt;环比&#47;建模）
2.全链路压测一般是使用生产环境的服务，数据单独落影子库，模拟生产流量实施压测；
3.DevOps是现在各家都在说的一种新的开发模型，主要是把开发==》运维整个流程流水线掉
4.我理解的RESAR性能工程：通过分析业务逻辑和技术架构，创建性能模型，制定性能方案，准备应用环境，设计并实施性能部署监控，实现符合真实业务逻辑的压力，通过监控手段获取各组件的性能计数器，分析计数器采集出的数据，查找出性能瓶颈的根本原因并优化，最后通过环比生产环境的性能数据修正场景。====摘自 《高楼的性能工程实战课》</div>2021-04-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/45/33/cdea4bca.jpg" width="30px"><span>zwm</span> 👍（2） 💬（1）<div>性能工程：第一次听说最大感受是形成闭环，反馈提升，为结果负责验证结果
全链路压测：一种压测模型，所有业务串起来，关注系统整体测试全方位的测试保证业务间影响点考虑全，测试全
DevOps：有种叫法是运维开发，在我们公司就是搞k8s，部署环境流程，资源管理，发布相关的</div>2021-03-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/c8/2a/b458f0d2.jpg" width="30px"><span>小军</span> 👍（1） 💬（1）<div>紧跟大佬教程</div>2021-03-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/6d/ac/6128225f.jpg" width="30px"><span>jjn0703</span> 👍（1） 💬（1）<div>我们团队小，日常就一套测试环境，一套生产环境。上次有项目验收有性能要求，其中有一项，TPS要稳定过100。我当时花了两天临时在最好的机器上起来一个数据库，再把各种服务搭好，最后loadrunner各种压，才放心交上去测试。团队之前都没人整过这块，我算是开了先例了，数据库索引啥的顺势都研究了一下，学到了不少的感觉。最后最后，这次一定跟老师认真学完这个专栏还有之前那个，免得“书到用时方恨少”。</div>2021-03-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/96/47/93838ff7.jpg" width="30px"><span>青鸟飞鱼</span> 👍（1） 💬（1）<div>看完只想说一句：真牛b，这课真值。</div>2021-03-27</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er3G5DWFp5PEklibQPYE1m8OxtYqTcryibkcUHpP4ibBicf8OUYHB6V1iaSRaNiaFV8cuNFb0xbOUF7mZhQ/132" width="30px"><span>Duke</span> 👍（1） 💬（1）<div>“那种带梭子的重机”—我猜一定是加特林，冒蓝火的那种！</div>2021-03-23</li><br/><li><img src="" width="30px"><span>Geek_bbe4c8</span> 👍（1） 💬（3）<div>有在负责的一个新系统上跑过全链路测试，因为是新系统，还没什么用户，所以也没怎么改造链路就直接在线上压测，压到一定的tps后就停手了，没有压到把机器资源用完，也没权限登录现网机器，只能看到运维统计的CPU使用率、内存网络等基本数据。一通操作下来，结论就是整个系统能达到xxx的请求量，然后没了。现在确实觉得性能测试测的很虚，急需老师的工程实战课整整思路</div>2021-03-23</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ9HJlSdlulgnMTxKHXlxEicpZPGwhPoS58nnmQPnZXW8osEzA5rBFXxAAM6pZgMOo62RMWH4gaDfg/132" width="30px"><span>继华</span> 👍（1） 💬（1）<div>高老师好，能不能说一下具体什么全链路压测呢？</div>2021-03-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg" width="30px"><span>亚林</span> 👍（0） 💬（1）<div>2024年了，这些以为自己有“言出法随”的砖家们和领袖们，也清洗出行业一部分了</div>2024-03-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/34/eb/137aba7e.jpg" width="30px"><span>梅子</span> 👍（0） 💬（1）<div>这个课程的环境是开放的吗买了可以实战吗？</div>2023-12-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2c/80/67/e9e21bca.jpg" width="30px"><span>树眷2022</span> 👍（0） 💬（1）<div>听完，高度瞬间被拔高了</div>2023-03-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1f/06/ac/55fba20b.jpg" width="30px"><span>qtracer</span> 👍（0） 💬（1）<div>1、性能工程和全链路压测、DevOps 等概念有什么区别？
性能工程以项目的角度完整设计和实施涵盖全流程的事项，以工程角度探索和调整系统的容量；
全链路压测是性能工程容量场景下的一个具体实例；
DevOps，运维开发，更侧重于系统的配置管理。

2、描述下你理解的 RESAR 性能工程？
RESAR性能工程，是基于性能目标，通过分析业务逻辑和技术架构，创建性能模型、制定性能方案、设计和部署性能监控，在既定场景发起符合业务逻辑和压力，获取相应的监控数据并分析，找到问题的根本原因并优化，通过环比生产环境的性能数据判断是否达到预期优化结果。</div>2022-09-26</li><br/><li><img src="" width="30px"><span>挺好的</span> 👍（0） 💬（1）<div>老师微信多少啊，想加个微信，方面以后请教</div>2022-09-20</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erQorjZZicjqZqB9kRg2ahibkI5Udw8pEJpnfmsFYkwibrcaSyYcmXk97fkbqRx7guZFrDl7F5EU5PHQ/132" width="30px"><span>A_lai1988</span> 👍（0） 💬（1）<div>作者的很多观点是非常有价值的，感谢分享。对于新建系统，经过性能压测的，首次上线基本性能问题很难暴露，往往需要随着业务量逐渐增大后才会出现，而这个时候离上线前的压测已经很久了可能版本都已经更新好多版本了，这种情况下是无法保证之前的性能压测可以针对当前的情况，如果这个时候拿生产数据环比也很难比对出来的。除非是建立常态化的压测机制，但是另一个问题就暴露出来了，常态化压测需要类生产环境，这个投入量非常大，很多公司是难以达到。另一个问题就是，性能场景往往还是覆盖主要交易的，有一点难以控制的问题是，往往一些交易量非常少且不重要的交易，容易被忽略，而生产问题恰恰是由这些导致的，这种也很难在测试过程中覆盖到的。</div>2021-11-24</li><br/><li><img src="" width="30px"><span>Geek2025</span> 👍（0） 💬（1）<div>性能工程和全链路压测、DevOps 等概念有什么区别
1.性能工程包含整个项目研发运营周期，类似于测试周期是从项目立项到项目结束包含功能测试，需求分析等，性能测试是性能工程的一个阶段过程，性能工程涵盖项目整个阶段前期避免风险提高质量，测试阶段验证性能质量，运营阶段评估线上压力。
2.全链路压测是每一条链路结合起来进行测试，通俗理解为一个城市一条道路为一条链路，如果仅仅测试一条的压力，只能知道该条路的情况，但实际上每条路都有汇入驶出，上一条路段出现问题便会导致其他路段出现堵塞，延迟等情况，全链路便是把所有道路整合进行压测
3.devpos我理解就是一个实现快速迭代项目的一种方法，一般通过自动化的形式进行，提高效率，减少重复性工作。

描述下你理解的 RESAR 性能工程
resar性能工程结合业务，架构进行分析进而通过模型建模建立一套完整的性能功能
</div>2021-10-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/39/6e/57ad279c.jpg" width="30px"><span>清風暖阳</span> 👍（0） 💬（1）<div>高老师的30讲课程没有一口气听完，本身入门性能也才一年多一些，随着工作的深入，结合高老师课程讲解，学习了很多东西，工程实战课开课之前，终于把性能30讲刷完，让我明白我所从事工作不仅仅是开发个脚本，跑个场景、分析个结果那么简单，更重要的是从系统层面去寻求系统的资源瓶颈、做出相应的调整优化。

最近做项目，调研阶段也开始从架构层面去了解分析系统，明确接口请求在各个节点之间是如何流转交互，进而心里有个大概的链路，对可能出现的问题有个预估。

期待新的课程带来的成长</div>2021-09-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/15/09/bc24c82b.jpg" width="30px"><span>王晓磊</span> 👍（0） 💬（1）<div>1.性能工程和全链路压测、DevOps 等概念有什么区别
1.性能工程:相比于性能测试，性能测试只是针对工程中部分阶段进行的。而性能工程是贯穿在项目的整个生命周期中的，从业务需求（创建业务模型）-立项（做容量评估、容量模型建立、容量水位模拟等模型建立。）-研发（无压力情景下的白盒测试）-测试（把前面的工作验证一下）-运维（性能检测数据和运维业务数据对比，并优化）。用“工程”的角度看待“性能，”能减少上线的风险。
2.全链路压测:一次完整的数据流不可能只在一个系统内流转，会在各个系统中流转，各个系统通过调用，形成链路，数据会在各系统中流转。对于整个链路进行的测试就是全链路测试。全链路压测是针对全链接的性能进行的测试。
内部的系统测试只能检验出本系统的问题，不能检测出链路上的问题，所以需要全链路压测。
 3.DevOps
开发运维一体化。开发过程中运维人员参与进来，运维阶段，开发人员给予一段时间的技术支持。--该部分理解只停留在概念上了

2.描述下你理解的 RESAR 性能工程？
RESAR 性能工程，是对性能项目过程中的各个具体的动作做更详细的描述，使之可以成为可以落地的具体实践。--摘抄自文章
我理解的这个性能工程是在整个项目周期中，尽量模拟真实环境（压测），进行的性能检测和及时发现瓶颈，并优化。对于上线后的真实业务场景和测试对比，看之前的测试是否满足真实业务场景</div>2021-08-16</li><br/><li><img src="" width="30px"><span>byyy</span> 👍（0） 💬（1）<div>DevOps和敏捷开发：都属于研发模型范畴的术语，它们更多体现了过程的管理。
全链路压测：只是性能工程中一个具体容量。并没有什么特殊之处。
性能工程的理解：性能工程要求从&quot;工程&quot;的高度来规划性能过程，它针对的是一个项目完整的生命周期，要对性能问题负责，所以工作范围很广，涉及到业务需求、架构技术、研发过程、运维，通过对这些环节的分析，制定指标、模拟符合生产环境下的业务模型和压力，对系统进行施压，观察计数器来分析瓶颈并优化的过程，既然是模拟，那么就需要根据运维数据不断进行调整业务模型和压力，使得测试更加符合系统的真实使用情况。</div>2021-07-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/42/49/58330e3c.jpg" width="30px"><span>耿强</span> 👍（0） 💬（2）<div>   高老师。想了解下流量复制是怎么进行性能测试的？生产是nginx代理，后端接口几十个，怎么能把生产的流量导入到测试环境中跑一把呢。</div>2021-06-25</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIpF5euTNx3GJRv2UprQHohnD9DStzjwgdFUA3x2w9o0OXldQZC1VWYuLPnVqM54XBib1G3c0AEpJA/132" width="30px"><span>源子陌</span> 👍（0） 💬（1）<div>这一章信息量好大啊，需要多次反复学习。
请教个高老师个问题，文中说“业务和架构分析、性能需求指标、性能模型和生产运维这几个环节看起来比较单薄。实际上，它们的工作内容并不少，并且有可能花费你很高的沟通和操作成本，消耗较长的项目时间。不过，这三个环节是可以与其他工作并行的。”——这3个环节指的是业务和架构分析、性能需求指标、性能模型和生产运维嘛？是把性能模型和生产运维算作1个环节，还是把业务和架构分析以及性能需求指标算作1个环节了呀？</div>2021-04-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/db/67/24d4bce6.jpg" width="30px"><span>Alisa</span> 👍（0） 💬（1）<div>我的理解是：
性能工程是相当于将性能测试当成一个项目及任务来分析执行，从需求（业务需求和技术架构）-方案（性能测试方案）-设计（根据业务模型设计性能测试模型；监控策略；环境准备：包含软硬件、网络、数据等）-实时-报告。这是一个工程级别的过程
全链路压测：适合于有着项目大项目需求，及经济能力的企业。最好在项目初期，架构设计时就将其在必要业务场景中落实到位的。
DevOps：我的理解是他偏向于一个组织过程管理，相互推动促进的一个研发模式。</div>2021-04-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/3b/01/7a0bfa9a.jpg" width="30px"><span>alley</span> 👍（0） 💬（3）<div>老师，我上次遇到一个top之后，sys,wait,si都很高，就不知道咋下手了。</div>2021-03-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/94/c5/abb7bfe3.jpg" width="30px"><span>哈哈哈，读我</span> 👍（0） 💬（1）<div>如何加入讨论群呀</div>2021-03-23</li><br/><li><img src="" width="30px"><span>wfw123</span> 👍（0） 💬（2）<div>老师 一般性能测试环境和生产环境机器数量不一样，软硬件配置一样，这样我们应该拿线上什么样的数据和性能测试数据对比呢</div>2021-03-23</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI4akcIyIOXB90Lib13IhEYZc5iaZ8CUedBWibV6l6GLib0BX3QGXxBBDibPqBMcAWeV0CRWsVEsoueSwg/132" width="30px"><span>yz</span> 👍（0） 💬（1）<div>现在就是停留发现问题的阶段😂，希望跟完这个课程能突破
前几天跟之前的同事吃饭，大家都劝我别继续性能了，目前市场需求太少，不好找工作😭</div>2021-03-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/f6/27/c27599ae.jpg" width="30px"><span>术子米德</span> 👍（0） 💬（2）<div>🤔☕️🤔☕️🤔
性能这个词，我喜欢把它叫做“余量标定”
首先要认识到哪些余量值得去标定，其次是找到能进行余量标定的技术手段，最后就如课程所言，需要有权限去标定余量
</div>2021-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/dd/0f/ee37a7fe.jpg" width="30px"><span>zuozewei</span> 👍（13） 💬（1）<div>个人觉得以下的条件适合搞全链路：
- 大老板同意
- 大厂、有钱、有人、有技术
- 只有一个业务主流程，比如下单、支付等
- 偏微服务架构
- 能协调和整合各部门资源
- 性能团队做到测试+分析调优</div>2021-03-24</li><br/>
</ul>