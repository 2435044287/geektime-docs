你好，我是白园。今天我们来聊聊可靠性领域的第三个部分——变更。

你有没有发现一个现象，无论是国内的公司还是海外的公司，在故障原因中，变更所占的比例最大。你有没有想过原因是什么？既然变更是可靠性第一杀手，那么有没有什么办法来彻底解决这个问题？

在接下来的内容中，我将带你深入探讨变更背后的原理，并分析为什么变更会成为系统稳定性的主要威胁。此外，我将分享一套有效的策略来应对变更带来的风险，帮助你提高系统的可靠性。通过这些方法，我们可以更好地控制变更过程，减少其带来的负面影响。

## 变更是什么？

正式开始之前，你可以先回答我一个问题，以下哪些操作属于变更？

![图片](https://static001.geekbang.org/resource/image/83/dd/83487d4283f194d9b8381aee0eff1cdd.png?wh=1938x1292)

答案是：上述列举的所有操作都属于变更。实际上，任何操作只要有可能影响到线上服务可靠性都会被视为一种变更。

## **为什么说变更是可靠性的第一杀手？**

变更的本质就是打破稳态，在日常工作中，任何形式的变更，在变更过程中都可能让一个系统从稳定状态转变为不稳定状态。而系统处于不稳定状态的时候，正是故障最容易发生的时刻。

![图片](https://static001.geekbang.org/resource/image/dd/7a/dd9a2fb1cc76975bf4dc9f1d6af5747a.png?wh=2046x744)

其次，变更的来源广泛，发生频率高，形式多样，涵盖软件更新、配置调整、硬件升级等类型，这些都显著增加了风险。在我负责的业务领域，变更日均超过百次，涵盖代码发布、配置调整、A/B测试等多种类型。历史上，这些类型变更都曾引发过故障。
<div><strong>精选留言（5）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/15/f8/b8/0398768b.jpg" width="30px"><span>takumi</span> 👍（2） 💬（0）<div>先止损，把影响降到最低，然后在回滚，至少保证服务可用性不会中断太久</div>2024-07-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/34/b3/cf70e0f5.jpg" width="30px"><span>枕畔雪</span> 👍（1） 💬（0）<div>哪个手段生效快用哪个。一般情况故障发现后这两个手段一起上。</div>2024-07-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/3e/1e/0b/6976f5a3.jpg" width="30px"><span>会飞～的猪</span> 👍（0） 💬（0）<div>根源上解决问题---灰度策略。先上灰度环境，没问题了再进行正式与灰度切换</div>2025-01-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg" width="30px"><span>花花大脸猫</span> 👍（0） 💬（0）<div>针对思考题，我理解需要针对业务特性来判断，在发版时，我们一般会控制新老版本的服务流量，保留一部分老服务，先将流量切给新服务，如果新服务业务处理异常，如果是面向客户是toC端会立即会立即切流回滚到老服务，如果是toB端的，会新老服务并行，控制新服务的转发流量，用于验证分析问题，基于问题解决的复杂度，确定是否需要回滚处理</div>2025-01-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/69/7d/59143808.jpg" width="30px"><span>书豪</span> 👍（0） 💬（0）<div>单实例阶段回滚，单机房阶段切流，全流量阶段回滚</div>2024-08-01</li><br/>
</ul>