你好，我是倪朋飞。

转眼间，距离这门课的常规更新结束已经过去了两个月的时间。非常高兴看到很多同学都坚持学习到了最后，并对课程中的各个案例进行了实践操作，甚至把它们扩展到了更多的场景中。

从今天开始，我们的课程就进入了动态更新阶段——“技术雷达篇”。我会根据同学们反馈的热点问题，以及 eBPF 最新的发展状况和实践案例，动态调整这一阶段的内容。在为你解惑的同时，这一动态模块也会交付更深入的 eBPF 内核原理，以及它在实际生产环境中的综合应用方法。

这一讲是动态更新阶段的第一篇，也是我对很多同学留言反馈的统一解答。我会带你重新梳理一下 eBPF 开发环境的搭建方法，以及内核的配置和编译方法。

## 关于 eBPF 开发环境搭建的三个典型问题

在 [02讲](https://time.geekbang.org/column/article/480094) 中我曾提到，学习 eBPF 技术需要你具备一定的 Linux 操作系统基础，并掌握一些基础知识，包括常见 Linux 操作命令、软件包安装管理方法、C 语言程序的基本语法及编译运行步骤等。

在查看课程的留言和反馈时，我发现很多同学的疑惑是有共性的——这些疑惑正是源于对上面这些基础知识的掌握不够深入。其中，最典型的几个问题如下：

- 不熟悉 Linux 系统软件包的安装管理方法，比如找不到软件包 `linux-head-$(uname -r)`，无法定位软件包 `libbpf-dev` 等。
- 不熟悉内置软件包版本过老之后的升级方法。比如，在 `bpftrace`、`bpftool` 等工具报错之后不知道该如何升级，而对于这两个工具，在很多发行版中都需要先升级到新版本，才可以体验最新的特性。
- 不熟悉内核的编译和升级方法，比如不清楚内核编译开关的打开方法，不知道如何编译安装内核等。
<div><strong>精选留言（4）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/22/f5/d8/121e4b68.jpg" width="30px"><span>Woa 🤞</span> 👍（4） 💬（0）<div>哈哈 这个环境配置确实是一个不小的门槛</div>2022-04-27</li><br/><li><img src="" width="30px"><span>woJA1wCgAAbjKldokPvO1h9ZEJTUP8ug</span> 👍（4） 💬（0）<div>正好项目规划是否需要使用eBPF替换网络驱动，考虑到版本兼容问题，使用条件编译总感觉比较麻烦，不知道其他同学和老师有没有更好的办法呢</div>2022-04-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/cd/db/7467ad23.jpg" width="30px"><span>Bachue Zhou</span> 👍（1） 💬（0）<div>我觉得最好的办法就是无脑用最新版本的操作系统，例如我发现同样是 5.x 内核，Ubuntu 18.04 就没有 20.04 好，而 20.04 就没有 22.04 好。总之版本越新越好。</div>2023-04-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/0c/30/d4737cd5.jpg" width="30px"><span>lyonger</span> 👍（0） 💬（1）<div>老师好，我想请问一下。编译内核，然后重启。线上业务维护也就半个小时，开启内核那几个选项的话要编译多久呀？另外有些担心到时候机器起不来～，当然线上环境要做这个事情，肯定要找和线上尽可能一样的环境先测试一遍，还有预案也要准备好。 另外线上环境直接debug，会不会可能引起系统负载异常呢？</div>2022-08-29</li><br/>
</ul>