上周我们分享了故障管理中，应该如何对待故障，怎样做好故障定级和定责方面的管理工作。今天我就和你分享当故障真正发生后，我们在故障通报和故障复盘方面的实践经验。

## 故障应急

当故障真实发生后，带来的影响不仅仅是技术层面的，更多的是业务层面的，比如用户和商家的批量投诉，交易量下跌，广告资损等等。而这些影响又会产生巨大的外部压力，并传递到技术团队，这时如果没有很好的故障应对机制，技术团队就很容易陷入慌乱，不知所措。

我们能否有效应对这种突发且高压的状况，我觉得有两个方面十分关键。

**第一方面，业务恢复预案。**

这也是我们在故障应急状态下一定要坚守的**第一原则：优先恢复业务，而不是定位问题**。这就需要我们事先有充足的预案准备以及故障模拟演练，这就跟我们前面介绍的各种稳定性保障措施相关，通过稳定性平台的建设，与我们能够预见到的，以及我们经历过的故障场景相结合，当发生故障时能够第一时间执行对应的恢复预案。

同时，预案的执行不能仅仅在故障发生时才执行，而是应该把故障模拟和恢复演练放在平时。我在团队中经常传递的一个理念就是：**凡是没有演练过的预案，都是耍流氓**。也就是如果我们在日常系统稳定的状态下都不敢执行预案，或者执行了没效果，那真到了故障发生后，在更为复杂的状况下，预案100%也是不敢做的，因为这种异常状态下，我们还要考虑执行了预案是否会导致次生故障。

关于故障模拟，可以分为不同层面来梳理，比如：

- **IDC层面**，如电力切换、UPS切换、核心网络设备切换，单设备故障等，这些故障是可以通过人为破坏进行模拟的，模拟手段相对简单，但是破坏力和影响面会很大，所以做之前一定要准备充分。我们会定期1~2个月做一次类似的模拟演练，涉及机房配合的，也会提前跟运营商约定好时间；
- **系统层面**，如CPU、磁盘IO、网络IO、网络时延、丢包等异常场景，这些都有开源或Linux系统自带的工具支持，比如Stress工具模拟CPU升高，dd模拟磁盘IO，tc模拟网络问题；
- **应用层面**，最典型的就是RT升高，抛出异常，返回错误码等等，这里还是会用Spring的注解功能，在运行时模拟异常状况，然后有针对性地看各种限流降级和开关预案策略能否生效。

关于故障模拟，我再次向你推荐Netflix的Chaos Engineering，介绍得非常全面。

**第二方面，有效的组织协调。**
<div><strong>精选留言（5）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/1d/03/4dc6706c.jpg" width="30px"><span>符亮</span> 👍（5） 💬（1）<div>又是值得反复阅读的一章。对事不对人，控场者很重要，我们公司故障后扯皮的例子不要太多。</div>2020-07-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/22/97/7a1c4031.jpg" width="30px"><span>Raymond吕</span> 👍（1） 💬（1）<div>无处不复盘！孔子也讲复盘：吾日三省吾身。</div>2020-03-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/87/77/b07d0806.jpg" width="30px"><span>向日葵</span> 👍（7） 💬（0）<div>能遇到目标是真正想解决问题的团队，是一种荣幸也是一种缘分</div>2019-09-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/6d/ef/08132ab2.jpg" width="30px"><span>万里</span> 👍（2） 💬（0）<div>这一讲收获很大呀，重新刷新了我对故障的认知</div>2019-04-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/54/21/0bac2254.jpg" width="30px"><span>橙汁</span> 👍（1） 💬（0）<div>但凡能在此专栏刚出时购买并畅读，可能现在也还是现在这样！</div>2023-01-03</li><br/>
</ul>