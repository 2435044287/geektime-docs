你好，我是Chrono。

在“入门篇”学习容器技术的过程中，我看到有不少同学留言问Kubernetes“弃用Docker”的事情，担心现在学Docker是否还有价值，是否现在就应该切换到containerd或者是其他runtime。

这些疑虑的确是有些道理。两年前，Kubernetes放出消息要“弃用Docker”的时候，确确实实在Kubernetes社区里掀起了一场“轩然大波”，影响甚至波及到社区之外，也导致Kubernetes不得不写了好几篇博客来反复解释这么做的原因。

两年过去了，虽然最新的Kubernetes 1.24已经达成了“弃用”的目标，但很多人对这件事似乎还是没有非常清晰的认识。所以今天，我们就来聊聊这个话题，我也讲讲我的一些看法。

![图片](https://static001.geekbang.org/resource/image/ec/9a/ece7f8245a02a5ca52a51c79b6f3ea9a.png?wh=1162x600 "图片来自网络")

## 什么是CRI

要了解Kubernetes为什么要“弃用Docker”，还得追根溯源，回头去看Kubernetes的发展历史。

2014年，Docker正如日中天，在容器领域没有任何对手，而这时Kubernetes才刚刚诞生，虽然背后有Google和Borg的支持，但还是比较弱小的。所以，Kubernetes很自然就选择了在Docker上运行，毕竟“背靠大树好乘凉”，同时也能趁机“养精蓄锐”逐步发展壮大自己。
<div><strong>精选留言（29）</strong></div><ul>
<li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/WrANpwBMr6DsGAE207QVs0YgfthMXy3MuEKJxR8icYibpGDCI1YX4DcpDq1EsTvlP8ffK1ibJDvmkX9LUU4yE8X0w/132" width="30px"><span>星垂平野阔</span> 👍（34） 💬（2）<div>docker分离containerd是一个很聪明的举动！与其将来被人分离或者抛弃不用，不如我主动革新，把Kubernates绑在我的战车上，这样cri的第一选择仍然是docker的自己人。
一时的退让是为了更好的将来。</div>2022-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/d6/2f5cb85c.jpg" width="30px"><span>xmr</span> 👍（13） 💬（1）<div>1.主要还是docker公司话语权逐渐式微，你没有话语权说你不行就不行，docker不得不换一种方式(containerd)陪在你身边。
2.容器技术本身门槛就不高，形成不了技术壁垒，没有containerd还会有containere、containerf之类的代替者。</div>2022-07-13</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/2xoGmvlQ9qfSibVpPJyyaEriavuWzXnuECrJITmGGHnGVuTibUuBho43Uib3Y5qgORHeSTxnOOSicxs0FV3HGvTpF0A/132" width="30px"><span>psoracle</span> 👍（5） 💬（2）<div>老师请教一个问题，很是疑惑。
问题是这样的，runc是一个按OCI规范运行容器的cli工具，如运行时containerd默认使用runc。
我看podman也是通过conmon调用runc运行容器，请问下podman运行容器使用的容器运行时是什么？像docker现在就是通过containerd来调用runc，所以containerd就是docker容器的运行时，从这个角度来看conmon是不是podman容器的运行时？</div>2022-07-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg" width="30px"><span>奕</span> 👍（4） 💬（1）<div>containerd 实现了 CRI 规范，来管理镜像和运行容器，默认和 k8s 绑定，那 k8s 还可以自由替换运行时吗？ 做到 可插拔</div>2022-07-13</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/2xoGmvlQ9qfSibVpPJyyaEriavuWzXnuECrJITmGGHnGVuTibUuBho43Uib3Y5qgORHeSTxnOOSicxs0FV3HGvTpF0A/132" width="30px"><span>psoracle</span> 👍（4） 💬（1）<div>容器运行时只是对Linux的namespace, cgroup, rootfs进行了产品化打包的一种技术，原则上来讲，如果Docker不把运行时containerd分离标准化CRI出来，Kubernetes其实也可以造出新轮子，毕竟现在的容器运行时也有很多，像cri-o, kata, mcr等，当然不知道会不会有啥版权侵犯到moby的。</div>2022-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（3） 💬（2）<div>请教老师两个问题：
Q1：有人提出了这个观点：“数据库不适合用docker，不管是mysql还是ES”，这个观点对吗？
Q2：关于容器ID和imageID，我的理解是：容器ID是随机，在同一台宿主机上每次创建的ID都不同，而且同一个镜像在不同机器上创建的ID也不同。但image ID是唯一的、固定的，对于同一个版本，第N次下载和第M次下载的image ID是相同的，同一个image，下载到不同的机器上，image ID也是相同的。 我的理解对吗？</div>2022-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg" width="30px"><span>Demon.Lee</span> 👍（2） 💬（1）<div>看完罗老师这篇，再推荐一下隔壁周老师的（ https:&#47;&#47;time.geekbang.org&#47;column&#47;article&#47;351014 ）一篇。在两位大佬的加持下，Kubernetes 与 Docker 相爱想杀的故事，想不懂都难 😂</div>2022-11-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2e/09/d0/8609bddc.jpg" width="30px"><span>戒贪嗔痴</span> 👍（2） 💬（3）<div>为啥突然冒出个containerd让我一时不知所措，它的作用是什么，是作为守护进程存在吗？既然分离出的containerd没有兼容的接口，Google完全可以不用的，可能是不想重复造轮子吧。我就感觉怎么冒出个containerd就挺突然的。</div>2022-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg" width="30px"><span>lesserror</span> 👍（2） 💬（2）<div>课外小贴士中的“正式毕业”是什么意思呢？</div>2022-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg" width="30px"><span>aoe</span> 👍（2） 💬（1）<div>放心了</div>2022-07-13</li><br/><li><img src="" width="30px"><span>乔楠</span> 👍（1） 💬（1）<div>“以斗争求和平则和平存，以妥协求和平则和平亡”</div>2023-08-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg" width="30px"><span>花花大脸猫</span> 👍（1） 💬（1）<div>没办法呀。。毕竟依托于k8s的环境运行，别人给了标准，你不调整，那只能被替换了！毕竟谁也不是不可替代的</div>2022-07-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/f0/50/c348c2ea.jpg" width="30px"><span>吕伟</span> 👍（1） 💬（1）<div>是不是可以这么理解“K8S弃用docker”的事情：
K8S在1.24版本后去除了容器使用docker的默认支持，要使用docker作为容器节点只是比以前版本稍微多做一些操作（如：加装插件或者修改哪里的配置），然后也是可以正常像以前一样正常使用docker的。这点是因为docker容器技术符合CRI标准，就算表面脱离了，实际也是兼容。

最后有一点好奇，K8S弃用docker作默认，那么是哪个容器上位成功，但是说只是K8S初始化时要多做选型配置而尔。就好比window系统默认预装ie浏览器，然后有个超纯净版要自行安装浏览器，这个比喻对吗？</div>2022-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/cd/e0/c85bb948.jpg" width="30px"><span>朱雯</span> 👍（1） 💬（1）<div>我第一反应也是自掘坟墓，我知道是胳膊拧不过大腿，但也可以拧一拧啊。</div>2022-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/27/ce/58/71ed845f.jpg" width="30px"><span>Dexter</span> 👍（1） 💬（1）<div>IDL —-接口描述语言，那schema是什么意思？一些接口格式或者规范吗？</div>2022-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/d0/51/f1c9ae2d.jpg" width="30px"><span>Sports</span> 👍（1） 💬（1）<div>感谢作者把这个弃用docker的疑惑解决了</div>2022-07-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/8d/4d/992070e8.jpg" width="30px"><span>叶明</span> 👍（0） 💬（1）<div>k8s 没有 docker 可以活得的好好的，反之则不然，docker 还是想和大哥搭上关系，如此才能更好的生存下去。</div>2024-11-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/5b/66/ad35bc68.jpg" width="30px"><span>党</span> 👍（0） 💬（1）<div>docker的cri到底有啥功能，与docker engine有啥功能上区别，我想做个win程序能否只下载cri然后通过接口用上容器化的应用，主要是很多环境搭建太费劲了，或者有其他容器化的方法么</div>2024-03-03</li><br/><li><img src="" width="30px"><span>Geek_000c13</span> 👍（0） 💬（1）<div>那containerd 和runc 又是什么关系？</div>2024-02-04</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/gdrRWp2Q9wJ4P2NcLxLicuvhHKwFSk7QkeBOEAo0hJtPo9Y94hrRm631o7mtBaBclBZvZko7oHXecURpWuBJBQA/132" width="30px"><span>Geek_6e3c78</span> 👍（0） 💬（1）<div>打不过就加入</div>2024-01-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/08/03/2bfde3d5.jpg" width="30px"><span>Mia</span> 👍（0） 💬（1）<div>正文中 写的是“CRI 采用了 ProtoBuffer 和 gPRC”，gPRC 是不是应该改为gRPC。</div>2023-08-24</li><br/><li><img src="" width="30px"><span>乔楠</span> 👍（0） 💬（1）<div>“以斗争求和平则和平存，以妥协求和平则和平亡”
kubernetes和docker都想生存，并且是站着主动的生存；
所以就只能互斗互让了。</div>2023-08-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/ab/c3/60a3255a.jpg" width="30px"><span>Marvin</span> 👍（0） 💬（1）<div>上面有张图片写有dockerd, 如果containerd是原来的docker deamon, 那这个dockerd是什么呢，谢谢</div>2023-03-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/f0/e9/1ff0a3d5.jpg" width="30px"><span>...</span> 👍（0） 💬（1）<div>课程由浅入深，娓娓道来，能看出作者从零小白基础入门角度考虑，非常好的课程。点赞。</div>2022-09-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg" width="30px"><span>陈斯佳</span> 👍（0） 💬（1）<div>这故事讲的太详细生动了！好奇老师都是从哪里听说这些的呢？</div>2022-09-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1c/39/85/c6110f83.jpg" width="30px"><span>黄骏</span> 👍（0） 💬（1）<div>我是说为啥rockylinux 9.0虚机里多了cri-dockerd和containerd、podman呢，原来有这一段历史。
老师的演示环境，是默认非root用户吗？</div>2022-09-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/87/5f/6bf8b74a.jpg" width="30px"><span>Kepler</span> 👍（0） 💬（1）<div>Kubernetes 正式从CNCF毕业，这里的“毕业”是什么意思？</div>2022-07-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7c/cf/d5382404.jpg" width="30px"><span>RRR</span> 👍（0） 💬（2）<div>翻译一下，就是本地开发用 Docker ，生产上用 k8s，至于 k8s 底层用的是不是 Docker，和我们关系不大。</div>2022-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/db/26/54f2c164.jpg" width="30px"><span>靠人品去赢</span> 👍（0） 💬（1）<div>其实就是kubenetes加入CNCF，希望做大形成业界标准，docker面对这种分离出containerd加入CNCF也作为业界的标准，但是刚开始还是藕断丝连跟自己的docker，结果kubernets直接调用containerd绕过Docker。docker已经成为历史书写者，这已经很成功了，看一看sun，现在不也是没了吗。</div>2022-07-25</li><br/>
</ul>