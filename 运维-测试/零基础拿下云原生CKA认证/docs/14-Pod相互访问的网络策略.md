你好，我是雪飞。

上一课我们讨论了用户和服务账号通过 API Server 访问集群的安全问题，通过 RBAC 权限控制有效应对了外部访问风险。今天，我带你了解一下 K8s 内部 Pod 之间相互访问的安全问题，从而防范 K8s 集群内部的安全风险。

默认情况下，K8s 集群内部网络没有任何网络访问限制，任何 Pod 都可以与其他 Pod 通信，甚至不同命名空间的 Pod 也可以相互访问。例如，在 A 命名空间下运行着一个转账的业务应用 Pod，然后有人偷偷在 B 命名空间中部署了一个给自己转账的应用，那么这个 Pod 就可能直接访问 A 中的 Pod 来给自己转账，这样就会出现严重的安全漏洞。因此，有时需要对 Pod 进行网络隔离，从而提升集群的安全性。

## 认识网络策略

K8s 提供了网络策略（NetworkPolicy）资源对象，用于确保只有授权的流量才能进入或离开 Pod，从而提供一种强大灵活的安全机制。网络策略允许管理员设置网络规则来控制 Pod 间的网络流量，这些规则通过标签选择器选定被保护的 Pod，并规定哪些来源 Pod（或者来源 IP）允许访问被保护的 Pod，或者规定这些被保护的 Pod 允许访问哪些目标 Pod（或者目标IP）。

我们看一下网络策略的三个组成部分：