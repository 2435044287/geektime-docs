你好，我是雪飞。

上节课，我带你给集群中的 Pod 容器增加了探针配置，以及资源请求和资源限额配置，从而保障我们的应用运行得更加平稳，但是，在实际项目中，我们仍然可能会遇到一些集群或者应用故障。今天我就给你介绍一些在 K8s 集群中常用的方法，来查看集群资源消耗情况、资源对象详细信息以及查看 Pod 容器和集群组件日志，帮助你快速定位和解决问题。我们先来了解一下如何统计集群资源消耗情况。

## 资源消耗统计

在硬件集群的日常运维过程中，我们通常需要关注各个服务器的资源使用情况，如 CPU、内存、磁盘和网络等，这些信息可以通过一些软件（例如 Prometheus）采集并展示出来，方便运维人员了解到集群的整个状态。

在 K8s 容器集群中，我们也需要关注节点和 Pod 的运行情况，所以 K8s 提供了 “kubectl top” 命令，可以查看节点和 Pod 的 CPU 和 内存消耗情况。不过在使用 “kubectl top” 命令之前，需要先安装 Metrics Server 服务。

### 认识 Metrics Server

Metrics Server 作为一个独立的组件部署运行在 K8s 集群中，专门负责收集和提供集群资源使用情况的相关指标（Metrics），这些指标包括对 CPU、内存使用情况的监控。它的实现原理如下图：