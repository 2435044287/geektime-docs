你好，我是潘野。

从今天开始，我们将会学习云原生基础架构的重要理论和发展脉络，为之后我们实践全自动化的基础架构管理打好基础。

作为课程的第一讲，我想先和你聊聊“基础设施即代码（Infrastructure as code）”。说起这个话题，你可能觉得是老生常谈，毕竟我们很容易就能在网上搜到很多相关内容。不过，这些内容往往很零散、不够系统，结合实践案例深入探讨的更是凤毛麟角。

今天，我就带你系统梳理一下基础设施即代码（Infrastructure as code）的来龙去脉。

## 场景模拟

让我们从一个小场景开始聊起。假如你是基础架构部门的技术总监。最近，公司要上线一个新业务。开发部门估算后，向你提出需要300台服务器来支持，100台做缓存系统，100台给中间件使用，50台给数据库使用，为了应对意外情况，还有50台做冗余。

那么接下来，从采购到业务真正上线都会经历哪些过程呢？

## 过去的IaC：面向配置工具管理

在公有云普及之前，一般来说情况是这样。

1. 基础架构部门先采购300台服务器，数据中心工程师负责将机器推上机架，加电开机。
2. 网络组同学会为这批新机器分配Vlan、Subnet等资源。
3. 系统运维同学根据需求分配机器，然后安装操作系统，运行配置管理工具，完成后，再交付给负责应用发布的同学。
4. 负责应用发布的同学发布应用，最终完成整个业务上线。
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/18/a5/34/6e3e962f.jpg" width="30px"><span>yayiyaya</span> 👍（1） 💬（3）<div>老师， 我有些地方不明白，声明需要CPU、内存和磁盘。 可以通过定义的resource 资源和storageclass来解决；如果是节点的资源不足 ，也可以通过云平台k8s管理， 动态的扩缩容节点。 但是，何时进行扩缩容？是通过什么做判断的？ 某些服务申请的声明资源比实际使用要大的多，这些又该怎么办呢?</div>2024-03-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/9f/f6/7431e82e.jpg" width="30px"><span>xueerfei007</span> 👍（0） 💬（1）<div>但是对于云服务提供者来说，给外部提供k8s这样的api，方便用户创建使用资源，但是他们自己的工作依然很复杂，还是要自己处理物理集群</div>2024-04-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/92/be/8de4e1fe.jpg" width="30px"><span>kaizen</span> 👍（0） 💬（2）<div>应用所需要的DB,消息队列等，应该还得靠terraform来拉起来吧</div>2024-03-25</li><br/>
</ul>