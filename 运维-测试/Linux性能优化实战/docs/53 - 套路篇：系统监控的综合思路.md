你好，我是倪朋飞。

在前面的内容中，我为你介绍了很多性能分析的原理、思路以及相关的工具。不过，在实际的性能分析中，一个很常见的现象是，明明发生了性能瓶颈，但当你登录到服务器中想要排查的时候，却发现瓶颈已经消失了。或者说，性能问题总是时不时地发生，但却很难找出发生规律，也很难重现。

当面对这样的场景时，你可能会发现，我们前面介绍的各种工具、方法都“失效“了。为什么呢？因为它们都需要在性能问题发生的时刻才有效，而在这些事后分析的场景中，我们就很难发挥它们的威力了。

那该怎么办呢？置之不理吗？其实以往，很多应用都是等到用户抱怨响应慢了，或者系统崩溃了后，才发现系统或者应用程序的性能出现了问题。虽然最终也能发现问题，但显然，这种方法是不可取的，因为严重影响了用户的体验。

而要解决这个问题，就要搭建监控系统，把系统和应用程序的运行状况监控起来，并定义一系列的策略，在发生问题时第一时间告警通知。一个好的监控系统，不仅可以实时暴露系统的各种问题，更可以根据这些监控到的状态，自动分析和定位大致的瓶颈来源，从而更精确地把问题汇报给相关团队处理。

要做好监控，最核心的就是全面的、可量化的指标，这包括系统和应用两个方面。
<div><strong>精选留言（26）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/ec/21/b0fe1bfd.jpg" width="30px"><span>Adam</span> 👍（33） 💬（1）<div>除了USE原则，还有一个RED原则 。</div>2019-03-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/31/d8/18a2de6d.jpg" width="30px"><span>朱林浩</span> 👍（5） 💬（1）<div>如何查看内存饱和度，即内存换页量？</div>2019-04-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/93/43/0e84492d.jpg" width="30px"><span>Maxwell</span> 👍（5） 💬（1）<div>文件描述符数，连接数，连接跟踪数这些指标监控系统如何监控呢？</div>2019-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/6c/64/abb7bfe3.jpg" width="30px"><span>霹雳旸神</span> 👍（3） 💬（1）<div>公司交易系统监控还停留在hostmonitor来配置监控的阶段，各产品基本思想都差不多，老师这样一梳理脑子更清晰了，目前自己正在研究如何把交易系统容器化，等把百来套交易系统的集群搞起来后，再把老师推荐的监控方案亲自实践一遍，应该会学的更深刻</div>2019-03-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/43/50/ef2cfbce.jpg" width="30px"><span>蒙</span> 👍（2） 💬（2）<div>遇到的监控问题：有时候单个性能瓶颈往往引起一连串问题，比如swap使用，导致请求响应慢，请求堆积，线程增多，文件句柄数升高，cpu瞬间升高。归因分析比较困难。最后就变成重启大法好</div>2019-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/19/31/b438b9cf.jpg" width="30px"><span>zg</span> 👍（1） 💬（1）<div>可以移植到ARM嵌入式Linux系统吗？</div>2019-03-31</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eo9ls0YJfc9CQhxxqVNP57N4D4gHfqt6oP5UhxibqgRwqj9f8UVusDVH24QYzj5JtAfdvY35ay5amQ/132" width="30px"><span>高</span> 👍（1） 💬（1）<div>倪老师，您好，通过您的课程受益匪浅。最近我刚好在生产中遇到了个问题，k8s环境下，因为某个cgroup超出限制，系统不停的重启pod，最后引发系统crash。我们收集到了core dump文件，确定了最后是触发了linux的Bug导致系统crash；系统不停的重启pod，应该是内存泄露导致，引发了oom；通过coredump文件，我找到了一堆java线程，应该是这个所致，但是在分析过程中的一些指标还不是很清楚，希望能够得到指导；如果您方便的话，可以加我微信18910659557，非常期待您的答复</div>2019-03-31</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/8OPzdpDraQMvCNWAicicDt54sDaIYJZicBLfMyibXVs4V0ZibEdkZlbzxxL7aGpRoeyvibag5LaAaaGKSdwYQMY2hUrQ/132" width="30px"><span>code2</span> 👍（1） 💬（1）<div>见过上海超算中心的超级计算机系统性能监控系统，主要监控CPU的使用情况，可以预留部分CPU给重要任务，也是基于linux的操作系统，监控结果图形化显示与一个大屏幕上。</div>2019-03-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/40/07/050a63ee.jpg" width="30px"><span>slam</span> 👍（0） 💬（1）<div>虚拟机或容器，也能监控吗</div>2019-08-04</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/nNLq6GHrFNm6HrxWeMLf9t31G8fO1s1j3qk995thicplR8Oo2JOJ546aQPCsRND58Q0HyjrdtK1udgdemzR2eaA/132" width="30px"><span>Wing</span> 👍（0） 💬（1）<div>用什么命令可以得到这个 网络： 带宽使用率，重传报文数， 网卡收发错误数，丢包数。
</div>2019-04-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/22/15/c693b106.jpg" width="30px"><span>lerry</span> 👍（0） 💬（2）<div>我们是用zabbix来监控服务器的，最近有台虚拟机应用服务器，经常挂了，无法连接上，从vcenter后台也无法连上，每次只能强制关闭启动服务器，找了很久原因都没找到，查看zabbix挂了之前的资源使用情况，同样没发现问题，对于这种情况，还请老师给点思路啊，谢谢！</div>2019-04-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg" width="30px"><span>我来也</span> 👍（0） 💬（1）<div>[D53打卡]
划个水.😁

这个系统监控 与 云服务平台提供的有哪些差异,适用什么样的场景呢?
</div>2019-03-30</li><br/><li><img src="https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132" width="30px"><span>ninuxer</span> 👍（8） 💬（0）<div>打卡day57
最近刚好在利用cadvisor+promethues+grafana对运行容器进行资源监控，现在是用grafana基于图形的告警，对promethues的查询语言还在摸索中～</div>2019-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/ec/21/b0fe1bfd.jpg" width="30px"><span>Adam</span> 👍（6） 💬（0）<div>打卡,线上用prometheus+grafana监控k8s资源。prometheus够强大。</div>2019-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/f4/3d/e3406ac4.jpg" width="30px"><span>快乐</span> 👍（4） 💬（0）<div>监控方案也可以使用netdata https:&#47;&#47;www.netdata.cloud&#47; 监控数据完善，告警机制，一键部署，非集中式管理，配置也足够简单</div>2020-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/3d/77/45e5e06d.jpg" width="30px"><span>胡鹏</span> 👍（2） 💬（0）<div>我目前的水平是，看到接口慢了，说明存在性能瓶颈了，😂，还得继续努力</div>2019-03-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/14/99/5b1ed92b.jpg" width="30px"><span>戴斌</span> 👍（1） 💬（0）<div>监控的服务器较多的时候，我们希望通过周报的方式评选出最忙和最闲的服务器作为优化资源的思路。
这个评判的标准我暂定为：
1.统计所有的服务器的CPU使用率、内存使用率、1分钟负载&#47;CPU核心数  的周平均值
2.每个服务器的3个指标做加法运算
3.其结果最大的 是当周服务器负荷较高的服务器。
请问老师这种方式是否合理？或者有没有更合理的方式去统计周维度  大量服务器的负荷情况了？</div>2020-03-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/a5/73/3ddc7c77.jpg" width="30px"><span>Brave Shine</span> 👍（1） 💬（0）<div>请问老师怎么查看IO错误数和文件系统错误数</div>2020-01-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/a0/b7/1327ae60.jpg" width="30px"><span>hellojd_gk</span> 👍（0） 💬（0）<div>我们应用服务的系统cpu利用率有时候能到80%，但自身cpu利用率才10%.4核负载能达到4-6.
感觉不太好，不太正常。想优化，怎么开展，能提供下思路吗？</div>2020-03-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/58/62/346dd248.jpg" width="30px"><span>Q罗</span> 👍（0） 💬（0）<div>套路篇果然有套路</div>2020-03-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/3a/cf/30510276.jpg" width="30px"><span>墨田</span> 👍（0） 💬（0）<div>老师要是能给出查看对应参数的命令就更好了， 毕竟学了后面就忘了前面， 还是有点忘乎所以了</div>2020-03-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/98/9a/9d544a38.jpg" width="30px"><span>杨国宇</span> 👍（0） 💬（0）<div>老师好，如果基于docker来实现监控系统的部署，docker对系统的资源消耗会影响到性能吗？</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/fa/b4/6892eabe.jpg" width="30px"><span>Geek_33409b</span> 👍（0） 💬（1）<div>对于业务数据的监控，老师有什么推荐的工具吗？尽量不入侵代码</div>2019-06-22</li><br/><li><img src="" width="30px"><span>如果</span> 👍（0） 💬（0）<div>DAY53，打卡
</div>2019-04-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/93/43/0e84492d.jpg" width="30px"><span>Maxwell</span> 👍（0） 💬（0）<div>怎么理解上面哪些性能指标的错误数呢？cpu错误数什么情况下出现，内存分配错误等</div>2019-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d8/08/87afa2aa.jpg" width="30px"><span>星辰</span> 👍（0） 💬（0）<div>刚好在做系统模版监控 有这个思路  框架就有了</div>2019-03-29</li><br/>
</ul>