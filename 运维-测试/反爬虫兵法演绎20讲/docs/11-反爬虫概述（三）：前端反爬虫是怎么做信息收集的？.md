你好，我是DS Hunter。

上一讲，我们已经了解了前端反爬虫中最主要的动作，key的加密，但是除了这件事，前端还可以完成更多的细节来辅助整个反爬虫动作。

例如信息收集，它们虽然不会直接完成“拦截”的动作，看起来也没有什么贡献，但是对于工程师的生存以及“拦截”动作本身的指导和优化来说，却有着不小的辅助功能。最后，我们会把key的加密、信息收集这一切都聚集到规则引擎中统一收口。

这一讲，我们就把目光聚集在信息收集以及规则引擎这两大辅助部分，完成前端反爬虫的主要工作。

## 信息收集

我在[01讲](http://time.geekbang.org/column/article/480101)中，就强调过信息一直是战争的核心，而信息收集是反爬虫的重中之重。公司有爬虫的需求，是希望在信息战中取得胜利，进而赢得商业的战争。而反爬虫方“收集信息”需求的产生，是由于工程师们想在反爬虫这场战争中打赢。

那么，到底要收集什么信息、怎么收集信息呢？后续我们又要怎么利用这些信息呢？我们按照反爬虫的动作顺序，先从信息预收集的部分开始说起。

### 信息预收集

在信息预收集模块，我们需要收集用户特征用于分析，而收集这些信息的方法，都可以认为是收集模块。当然，因为用户特征信息会被送到服务端进行分析检测，所以这里我们收集了哪些数据，应该是一个秘密，尽可能让爬虫方不知道才好。这和后面我们提到的“埋点统计分析”中的普通埋点是不同的。普通埋点，不怕爬虫方知道。
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（3） 💬（1）<div>请教老师几个问题：
Q1：爬虫一般用什么语言开发？
       是不是主要是用Python？用Java可以吗？
Q2：“前端使用大量 Server 换取网络链接数”，server怎么理解？
     前端不就是网页吗？难道在网页里加了“server”？
Q3：“高写入速度、低读取速度的存储方式”，怎么理解？
     不管什么存储，最后都是存到硬盘上。对于硬盘，写入、读取速度应该一样啊。
     怎么会有写入速度高二读取速度低呢？
Q4：客户端加密会更容易被爬虫方破解吗？
    “客户端收集的信息，会在客户端进行加密，然后传输过来”，客户端也
    就是网页啦，网页上加密只能用js，而爬虫方是能够看到网页上的js代码的，
    这样不就会被破解吗？</div>2022-02-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/fb/65/8c04cd1e.jpg" width="30px"><span>枯淡</span> 👍（0） 💬（1）<div>老师您好！麻烦问一下服务端如何校验dom指纹（加盐md5后）呢？dom指纹的原文是啥，服务端怎么知道？谢谢，期待您的答复</div>2024-03-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ec/13/49e98289.jpg" width="30px"><span>neohope</span> 👍（0） 💬（1）<div>1、规则引擎本质上跳了生产发布，而制定生产发布流程是为了降低线上变更风险。那么，如果测试质疑你在引入风险越过测试权限，如何回应呢？
规则引擎测试应该也是可以测到的，但对测试要求很高。
开发提供工具+测试验证，可能是一个折中方案。
要么让测试同学放过规则引擎，要不让测试同学可以更理解规则引擎，都可以。

2、理论上说信息收集是越多越好的，但是过多了又会对系统造成较大的压力。那么如何评估需要收集哪些数据呢？
先收集对业务分析+反爬虫最有用的数据，其余不够用再增加

3、收集的数据里不能包含用户隐私数据， 否则可能有法务风险，尤其是跨国项目。 那么， 如何保证自己收集的数据不会不小心包含用户隐私呢？
代码静态扫描，代码评审在代码方面排除
前端通过公共函数实现脱敏
后端通过公共组件或切面，实现日志模块自动脱敏，日志收集模块自动脱敏</div>2022-03-15</li><br/>
</ul>