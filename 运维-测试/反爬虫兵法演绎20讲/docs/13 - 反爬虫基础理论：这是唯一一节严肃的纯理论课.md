你好，我是DS Hunter。

前面12讲，我们讲完了反爬虫的所有操作，但是你可能会觉得，这样一攻一防的讲解在应用的时候会存在割裂感，实际工作中，还是摸不透反爬虫的整个流程。

那么今天，我就带你完整地走一遍反爬虫流程，从信息收集开始，到对爬虫的预估、线上测试，对工作需求的分析，最后，也会告诉你在流程中存在的风险点。

希望你能够通过今天的课程，理解那些反爬虫里严肃的纯理论知识。甚至，你可以把今天的课程当作反爬的标准流程手册。当然，我更希望你能通过今天的总结，了解反爬虫到底反的是什么。是爬虫，还是商业竞争？

在课程开始之前，我推荐你点开这一讲的音频，可以说，和课程的风格是完全的AB两面，至于如何不同，就等你点开来听了。

## 爬虫反爬虫基础理论

首先，我们回顾一下爬虫反爬虫的基础理论。我在上一讲提到过，当你不知道采用什么样的手段反爬的时候，回归初心，往往能够帮助你出奇制胜。

有的时候，你的反爬可能真的是因为竞对，也可能这就是一个因为技术界轮子太多，不得不另辟蹊径、完成目标的一个选择。你可以想想：

> 一个阴霾的晚上，伸手不见五指，你和你的Leader，在一家小龙虾店聊工作。  
> 　  
> 你的领导剥着小龙虾，对你说：“又一个双月要过去了，我们什么轮子也没造，下个月的目标恐怕不好写啊。”  
> 　  
> 你思考了一下，和领导说：“领导，不如我们另辟蹊径，选一个非主流的方向，我们造个反爬虫的轮子如何？爬虫就是大家说的抓取啊，嚣张点，起个TCP链接直接干到对方服务器上，把数据都拉下来就行了，反爬虫就是，别人拉我们数据，我们就干他，让他敢这么嚣张。”
<div><strong>精选留言（5）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（1） 💬（1）<div>听戏说事
1.吃小龙虾时的雾霾天，反映了你的什么心理活动？
享受时，却见天空雾气重重且呼吸不顺；理想很丰满，现实却充满荆棘和不确定性；
2.伸手不见五指的夜晚，却能看到圆月；，作者想通过这样强烈的反差表达什么思想？
虽各种不确定，一轮圆月照明方向，使得看到希望；
3.小龙虾的配料进行 AB 测试，需要进行 AA 校验吗？
方案测试完成，是否需要校对其中哪些是真实的。
不同情况拿到的数据是不同的，如果某些城市只有冬夏；偶尔出现的小概率春秋拿到的数据可能就有误差。数据拿到后还要再次筛选，祛除杂质方能得到大概率且常态真实数据。
以上是个人的一些浅薄之析，不知是否言中部分。</div>2022-02-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ec/13/49e98289.jpg" width="30px"><span>neohope</span> 👍（0） 💬（1）<div>小区封闭不出差才有空刷课程，结果刷到了老师在吃小龙虾。对于课后题，我想说，不管啥AB配料先来两斤。</div>2022-03-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/63/57/b8eef585.jpg" width="30px"><span>小虎子11🐯</span> 👍（0） 💬（1）<div>听完老师的这些理论分析，感觉清楚了很多</div>2022-03-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg" width="30px"><span>奕</span> 👍（0） 💬（1）<div>对于新上线的策略，可以使用线上流量回放来进行验证</div>2022-02-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（1） 💬（0）<div>请教老师几个问题啊：
Q1：反爬虫代码是独立于业务代码？还是和业务代码混在一起？
Q2：反爬虫代码是怎么起作用的？相当于针对请求的一个过滤器吗？
        即接收到请求后根据策略决定直接reject还是放行到后端业务代码。
Q3：信息收集的“前端辅助信息”的js是指网页还是node?
        信息收集的第一类是“前端辅助信息”，其中谈到“收集手段是使用js代码”，
        请问这里的 js 是网页上的 js？ 还是node部分的 js?
        （一说前端，我一般认为是网页，但现在node也算是前端吗？）
Q4：误伤用户后会一直拒绝该用户吗？
        比如今天误伤了，用户无法购物，那明天用户还是不能购物吗？
Q5：京东应该有反爬吧。我一直在京东购物，有五年了，也没有被误伤过。
        是不是可以认为京东的反爬做得比较好？
Q6：Canvas指纹和DOM指纹是指什么？
Q7：客户端的 location.href 是指请求头中的location.href吗？
        客户端的 location.href与Ajax的referrer应该是什么关系？</div>2022-03-01</li><br/>
</ul>