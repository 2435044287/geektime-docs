你好，我是DS Hunter。从这一讲开始，我会给你讲一讲不同研发职能做反爬的方向和技巧。

一般来说，公司会将Web站点分为前端、后端两部分，也就是前后端分离。必要的时候，可能还会做BFF。后端做反爬，是一件自然而然的事情，很多公司的反爬虫都是后端开始做的。当后端力不从心之后，才开始给前端做。前端力不从心了呢？就开始由BFF做了。

所以在课程中，我们也同样按照这个逻辑，先从后端开始说起。我会给你介绍下后端进行规则过滤的基本方法，并带你进入正式的key生成与验证斗争中，希望你能在这个过程中，真正理解后端反爬虫的作用以及成本分析逻辑。另外在这节课的最后，我还针对爬虫的计算力进攻进行了拓展，如果你有精力，也可以随着文字一起思考。

现在，我们就从后端出手的原因开始说起吧。

## 后端出手的原因：服务器压力

我在上面提到了，后端做反爬是一件自然而然的事情。所谓的“自然”，其实是由于服务器（也就是后端）顶不住爬虫的压力才做的。后来慢慢有经验了，才开始做一些类似“提供假信息”、“没有反爬措施的反爬虫系统”这种奇奇怪怪的封杀操作。这个时候，后端出手的原因也慢慢不再仅限于减轻服务器压力，而是开始加入商业上的博弈了。

## 后端反爬虫的具体做法
<div><strong>精选留言（4）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（1） 💬（2）<div>请教老师几个问题啊：
Q1： BFF是什么？
Q2： 爬虫喜欢爬哪些网站？电商网站爬虫应该喜欢爬吧。除了电商网站，一般的垂直类网站会被爬虫爬吗？
        比如极客时间，会被爬虫爬吗？假如我想做一个电视节目类的网站，会被爬虫爬吗？
Q3： 离线检测，具体怎么做的？一个普通的服务？还是大数据组件（比如spark）?
Q4： 规则引擎，自己开发的还是有现成的框架？
Q5： 生成key和验证key在不同的集群中，怎么会是同一个session？
Q6： 拦截操作放在生成key那里，返回一个错误key，怎么就降低验证key集群的压力了？
        客户端不管带不带key，请求都到了验证key集群，请求数量没有变少啊。</div>2022-02-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（1） 💬（1）<div>反爬系统没做好，就反而会形成了自身的漏洞。
K8流行的时代，关键point依然不习惯K8-资源隔离太差，一台实体机的多个虚拟机去实现-性能可能会更好；挂了就挂了不会影响到其它机器，docker&#47;K8挂了就不一定只是自己挂了。
部署讲的是在稳定的基础上可以出现各种变招，单机、主备、高可用、负载均衡，不同的应用可以上不同的后台策略，技术是可以互相借鉴使用的。
关于第二个问题：Key的存储；key到底是临时存在键值库、还存在min版的文档库或者RDS里面代价也不一样，又或者key本来就是一个四不像。普通用户只管使用，不会去猜；机器则喜欢去算和猜。</div>2022-02-16</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/a4nwicfbEpwqfm8En9iapFqGoOpVg0p0N4ZjIFAdWQMiaxT0JT9OpYrM5ud1OliaLAUhhiaHDjY8mxmNfSbgBNAAGTQ/132" width="30px"><span>sqnv_geek</span> 👍（0） 💬（0）<div>真随机的salt，在验证时不是和生成时不一样了吗？那怎么验证key？</div>2023-01-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/04/0a/07a48224.jpg" width="30px"><span>圆桌π</span> 👍（0） 💬（0）<div>爬虫小白结合课程内容的发言💬：
1.“拦截率”下降，不代表不能反爬。
这是策略之一，数据大体上还是安全的。
拦截率下降了，那用户体验应该变好了。
而且随机跳过，对爬虫方有迷惑作用——我努力使他相信拿到了真实数据了。

2.（说实话，小白没看太懂MD5的道理）
我的大学数学学过函数的“映射”这一概念，想来这应该算是一种“加密”的手段了吧（请老师同学谅解小白的“土语”）。

3.窃以为个有优劣吧——
一台机器，便宜，但技术要求高、容易被一锅端；
两个Doctor共享，贵，可能技术相对人均就简单一些，但容易因为共享，造成不可预测人事关系变动（eg：离职&#47;跳槽&#47;泄密&#47;……）</div>2022-04-18</li><br/>
</ul>