你好，我是赵成，欢迎回来。

上一讲我们讨论了MTTR的第一个环节，也就是MTTI（故障发现）阶段的应对措施。今天我们继续来看MTTR的另外三个环节，也就是MTTK、MTTF和MTTV阶段，这三个对应的就是故障诊断、修复与确认，我们一起来看在这些环节应该做好哪些事情。

今天的内容，我会围绕一条基本原则展开，那就是：**在故障处理过程中采取的所有手段和行动，一切以恢复业务为最高优先级**。这也是我们故障处理过程中的唯一目标，没有第二个。

相信你一定理解这句话我想要表达的意思，但是在执行过程中，我们往往就是很难执行到位。原因是什么呢？

讲到这里，我先分享一个我自己团队的案例，因为这个案例非常典型，其中暴露出来的问题，你很有可能也遇到过。

我们先一起来看下。

## 一次应急操作导致的故障蔓延

在2016年的双十一前，我们蘑菇街策划了一场预热活动，各种优惠券非常诱人，当时确实吸引了大量的用户来参与。这个活动是秒杀类型，瞬时的并发量非常大，我们很乐观地以为做好了十足的准备。

然而真实情况是，一到时间点就出现了用户下单失败问题。当时，我们赶紧采取限流措施，但是发现下单请求仍然大量阻塞，用户访问超时失败。后来进一步排查，发现请求都阻塞在了价格计算的SQL语句上。这个信息很快传递到了DBA这里，DBA就马上采取措施：既然有阻塞，那扩容就是最快的手段，先尝试一下再说，所以马上做了Slave节点扩容。
<div><strong>精选留言（19）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/14/0c/30/d4737cd5.jpg" width="30px"><span>lyonger</span> 👍（39） 💬（1）<div>能快速处理好故障的团队，内部文化应该也很优秀。这和军队作战类似，经常打胜仗的部队，其内部作风肯定非常严谨细致。而要提高自身作战能力，肯定是要付出代价的，军人可能会流血。相比业务肯定会存在一些因故障演练带来的损失，但随着你业务规模的扩大，这个代价其实省不了。提前向业务方沟通好的故障演练，往往比事后出故障被动处理要好。整个沟通过程，都应尽量化被动为主动，主动发现，主动汇报，主动安抚，尽量降低客户的负面情绪。而且故障过程中汇报用词也很关键，多站在对方的角度思考。另外，故障的处理应对方式，往往你和团队leader(如果这个leader干过运维，那你是幸运的)的认可度有特别大的关系，不然开展起来会很麻烦，毕竟调用的资源不少，牵扯的人又多，还可能有背锅的风险。</div>2020-04-06</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKJrOl63enWXCRxN0SoucliclBme0qrRb19ATrWIOIvibKIz8UAuVgicBMibIVUznerHnjotI4dm6ibODA/132" width="30px"><span>Helios</span> 👍（7） 💬（1）<div>我们公司因为是b端业务，不要求快速修复。

交付工程师会把软件包在客户内部署，我们称为L1，然后无论是部署问题还是业务问题都会找到对应的开发或者devops，这个过程交付工程师就全靠认识谁就问谁了。

后来公司一看不行，两端的效率都太低了，对于开发效率低的原因是因为一个客户出的问题可能其他客户也会出，要经常回答同样的问题，这时候在交付工程师和开发之间多了一层技术支持我们称为L2，最后开发和devops称为L3。L1解决不来的就问L2他们遇到的问题比较多，最后才是L3

这个时候问题解决的效率全靠L2了，因为他们要两端协调，他们就负责了指挥的角色。我觉得我们在文中讲到的角色定位做还算可以，但是技术方面的故障隔离，还有故障演练因为业务原因没有建立，老师觉得呢我们这种业务又没有必要建立呢</div>2020-04-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/bf/aa/32a6449c.jpg" width="30px"><span>蒋悦</span> 👍（7） 💬（3）<div>故障处理过程的管理和软件开发的管理其实是一样的，只不过周期短得多。我经常和团队的人说，即使没有进展也要反馈。我带的都是小项目，一般我也要管故障处理。
不过我提一点，决策应该是“权责利”相匹配的，别决策做对了啥奖励也没有，决策做错了就直接被开了。
另外，</div>2020-04-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/9e/d3/abb7bfe3.jpg" width="30px"><span>wholly</span> 👍（4） 💬（1）<div>受益匪浅，特别是那句：没有进展也是进展！很多从事故障处理或维护人员没有这个意识，确实很关键！我们团队的指挥官一般是负责整个系统的SE来承担，拉通的同时，也做技术决策，还是比较高效的。</div>2020-04-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/d5/12/ba7214ce.jpg" width="30px"><span>Zachary</span> 👍（1） 💬（1）<div>问题到最后不再是简单的技术问题, 还要有管理(流程)和沟通</div>2020-10-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/5b/80/114f589c.jpg" width="30px"><span>宋子龙</span> 👍（1） 💬（1）<div>太棒了👏非常受用</div>2020-04-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（1） 💬（2）<div>这个问题应当是不同公司不同情况吧：有些企业或是技术总监，有些会是部门主管；这其实涉及到的最关键问题就是权限-足够的沟通和协调权限，这种可能涉及跨部门操作的事情只能是公司的中高层。
甚至当直接协调人不在时会有相关业务部门的同级别人员去承担相应的事情。</div>2020-04-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/ee/28/c04a0c83.jpg" width="30px"><span>小炭</span> 👍（0） 💬（1）<div>至少总监级别的人物作为指挥和协调者。</div>2020-11-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/a2/4f/0d983a3e.jpg" width="30px"><span>Quinn</span> 👍（0） 💬（1）<div>为什么没有提前做出准确的评估？技术问题还是管理问题？再次发生的组织手段是什么？这里讲到当故障发生时的对应。理想情况是尽可能避免故障发生。如果没有总结出防止问题出现的手段。仍会导致混乱。</div>2020-05-05</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/mnBC29lF1RibHdwkZdPdGM9QRAl7Y7Aicad8vpmIEialjia93IEVSAHibkKdwHwfZr6qedVHiafKUD8Yk1v2eiaibj8l0w/132" width="30px"><span>xierongfei</span> 👍（1） 💬（0）<div>这个故障处理流程 和 google SRE 那本书讲的类似。我们公司在处理故障中也慢慢引入，之前出问题全是运维排查，看日志重启服务，后面确定了责任，运维只对基础设施负责，重启和业务异常排查，全部开发来做。</div>2022-01-24</li><br/><li><img src="" width="30px"><span>13761642169</span> 👍（1） 💬（0）<div>来自上层的支持必不可少</div>2020-04-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/2d/63/6513b925.jpg" width="30px"><span>杜少星</span> 👍（0） 💬（0）<div>紧急扩容时，也要回测和做数据完整性和一致性校验；这个太太太重要了，所以出问题时救火的人也要顶得住压力而不是大脑一片空白（这时候赛前演练和SOP就很重要），而不是大脑空白一拍脑袋就紧急“救火”，很容易出现火越救越大。</div>2024-06-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2c/86/8f/7ac1dae0.jpg" width="30px"><span>Quincy</span> 👍（0） 💬（0）<div>在我们公司，当出现严重故障时，客服主管一般会联系技术部门主管，由这个主管来协调资源，加快处理故障的速度。</div>2023-08-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/3f/0d/1e8dbb2c.jpg" width="30px"><span>怀揣梦想的学渣</span> 👍（0） 💬（0）<div>我在工作中，很希望有个靠谱的信息中转站，可以清晰传递故障信息，让随时加入的新的问题处理人可以快速了解问题情况和当前进展，重复的描述会让我疲惫，并且可能在紧张的情况下遗漏部分信息的传递。
针对这些问题，我体验过的运维环境中，华为的接口人方式对我来说是最轻松的，接口人详细记录问题处理记录，并且清晰传递给参与问题处理的人，让新加入的人快速了解问题情况。并且大家了解的内容都是同步一致全面的。</div>2023-06-16</li><br/><li><img src="" width="30px"><span>高帅</span> 👍（0） 💬（0）<div>在国企中，制度流程都很完备，主要运维工作者都是合作伙伴在做，过度依赖合作伙伴，甲方人员管理起来，有心无力。</div>2023-03-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/54/38/ff728ee3.jpg" width="30px"><span>Wintersweet</span> 👍（0） 💬（0）<div>一旦发生影响用户感知的重大故障，我们会第一时间通知客服部或政企部的同事，请他们做好用户投诉的解释和安抚工作</div>2023-01-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/b9/0b/cdf98d11.jpg" width="30px"><span>大拇哥</span> 👍（0） 💬（0）<div>老师，运维做着做着就只是一个线上故障的传递着，当然基础设施中间件数据库基本还是运维负责，但是一旦这些环境层面没啥问题，涉及到业务层面的问题，运维就比较吃力，慢慢的就成了线上故障打电话的人，运维这个角色最终的角色是应该这样吗？回答这个问题应该考虑哪些方面的因素？</div>2022-05-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/60/05/3797d774.jpg" width="30px"><span>forever</span> 👍（0） 💬（0）<div>我们的机制是这样的，我们有一部专门的手机，这部手机就叫故障处理，里面的飞书（类似企业微信）也是使用故障这个名字来设定的，所有被定义为生产事故的问题的消息都会第一时间传递到这个手机里面，而这个里面的故障处理目前是由值班运维同学来担任，故障处理（值班运维）接收到生产事故信息，会第一时间再生产事故群里通过关键字触发使用飞书机器人来创建事故报告模板，在事故模板里面填写基本的事故描述，然后通过关键字协助来@对应组的同学进行协同处理，再整个故障处理期间，故障处理（值班运维）担任总指挥的角色，包括故障升级以及事后的复盘也是由故障处理来完成。</div>2022-02-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg" width="30px"><span>mickey</span> 👍（0） 💬（0）<div>可以根据故障的级别，设置不同级别下不同应急过程中的指挥官，一般故障由团队leader担任，跨服务的故障由总监协调担任，严重的由更高一级leader担任，层层上升，动态接管。</div>2020-05-20</li><br/>
</ul>