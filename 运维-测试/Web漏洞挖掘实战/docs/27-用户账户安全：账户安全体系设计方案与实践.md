你好，我是王昊天。

如今，几乎每个人都有自己的微信账号，我们可以用它来和别人聊天、付款、打车甚至玩游戏。这就是账户安全体系给我们带来的便利之处，我们并不需要重新注册游戏账号，也不用记住游戏的账号、密码就能玩这款游戏，你可能会因此觉得账户安全体系是一个非常成功的设计。

事实上，用户账户体系也存在很多的安全隐患，试想如果别人登录上你的微信账号会造成什么后果呢？他可能会观看你的聊天记录、诈骗你的好友、使用你的零钱以及破坏你的游戏账号。不难看出，后果是非常严重的，也因此可以理解用户账户安全的重要性。

那么这节课，就让我们从OAuth授权漏洞、访问控制漏洞及权限提升以及身份验证漏洞这三个方面详细地学习用户账户安全问题。首先，让我们来学习用户账户安全关于授权方面的问题——OAuth开放授权。

![图片](https://static001.geekbang.org/resource/image/6c/5b/6c5969221ef30f9e381ea7b118fdde5b.jpg?wh=1316x522)

## OAuth开放授权

现在很多的Web应用支持我们用其他Web应用的账号进行登录。使得我们不需要给每个Web应用都注册一个账号，这对我们来说非常方便。你可能会好奇这是如何实现的？为什么一个Web应用能用另一个Web应用的账号信息登录。事实上，它是**使用OAuth框架来实现的这一方法的**。

![图片](https://static001.geekbang.org/resource/image/23/7d/239f43f361d897f953a33e66d4474d7d.png?wh=1920x1012)

接下来，让我们具体学习什么是OAuth框架。
<div><strong>精选留言（4）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg" width="30px"><span>ifelse</span> 👍（1） 💬（0）<div>学习打卡</div>2023-03-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/24/7e/73/a5d76036.jpg" width="30px"><span>DoHer4S</span> 👍（0） 💬（0）<div>保护用户账户的难点在用户自身，人才是最脆弱的</div>2022-03-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（0） 💬（0）<div>请教老师几个问题啊：
Q1：在OAuth的三方关系图中（文章的第一个图），以“张三用微信号登录网易云音乐”为例。
       张三、微信号、网易云音乐分别对应图中的哪一个？
       我的理解：网易云音乐 = 待授权的web应用；微信号(代表张三) = 授权用户；
       OAuth服务提供者：是一个第三方的验证机构。
       A 我的理解是否对？
       B 在此例总，OAuth服务提供者，是腾讯公司？还是独立的第三方机构？
Q2：访问令牌每次授权是不同的吗？
       文中这句话“然后待授权的 Web 应用就会收到一个唯一的访问令牌”，
       这个访问令牌，这次用过后，下次再来访问，令牌会变化吗？
Q3：“客户端就可以使用这个令牌去调用相应的 API 接口”，这里“客户端”是指谁？
       是指用户吗？（比如张三）
Q4：用户凭据是指什么？
     文中有一句话“第一个原则为注意验证用户的凭据，确保这个凭据只有用户拥有”。
     用户凭据是指用户账号吗？</div>2022-02-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/7a/8e/934cbcbc.jpg" width="30px"><span>几叶星辰</span> 👍（0） 💬（0）<div>身份的识别，有哪些因素，哪些是必选，哪些是可选，ip，帐号，密码，预留问题，答案，验证码？</div>2022-02-25</li><br/>
</ul>