你好，我是王昊天。

我们都知道，www.baidu.com之所以能够访问Baidu，是因为DNS在解析www.baidu.com这个记录的时候将IP地址指向了Baidu的服务器集群，通过DNS协议我们可以找到正确的服务器地址。

很多时候，我们在连接网络的时候没有手动设置DNS服务器地址，这时我们采用的就是网关统一的默认DNS服务器。如果网关的DNS被黑客入侵，并且黑客将www.baidu.com指向了自己构建的恶意网站，用户就会访问错误的站点，同时可能遭遇黑客的进一步控制。

那么问题来了，**我们该如何判断正在访问的站点的真实性呢**？

答案就是互联网证书体系，而证书体系的有效性就依赖于信任链，这就是这节课我们要一起研究的内容。

## 证书

我们平时在网络上常说的证书全称叫数字证书，**它是一种基于公钥认证体系的电子文件，用于证明公钥持有者的身份**。

一般在证书中会包含以下几类信息：

- 公钥信息
- 拥有者身份信息
- 数字证书认证机构对该文件的数字签名

证书持有者通过该文件（证书），即可向系统或者其他用户证明身份，从而获得对方信任并授权使用某些敏感服务。

这里我们使用Mac系统，通过 launchpad -&gt; 其他 -&gt; 钥匙串访问 -&gt; 系统根证书，可以查看目前系统内部预置的根证书。
<div><strong>精选留言（5）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（1） 💬（1）<div>其实有时所说的不可信不一定是证书本身不可信而是中间环节的proxy的问题，随着软件架构越来越复杂其实漏洞也是从前到后，我们要了解整条链条用了什么才可能可以去预判问题可能出现在哪儿。</div>2022-01-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/89/5b/d8f78c1e.jpg" width="30px"><span>孜孜</span> 👍（1） 💬（1）<div>在用户机器不被黑的情况下外加http client不忽略证书校验，https的ca体系完全可以防止中间人攻击吧？这也是不要使用非官方浏览器和操作系统的原因！

另外，Let’s Encrypt简直是https超级推动者，免费颁发三个月证书，使用其他工具自动续期。爽歪歪。。</div>2022-01-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（0） 💬（1）<div>请教老师三个问题：1 我准备做一个网站，必须要证书吗？2 数字签名用什么加密算法？3 访问一个新网站，什么时候检查证书？ 每次访问都需要检查吗？（是在网站访问流程的第一步之前检查证书吗？就是在DNS请求之前。第一次检查后就不再检查了吗？）</div>2022-01-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg" width="30px"><span>ifelse</span> 👍（1） 💬（0）<div>学习打卡</div>2023-03-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/9a/e3/0a094b50.jpg" width="30px"><span>Wales</span> 👍（1） 💬（2）<div>请教老师一个问题：
CA给互联网信息服务商颁发证书时，证书里的公钥是CA生成的，这意味着私钥也是CA生成的，也就是老师在文中指出的“CA同时拥有证书申请者的公钥和私钥”。

那么这里CA给证书申请者生成的私钥，必然也应该提供给证书申请者，因为申请者需要用私钥来进行独有的加密过程，避免其它攻击者仿冒自己。

那么这里的私钥是通过线下分发的方式（比如给个USB设备）给到申请者嘛？</div>2022-10-14</li><br/>
</ul>