在上两篇文章中，我介绍了环境管理中最关键的几个概念，环境的标准化，让环境自己说话以及环境配置的几种方法。

今天，我分享的主题就是，如何从零出发, 实现一套完整的环境创建。并且尝试挑战一下，如何做到分钟级交付。毕竟，天下武功，无坚不摧，唯快不破。

## 环境构建流水线

当开发人员向你申请一套新环境时，作为测试环境的维护者，你首先需要明确打造环境构建流水线需要关注的三大内容：

1. **虚拟机环境准备**，根据环境的应用数、每个应用需要的硬件配置，准备好环境的硬件资源。
2. **应用部署流水线**，在标准化的虚拟机上进行应用部署，当出现问题时如何容错。
3. **环境变更**，在SOA或微服务的架构体系下，常常会因为测试的需求，将几套环境合并或拆分，创建环境时，你需要考虑如何高效地完成这些操作。
   
   ol&gt;
<div><strong>精选留言（8）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/2d/25/6ac2f111.jpg" width="30px"><span>孙磊</span> 👍（1） 💬（1）<div>有个疑问，现在jenkins很火，携程有用到吗？我们用ansible替代了</div>2018-10-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/9e/77/f9f1b47d.jpg" width="30px"><span>Jax</span> 👍（1） 💬（2）<div>老的项目，数据库结构往往是非常复杂的，量级也非常大，感觉每次测试创建一次数据库这个难度比较大。但是测试数据混乱的情况确实非常困扰我们，不知道有没有最佳实践可以参考？</div>2018-08-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/0c/4e/5d6bb0f1.jpg" width="30px"><span>平仔</span> 👍（1） 💬（1）<div>还是没看到CI&#47;CD的东西</div>2018-08-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/d9/f4/844fdd25.jpg" width="30px"><span>祁勇</span> 👍（0） 💬（1）<div>我们公司的服务就存在好多依赖，启动依赖（字段的缺少都回导致程序无法启动）、程序之间的，架构部推一个规范都很难，从运维这里如何去推动？
还有程序只有在业务调用到了才知道是否可用</div>2018-08-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/7e/72/3aeca403.jpg" width="30px"><span>不需往后看</span> 👍（0） 💬（1）<div>感觉整个过程是个非常复杂的问题。所以能不能这么理解：docker 虽说不是万金油，但一定是必备工具。想知道 老师后面会不会讲些 docker 的相关应用？所占篇幅能有多少 🙈🙈。
</div>2018-08-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/64/9b/d1ab239e.jpg" width="30px"><span>J.Smile</span> 👍（16） 💬（0）<div>太理论了😓，无所得</div>2020-08-30</li><br/><li><img src="" width="30px"><span>Roc</span> 👍（1） 💬（1）<div>紧紧涉及应用前端的搭建，后端中间件以及数据库，数据准备都没涉及到。没有后端犹如没有灵魂的行尸。</div>2022-10-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/3f/0d/1e8dbb2c.jpg" width="30px"><span>怀揣梦想的学渣</span> 👍（0） 💬（0）<div>看完这篇文章，我迫不及待想要分享自己公司内部方法。内部结算系统。统一的web界面，每个人登陆自己工号申请资源环境，结算到各部门，部门有多个项目，且部门不愿意承担某项目费用时，分配到项目组自己承担成本。资源申请页不仅对接主流厂商公有云，还对接公司内部私有云，资源申请不需要人工审批，项目有预算就能申请，预算超支会有申请拦截，并且主送项目负责人，抄送部门领导。超预算申请可以内部OA申请审批。
环境的一致性采用定制镜像和容器镜像的方式，预制一些通用环境，在备注有清晰描述。发放环境速度快，省事。自己想做微调的，可以单独做简单配置，对于无需定制镜像，但仍需改配置的，提前打包脚本和软件包，在系统启动时自动执行配置。减少人工参与带来的操作失误风险。</div>2023-05-05</li><br/>
</ul>