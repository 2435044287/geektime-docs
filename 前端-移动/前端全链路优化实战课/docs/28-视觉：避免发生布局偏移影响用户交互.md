你好，我是三桥。

上节课，我们通过实例解决了视口中图片加载的问题，经过几轮优化，图片在视口中的显示速度得到了提升。

然而，在优化之前，视口中的图片加载还存在一个问题，那就是页面视觉稳定性都不太好。下图是上节课优化过程的时序图。

![图片](https://static001.geekbang.org/resource/image/c5/a9/c5cb9f400e85a9d30e7982c863e98ba9.png?wh=2220x1788)

上面四张时序图显示，图1是优化前的官网加载时序图，报告显示有严重的布局偏移问题，得分是0.7450。

这是因为图1中的图片是通过后台读取的富文本内容，而且没有设置图片的宽高，这就导致浏览器没有给图片预留布局空间。直到当图片加载时，底部内容才会被移出视口。

其它时序图没有出现布局偏移，因为所有图片都预设了宽高属性。

也就是说，视口中的元素，无论是图片还是文本，如果设置了宽高，正常情况下是不会有布局偏移的。

## 什么是CLS？

不知道你之前有没有遇到过下面的几种情况。

- 阅读一篇新闻文章时，页面顶部的广告突然弹出，导致所有内容向下移动。这种被中断的感觉让人十分沮丧。
- 通过手机H5页面购物时，购物车中有几件商品。你想更新商品数量，然后继续购物。但是你点击编辑后，页面布局改变了，手指误触了“删除按钮”而不是 “+1” 按钮。视觉位置突变，让使用体验非常糟糕。
- 填写表单时，选择一个选项之后导致页面内容发生变化，不知道下一步该怎么填写，很迷茫。
<div><strong>精选留言（1）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/2b/86/73/5190bbde.jpg" width="30px"><span>苏果果</span> 👍（0） 💬（0）<div>完整源码入口：
https:&#47;&#47;github.com&#47;sankyutang&#47;fontend-trace-geekbang-course</div>2024-07-18</li><br/>
</ul>