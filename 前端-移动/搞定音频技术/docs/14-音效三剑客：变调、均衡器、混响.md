你好，我是建元。

你是否很好奇《名侦探柯南》里的变声器在现实中能否实现？百万调音师能让本来唱歌跑调的人的歌声变得好听，这到底是用了什么神奇的方法？其实今天我们要讲的音频中的音效，就是为了实现这些变声、修音等特效而设计的一系列的音频处理算法。

为了实现某种特定的效果，音效算法的种类有很多，这节课我主要介绍三种常见的音效算法：变调、均衡器和混响的设计和使用方法。

## 变调

其实在之前讲弱网对抗部分的时候，我们在做快慢放操作时就使用到了变速不变调算法，这其实是变调算法中的一种用法。在讲算法具体实现之前我们先想一下，变调的物理含义是什么？

之前我们讲语音信号分析的时候说过，不同的人发音的基频是不一样的。而音调和基频是直接相关的，要变调其实就是要改变基频。而基频的本质是一个信号的循环周期的倒数，比如基频是250Hz，那么当前时间的语音信号就是以4ms为周期的信号。**我们要变调，其实就是把这个循环周期进行扩大或者缩小。**

如图1所示，如果我们把语音信号的基频提升一倍，或者说提升一个八度或者12个半音，那么时域信号（绿线部分，上面为变调前，下面为变调后）语音的波形还是很相似的，只是每一个周期都缩短了一半。

再看看频域信号（红色部分）是不是变得更稀疏了？最下面的那根亮线代表的基频从250Hz左右提升到了大约500Hz的位置。由于谐波的频率是基频的倍数，所以谐波之间的间隔也变大了。
<div><strong>精选留言（7）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/11/1d/64/52a5863b.jpg" width="30px"><span>大土豆</span> 👍（3） 💬（1）<div>这章来的正好，我明天在部门分享音频处理，正好用的上，哈哈。日常的声音处理，各种重采样，男女生变调，音量加减，淡入淡出，变速不变调，变调不变速等，其实ffmpeg+soundtouch都可以完美实现了。我们业务开发基本是游标卡尺式的开发，看字节数组的长度就基本完事了，输入一帧PCM 4096字节，变速不变调2倍的话，输出是2048字节，那就稳了，如果是变调不变速呢，还是4096字节，如果是48000重采样成8000呢？4096&#47;6的结果就稳了。</div>2021-12-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/12/2f/7d76bc49.jpg" width="30px"><span>四十</span> 👍（0） 💬（2）<div>老师，请问是否可以通过混响来模拟不同设备录制的声音差异，我发现不同app（尤其h5），不同设备录制出的音频，人声音色变化很大，请问这个可以通过混响来模拟吗，通过加入混响数据增强，来提高模型效果。</div>2022-04-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2a/21/45/1d475b7b.jpg" width="30px"><span>劝</span> 👍（0） 💬（1）<div>老师，你好，用ffmpeg的均衡器filter调了重低音后出现暴音一般要怎么处理</div>2022-02-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/43/61/eeefa369.jpg" width="30px"><span>tony</span> 👍（0） 💬（1）<div>通过均衡器调整达到美声效果有哪些开源项目呢？谢谢</div>2022-01-14</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/udFtP9pbRmYiawNS9RyCib4WZic95waXdto9IBC0UMCfMxDAcXdTdv58rzGEzyLtSHI38ibOZzDhhdKe5dXEbllB2A/132" width="30px"><span>Geek_495a1c</span> 👍（0） 💬（1）<div>不知道老师有机会讲一下根据pcm分析常见的音频问题，或则有什么推荐的文章。</div>2021-12-26</li><br/><li><img src="" width="30px"><span>springXu</span> 👍（0） 💬（5）<div>哈，不懂就问。像谍中谍里的，让别人说一段话后，就可以用个麦克风说的话和那位一样了。这个是如何在短时间内做到的？记得网易也有个让使用者读十句句子，就可以用TTS的方式，让这个人帮你读文章了。这又是如何实现的？</div>2021-12-23</li><br/><li><img src="" width="30px"><span>Geek_345096</span> 👍（0） 💬（0）<div>请问下冯老师，这样理解有问题嘛。
实现变调不变速比如您说的250hz变成500hz的基频，原来周期是20ms的信号，现在周期是10ms，人听着速度变快了，想变慢就要还信号还是在20ms的时间播放，通过重构10ms的信号，时间变成20ms，可以通过往10ms信号里面加空帧实现
</div>2024-02-25</li><br/>
</ul>