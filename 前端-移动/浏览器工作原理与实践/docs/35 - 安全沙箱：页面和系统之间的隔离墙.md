前面三篇文章我们主要围绕同源策略介绍了Web页面安全的相关内容，那今天我们把视野向外延伸，来聊聊页面安全和操作系统安全之间的关系。

在[《01 | Chrome架构：仅仅打开了1个页面，为什么有4个进程？》](https://time.geekbang.org/column/article/113513)那篇文章中，我们分析了浏览器架构的发展史，在最开始的阶段，浏览器是单进程的，这意味着渲染过程、JavaScript执行过程、网络加载过程、UI绘制过程和页面显示过程等都是在同一个进程中执行的，这种结构虽然简单，但是也带来了很多问题。

**从稳定性视角来看，单进程架构的浏览器是不稳定的**，因为只要浏览器进程中的任意一个功能出现异常都有可能影响到整个浏览器，如页面卡死、浏览器崩溃等。不过浏览器的稳定性并不是本文讨论的重点，我们今天主要聊的是**浏览器架构是如何影响到操作系统安全的**。

浏览器本身的漏洞是单进程浏览器的一个主要问题，如果浏览器被曝出存在漏洞，那么在这些漏洞没有被及时修复的情况下，黑客就有可能通过恶意的页面向浏览器中注入恶意程序，其中最常见的攻击方式是利用**缓冲区溢出**，不过需要**注意这种类型的攻击和XSS注入的脚本是不一样的**。

- XSS攻击只是将恶意的JavaScript脚本注入到页面中，虽然能窃取一些Cookie相关的数据，但是XSS无法对操作系统进行攻击。
- 而通过浏览器漏洞进行的攻击是可以入侵到浏览器进程内部的，可以读取和修改浏览器进程内部的任意内容，还可以穿透浏览器，在用户的操作系统上悄悄地安装恶意软件、监听用户键盘输入信息以及读取用户硬盘上的文件内容。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg" width="30px"><span>奕</span> 👍（77） 💬（1）<div>安全沙箱是不能防止 XSS 或者 CSRF 一类的攻击，
安全沙箱的目的是隔离渲染进程和操作系统，让渲染进行没有访问操作系统的权利
XSS 或者 CSRF 主要是利用网络资源获取用户的信息，这和操作系统没有关系的</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/1e/71/54ff7b4e.jpg" width="30px"><span>3Spiders</span> 👍（26） 💬（3）<div>每周都跟着老师一起学习，终于坚持到最后了。千里之行始于足下，课程结束后，我们再向老师提问？</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/b9/0d/ae745ec0.jpg" width="30px"><span>刹那</span> 👍（22） 💬（1）<div>老师我有个疑问，既然渲染进程运行在沙箱中，涉及到系统操作的都通过ipc向浏览器进程发送操作请求，那么，这个阶段会不会也存在安全漏洞？就是说，渲染进程有没有可能发送一个能攻破浏览器进程的消息，之后可以通过控制浏览器进程入侵操作系统？</div>2019-10-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/fe/5e/9b723d19.jpg" width="30px"><span>空山鸟语</span> 👍（9） 💬（1）<div>老师讲的全是干货，目前正在反复听呢！
表示还没听够</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/39/1b/bcabd223.jpg" width="30px"><span>Snow同學</span> 👍（7） 💬（2）<div>请问老师,这个问题我问了好几遍了，希望得到老师的回复，
在开发时
1.空页面加载一个URL，如何知道页面已经显示在了屏幕上（从用户真实的视觉上看到页面），在代码层面可以通过检测什么状态知道嘛？
2.在页面已经显示到屏幕后完成，通过点击一个按钮，执行向document添加一些元素（可以是div，div里也可以有更多其他标签和内容），如何知道这些元素什么时候真正显示在屏幕上（从用户真实的视觉上看到页面），在代码层面可以通过检测什么状态知道嘛？
是不是无法通过代码检测呀？</div>2019-10-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/f5/b8/9f165f4b.jpg" width="30px"><span>mfist</span> 👍（5） 💬（1）<div>不能攻击，xss csrf 是攻击的网页服务器的漏洞。跟浏览器本身没有关系。不过应该能使攻击者绕过前端的编码检验之类，如果后端没有对应的安全检验就惨了。</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/4d/04/5e0d3713.jpg" width="30px"><span>李懂</span> 👍（3） 💬（2）<div>老师多给自己留点坑，多讲讲，还想再学学！
希望能讲讲，全局上下文不是只存在一个么，为啥在执行时js，每次都先创建全局上下文，进栈，是不是哪里理解的有问题？</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/39/08/09055b47.jpg" width="30px"><span>淡</span> 👍（3） 💬（1）<div>这就完了吗？意犹未尽，每一讲都讲的挺好。每个2，4，6早上到公司都会第一时间check有没有更新，期待后面的问答加餐环节，哈哈</div>2019-10-24</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLOWucpCLACCYJic5IicKuo9RVSoFsEId2sazOqhnvSUSFztH8vu8skYkIwxgkXpOqmHjTprFWF1GmA/132" width="30px"><span>jyzhang</span> 👍（2） 💬（2）<div>持久存储 。这里有点疑惑，沙箱里渲染进程将读写cookie和缓存文件的需求用IPC发给浏览器内核处理，内核再把结果用ipc返回，为什么这样就会比较安全？</div>2019-12-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/2e/50/240e7beb.jpg" width="30px"><span>李小白</span> 👍（2） 💬（1）<div>老师，我想请问一下，你说渲染进程内部是无法直接操作窗口句柄的，这也是为了限制渲染进程监控到用户的输入事件，这种情况我也可以通过JS来获取监控到用户的输入事件啊，通过渲染进程，渲染进程是可以通过IPC从浏览器内核监控到用户输入事件的啊，和我们正常用js就是可以获取用户的输入事件一样。希望老师帮忙解答一下</div>2019-10-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/84/ee/3a364ccd.jpg" width="30px"><span>滇西之王</span> 👍（1） 💬（1）<div>不能防止，xss攻击和cspf不是针对操作系统的攻击，xss攻击就是执行javascript脚步，他的攻击是在渲染进程内，cspf是发送请求获取用户敏感信息，利用到网络进程</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/2c/0c/683fc6cd.jpg" width="30px"><span>亲爱的偏执狂</span> 👍（1） 💬（1）<div>好快啊，感觉没多久就剩最后一讲就结束了。</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/2f/1f/f95bd8c9.jpg" width="30px"><span>余文郁</span> 👍（0） 💬（1）<div>这是最后一篇文章了吗</div>2019-10-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg" width="30px"><span>许童童</span> 👍（0） 💬（1）<div>真的是快啊，一转眼，专栏就快要结束了，希望加餐能再多来几篇文章。意犹未尽</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/21/7e/fb725950.jpg" width="30px"><span>罗 乾 林</span> 👍（0） 💬（1）<div>不能，XSS&#47;CSRF主要利用浏览器开的口子窃取站点信息，如Cookies等信息。安全沙箱是防止恶意代码利用浏览器程序漏洞，窃取修改操作系统信息</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/9b/a0/91f22e54.jpg" width="30px"><span>man</span> 👍（2） 💬（2）<div>很精彩呀，像看了一部好莱坞大片的感觉。。。</div>2019-10-26</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/yyibGRYCArsUNBfCAEAibua09Yb9D5AdO8TkCmXymhAepibqmlz0hzg06ggBLxyvXicnjqFVGr7zYF0rQoZ0aXCBAg/132" width="30px"><span>james</span> 👍（1） 💬（0）<div>安全沙箱不能防止XSS和CSRF攻击
因为XSS攻击是黑客在页面中注入不合法脚本，导致攻击用户浏览器的问题，是属于渲染进程里面的
CSRF攻击是黑客利用用户的登录状态，是属于利用网络资源获取用户信息，然后黑客通过第三方站点来攻击的目的，这个也是属于渲染进程中的

因此跟安全沙箱没有关系</div>2020-06-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg" width="30px"><span>ifelse</span> 👍（0） 💬（0）<div>学习打卡</div>2024-05-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/55/28/66bf4bc4.jpg" width="30px"><span>荷兰小猪8813</span> 👍（0） 💬（0）<div>安全沙箱是不能防止 XSS 或者 CSRF 一类的攻击，
安全沙箱的目的是隔离渲染进程和操作系统，让渲染进行没有访问操作系统的权利
XSS 或者 CSRF 主要是利用网络资源获取用户的信息，这和操作系统没有关系的</div>2023-04-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/ef/40/b06a223c.jpg" width="30px"><span>葡萄</span> 👍（0） 💬（0）<div>这里有一个疑问想问下老师，这里说到安全沙箱里的渲染进程不会直接显示合成好的图片，而是通过告诉主进程由主进程进行渲染；那这里是否与初次输入URL到页面展示中说的的，由渲染进程将渲染的好的内容展示在web页面相悖呢</div>2023-03-06</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLzSRrK59sydknSSYZdeTww3Cgib9Gy9N4BJGgSXMYdmVIxJYwDXPsLCIE68AbwTkgUct8J4iboAqicA/132" width="30px"><span>罗武钢</span> 👍（0） 💬（0）<div>很棒</div>2022-09-17</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/vkqibkINia6dxVOv5zia2zbkmQbrJUsQw8vDfiauib2DfyvJQ4PDUC7M8p4vqFiaQj70yYwIO8JlHFA450KPmgpsXlsw/132" width="30px"><span>Geek_bing</span> 👍（0） 💬（0）<div>怎么说，意犹未尽啊！课程干货很多导致自己不知道的感觉也很多了～</div>2021-08-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/f7/e5/b290e605.jpg" width="30px"><span>AIGC Weekly 周报</span> 👍（0） 💬（0）<div>Chrome uses a specific definition of &quot;site&quot; that includes just the scheme and registered domain. Thus, https:&#47;&#47;google.co.uk would be a site, and subdomains like https:&#47;&#47;maps.google.co.uk would stay in the same process.</div>2021-06-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/f7/e5/b290e605.jpg" width="30px"><span>AIGC Weekly 周报</span> 👍（0） 💬（0）<div>老师对于这句话：所谓站点隔离是指 Chrome 将同一站点（包含了相同根域名和相同协议的地址）中相互关联的页面放到同一个渲染进程中执行。
其中 相同根域名 是不是表达的意思不对呀，那如果这样可认为 同一站点 的url可太多了。
</div>2021-06-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/f7/e5/b290e605.jpg" width="30px"><span>AIGC Weekly 周报</span> 👍（0） 💬（0）<div>安全沙箱的主要作用是 防止通过浏览器直接操作系统的资源，进而造成系统级的安全威胁。
而 XSS、CSRF 主要是发生在渲染进程(页面)与服务器，这些操作都是符合 安全沙箱 的规则的，所以并不能防护。它们所关注的点不一样。</div>2021-06-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg" width="30px"><span>William Ning</span> 👍（0） 💬（0）<div>Js执行实在渲染进程主线程中？</div>2021-03-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/cb/9d/2bc85843.jpg" width="30px"><span>　　　　　　　鸟人</span> 👍（0） 💬（1）<div>我看见好像chrome安全沙箱也有漏洞，那么请问要是沙箱有漏洞会出现什么呢，怎么办呢？</div>2021-02-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/ee/28/c04a0c83.jpg" width="30px"><span>小炭</span> 👍（0） 💬（0）<div>除了可以使用iframe实现沙箱隔离，单页应用有实现沙箱技术的方案吗</div>2020-10-19</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/rvNsZL0TpjXUSv4Me1h2pfZzBiaj9HrkU3kYHXwOibPs3GksSvg3TptiaibkLhWFFwmmMicJZYGicVI9uDT6kqxb6a4w/132" width="30px"><span>--</span> 👍（0） 💬（1）<div>老师，我有一个疑问已经很久了。麻烦可以解答下

在一个页面打开另外一个一个页面
1、假如这两个页面是同源的，可以互通操作DOM、cookie数据
2、假如这两个页面是同站的，运行在同一个渲染进程中，那么可以互通操作dom和cookie数据吗？</div>2020-10-07</li><br/><li><img src="" width="30px"><span>Geek_e7ff89</span> 👍（0） 💬（0）<div>那黑客会不会入侵浏览器主线程做一些非法的事情呢？？？</div>2020-08-16</li><br/>
</ul>