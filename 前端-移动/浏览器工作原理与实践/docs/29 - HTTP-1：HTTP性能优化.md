谈及浏览器中的网络，就避不开HTTP。我们知道HTTP是浏览器中**最重要**且**使用最多**的协议，是**浏览器和服务器之间的通信语言**，也是互联网的基石。而随着浏览器的发展，HTTP为了能适应新的形式也在持续进化，我认为学习HTTP的最佳途径就是了解其发展史，所以在接下来的三篇文章中，我会从浏览器发展的视角来和你聊聊HTTP演进。这三篇分别是**即将完成使命的HTTP/1、正在向我们走来的HTTP/2，以及未来的HTTP/3**。

本文主要介绍的是HTTP/1.1，我们先讲解HTTP/1.1的进化史，然后再介绍在进化过程中所遇到的各种瓶颈，以及对应的解决方法。

## 超文本传输协议HTTP/0.9

首先我们来看看诞生最早的HTTP/0.9。HTTP/0.9是于1991年提出的，主要用于学术交流，需求很简单——用来在网络之间传递HTML超文本的内容，所以被称为**超文本传输协议**。整体来看，它的实现也很简单，采用了基于请求响应的模式，从客户端发出请求，服务器返回数据。

下面我们就来看看HTTP/0.9的一个完整的请求流程（可参考下图）。

- 因为HTTP都是基于TCP协议的，所以客户端先要根据IP地址、端口和服务器建立TCP连接，而建立连接的过程就是TCP协议三次握手的过程。
- 建立好连接之后，会发送一个GET请求行的信息，如`GET /index.html`用来获取index.html。
- 服务器接收请求信息之后，读取对应的HTML文件，并将数据以ASCII字符流返回给客户端。
- HTML文档传输完成后，断开连接。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJrZb9pm07aickG3dVFBd2yhk5J2clztUniaMNFsjpHu7uacfpGhleKYbgicEnwF5MusKNFKLTUUAYKg/132" width="30px"><span>lee</span> 👍（12） 💬（3）<div>”目前浏览器中对于同一个域名，默认允许同时建立 6 个 TCP 持久连接“，那就是如果浏览器同时请求n个不同域名的后台服务器，那就是允许同时建立n * 6 个TCP持久连接吗？</div>2019-11-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/33/43/08d746c6.jpg" width="30px"><span>月翎魂雨</span> 👍（7） 💬（3）<div>文中“目前浏览器中对于同一个域名，默认允许同时建立 6 个 TCP 持久连接”，看老师画的图是一个tcp持久链接有6个请求的意思吧。而且前面第03章文中“同一个域名同时最多只能建立 6 个 TCP 连接，如果在同一个域名下同时有 10 个请求发生，那么其中 4 个请求会进入排队等待状态”。所以我就很迷糊了，这个请求数和tcp链接关系到底是啥？</div>2019-11-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/f1/27/0472f5ff.jpg" width="30px"><span>童欧巴</span> 👍（2） 💬（2）<div>李兵老师，想问您画图用的什么软件呢？</div>2019-10-21</li><br/><li><img src="" width="30px"><span>Geek_07b5b0</span> 👍（75） 💬（5）<div>感谢李兵老师，我今天实习面试用到了很多从这个课程中学到的东西，人生第一次面试，给了我很大鼓励！
</div>2019-10-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/f5/b8/9f165f4b.jpg" width="30px"><span>mfist</span> 👍（43） 💬（1）<div>1对头阻塞问题，没有解决
2文本传输效率问题，而且不安全
3header中每次都传输类似头，增加了传输成本</div>2019-10-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg" width="30px"><span>奕</span> 👍（40） 💬（0）<div>对于 队头阻塞问题，只要传输层是TCP，就不会得到根本上的解决， http&#47;2 利用流的的机制很大程度的缓解了这个问题，http&#47;3 传输层换成了 UDP 才彻底解决这个问题</div>2019-10-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/ae/18/ee4ded86.jpg" width="30px"><span>大蓝</span> 👍（17） 💬（0）<div>学的时候不曾感觉，学完一个月，会发现这个课程带给我一个知识树这样子的知识结构，感谢！
我现在又回来继续看看知识哪里遗漏的</div>2020-03-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/f8/8a/f7e7fd54.jpg" width="30px"><span>君自兰芳</span> 👍（4） 💬（5）<div>“目前浏览器中对于同一个域名，默认允许同时建立 6 个 TCP 持久连接”

我又有个疑问了⊙∀⊙！，每个TCP发送请求的数量有上限吗？上限是多少？

什么时候需要开启一个新的TCP连接？什么情况下可以关闭一个TCP连接？</div>2020-11-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/e7/70/b90806a7.jpg" width="30px"><span>墨杰</span> 👍（4） 💬（4）<div>上传文件给服务器的HTTP请求和其它请求有什么不一样？如何获取当前上传文件的文件名？谢谢！</div>2019-10-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/93/ff/74bbaa7b.jpg" width="30px"><span>大可</span> 👍（3） 💬（0）<div>作为一名后端 觉得老师把浏览器讲的很明白</div>2021-04-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/ee/28/c04a0c83.jpg" width="30px"><span>小炭</span> 👍（2） 💬（2）<div>为什么HTML 格式的文件，使用 ASCII 字节码来传输是最合适的？</div>2020-10-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/22/70/ab911260.jpg" width="30px"><span>太白北路</span> 👍（2） 💬（0）<div>安全问题，传输内容是不加密的</div>2020-08-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/b3/2f/867b94d8.jpg" width="30px"><span>4!!</span> 👍（2） 💬（3）<div>使用哪个版本的http协议是由谁决定的？浏览器和服务器自动设置的？还是由服务器设置的？</div>2020-02-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/b9/5e/a8f6f7db.jpg" width="30px"><span>Ming</span> 👍（2） 💬（1）<div>http1.1 虚拟主机支持那部分，host 可以继续展开来啊。“虚拟主机使得多个域名可以映射到同一IP”，跟“针对不同域名IP做不同处理”，感觉没get到内涵啊</div>2019-10-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/0e/94/4a2bb019.jpg" width="30px"><span>Lorin</span> 👍（1） 💬（1）<div>同一个TCP连接中最多支持多少个HTTP请求呢？</div>2020-05-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/b8/79/a4dbe9ee.jpg" width="30px"><span>blueBean</span> 👍（1） 💬（4）<div>Chunk transfer 机制，应该是每个数据块发送时会附上下个数据块的长度吧？</div>2020-03-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/44/0e/ce14b7d3.jpg" width="30px"><span>-_-|||</span> 👍（1） 💬（0）<div>同一个域名默认最多6个tcp链接，每个链接每次只能维护一个http链接，这样数据的交换就又局限；明文传输容易被攻击。不能像app那样接收推送信息。</div>2019-12-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/a7/8d/50c0ab72.jpg" width="30px"><span>I\O</span> 👍（1） 💬（0）<div>1.不能主动推送数据到客户端
2.同一域名连接数有限制</div>2019-11-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/5f/80/51269d88.jpg" width="30px"><span>Hurry</span> 👍（1） 💬（0）<div>1.HTTP队头阻塞 2.明文传输 3.HTTP header，特别是 cookie 过大。4.与浏览器并发tcp连接被限制在 6</div>2019-10-20</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJS0jwYKhjm1hq96go05J4R7XDd5FFXXaoyIfX9TgoI3mLURAu2ET72SvYGM2iaET7IV3WDvMibAVfw/132" width="30px"><span>tokey</span> 👍（1） 💬（0）<div>1、对头阻塞
2、容易遭受dos攻击
3、对小文件传输效率低</div>2019-10-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/23/6c/785d9cd3.jpg" width="30px"><span>Snooker</span> 👍（0） 💬（0）<div>1.基于消息的一发一收，存在应用层队头阻塞问题，还有不支持服务端主动推送；
2.头部字段未压缩，传输效率有待提高</div>2024-07-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg" width="30px"><span>ifelse</span> 👍（0） 💬（0）<div>学习打卡</div>2024-05-17</li><br/><li><img src="" width="30px"><span>Geek_bb591c</span> 👍（0） 💬（0）<div>老师有没有遇到在Chrome浏览器下，一下子发起十几个同一个请求，会偶到其中几个请求一直pending，也不报错，后端也没收到数据。在埋点日志上报的场景</div>2024-03-08</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLZlG6Z7ibxbJwTIr40GuFkK0jtiaicyqHXcZ11rmMJVfyChCKMZ34tXx0VficVREblOuI7u2SMvticypA/132" width="30px"><span>dxp</span> 👍（0） 💬（0）<div>只能是客户端发起，一来一往。</div>2021-07-14</li><br/><li><img src="https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKUw7N2IzBsOmfGtA2J4mOoxdthicpmJWutxFfficVlERkSqURowMojdbTQ4jNMqbadPlxkkQjdXd3g/132" width="30px"><span>SXL</span> 👍（0） 💬（1）<div>1如果当前页面手动刷新，TCP持久连接会不会断开？
</div>2021-03-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/f9/c0/20b4a205.jpg" width="30px"><span>啊哈哈</span> 👍（0） 💬（0）<div>1. TCP 数量限制
2. 队头阻塞</div>2020-12-21</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/yyibGRYCArsUNBfCAEAibua09Yb9D5AdO8TkCmXymhAepibqmlz0hzg06ggBLxyvXicnjqFVGr7zYF0rQoZ0aXCBAg/132" width="30px"><span>james</span> 👍（0） 💬（1）<div>对头阻塞问题没有从根本上解决
</div>2020-06-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/a3/ea/53333dd5.jpg" width="30px"><span>HoSalt</span> 👍（0） 💬（0）<div>编码格式与文件传输的字节流之间有什么关系吗？</div>2020-04-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/18/65/35361f02.jpg" width="30px"><span>潇潇雨歇</span> 👍（0） 💬（0）<div>不安全</div>2020-01-14</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoaxy8ibvXITdMcXFfd5O5E7Epq8MG5z1OBhO7MQXTfbcpA0fpcsIxkCHyUZ5ZSrj3spZpAQxEC9GA/132" width="30px"><span>非洲大地我最凶</span> 👍（0） 💬（6）<div>Chunk transfer 机制来解决这个问题，服务器会将数据分割成若干个任意大小的数据块，每个数据块发送时会附上上个数据块的长度，附加上上个数据块长度的意义在哪呢，为啥不是附加上下个数据块的长度</div>2019-12-27</li><br/>
</ul>