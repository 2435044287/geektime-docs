你好，我是陈旭。

上一讲我们用下面这图定义了被测功能。

![](https://static001.geekbang.org/resource/image/20/10/20e06b19b290cd365yy374608704f810.jpg?wh=10666x2238)

我们抓住了触发功能这个关键环节，由于GUI中的各个功能的触发，往往是通过事件来驱动，于是，我们通过跟踪事件，顺藤摸瓜找出被测功能，并采用事件链的形式来标记一个被测功能。在多个事件链中，将相同事件叠在一起，多个事件链就可以组成了一棵事件树。

![](https://static001.geekbang.org/resource/image/ey/9a/eyy6b23a023bfe5bf8c214bc198c2f9a.jpg?wh=10666x4735)

在这个推理过程中，我为了可以流畅地讲解这个过程，我故意遗漏了一个重要的技术实现难点，也就是上一讲的思考题：**如何分析事件处理逻辑。**这一讲我们就来解决这个问题，并更进一步，给出如何检测副作用的方法。

## 如何分析事件处理逻辑

为了找到事件链的下一级，我们势必要去分析处理上一级事件的逻辑，这样才能从处理逻辑中找出它是否发送了下一级事件，以及事件名是啥，这样才能一级一级找下去。在传统纯代码实现的App中，事件处理逻辑就是一个代码块。而在低代码实现的App中，处理事件的方式比纯代码要更加复杂，不仅有纯代码的处理方式，还有各种一键绑定、自动更新等非代码处理。我们分开讨论。

要准确地分析一整块代码（包含函数、类定义等任何语法），正则表达式是搞不定的，更不要说最基础的字符串搜索。**唯有祭出** **AST** **大法了。**

AST，全称为抽象语法树（Abstract Syntax Tree），是在计算机科学中广泛使用的一种数据结构。它用于表示程序代码的语法结构，以便更方便地进行分析和处理。AST由节点组成，每个节点代表程序代码中的一个语法结构。节点之间通过父子关系相连，形成树的结构。树的根节点代表整个程序的起点，而叶节点代表最小的语法单元。
<div><strong>精选留言（1）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg" width="30px"><span>ifelse</span> 👍（0） 💬（0）<div>学习打卡</div>2023-07-30</li><br/>
</ul>