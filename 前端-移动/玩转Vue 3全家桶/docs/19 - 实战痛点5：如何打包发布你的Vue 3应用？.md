你好，我是大圣。

在实战痛点4这一讲中，我们一起学习了Vue 3项目的性能优化策略。今天，我们来聊一下项目上线前的最后一步，就是如何把开发好的代码部署到线上。

对于这个问题，你可能脱口而出：“使用`npm run build`就好了呀”。这样做只是在本地把代码打包，如果想要在线上也可以访问这些代码，那么还需要加上部署的过程。所以在下面，我先给你介绍一下当前这个时代的前端代码在部署的时候，有哪些难点和问题需要处理。

## 代码部署难点

在jQuery时代之前，前端项目中所有的内容都是一些简单的静态资源。那个时候，网站还没有部署的概念，网站上线前，我们直接把开发完的项目打包发给运维，再由运维把代码直接上传到服务器的网站根目录下解压缩，这样就完成了项目的部署。

后来的jQuery时代，项目的入口页面被后端管理，模板部署到了后端，CSS、JavaScript和图片等静态资源依然是打包到后端之后，再解压处理。但现在，我们对前端的性能和稳定性的要求也越来越高，jQuery时代的那种简单的部署模式就不足以应对性能优化、持续部署等一系列的情境。

现在前端所处的时代，我们主要会面临后面这些代码部署难点：首先是，如何高效地利用项目中的文件缓存；然后是，如何能够让整个项目的上线部署过程自动化，尽可能避免人力的介入，从而提高上线的稳定性；最后，项目上线之后，如果发现有重大Bug，我们就要考虑如何尽快回滚代码。
<div><strong>精选留言（28）</strong></div><ul>
<li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/ry20aMia1d7Tmtx0UiapibTuzmnzv3Ih5Sz2apEWSUlPC8lib0ic5oJsegEA9tZDoawrl1NdCryHohldyv9iaV5haviaw/132" width="30px"><span>海贼刺客</span> 👍（5） 💬（1）<div>自动化部署在哪可以学</div>2021-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/65/35/92b0f8ef.jpg" width="30px"><span>🍁</span> 👍（2） 💬（4）<div>老师，像actions这种部署，是不是只能用于个人项目。比如公司用gitlib还能用actions这种么</div>2021-12-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/e8/f5/d851eb46.jpg" width="30px"><span>哎哟迪奥</span> 👍（1） 💬（1）<div>搞个部署平台，一键部署，还能监控，比如jekins持续集成。</div>2021-12-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2a/82/c6/983e6c13.jpg" width="30px"><span>搁浅</span> 👍（0） 💬（1）<div>大圣老师我只想说后面有没有nuxt.ha部署 因为这个好多坑呀！</div>2021-12-13</li><br/><li><img src="" width="30px"><span>Geek_bb9113</span> 👍（0） 💬（1）<div>项目部署的我自己是学习公司的，走的是阿里云的云效自动化部署，每次都是一键发布，感觉还是挺好的。</div>2021-12-11</li><br/><li><img src="" width="30px"><span>一块小砖头</span> 👍（0） 💬（2）<div>处理缓存  讲到了么？</div>2021-12-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/41/72/ecc49429.jpg" width="30px"><span>一颗花椒</span> 👍（0） 💬（1）<div>这一讲是视频操作演示就好了</div>2021-12-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/d0/bb/86e86d71.jpg" width="30px"><span>于良骥</span> 👍（0） 💬（2）<div>大圣老师，vite打包之后生产环境报错应该怎么调试呢？</div>2021-12-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/fc/e6/2cff4a89.jpg" width="30px"><span>醉月</span> 👍（0） 💬（1）<div>又一节可以展开的课</div>2021-12-01</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/yyibGRYCArsUNBfCAEAibua09Yb9D5AdO8TkCmXymhAepibqmlz0hzg06ggBLxyvXicnjqFVGr7zYF0rQoZ0aXCBAg/132" width="30px"><span>james</span> 👍（0） 💬（1）<div>Vite 工程，生产环境打包耗时有点久（7～8分钟），老师有什么优化方案建议的吗？</div>2021-12-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/13/38/fcd05270.jpg" width="30px"><span>轻度</span> 👍（0） 💬（1）<div>又学到了许多，后面有没有关于怎么自己构建v3组件库并发布到npm相关的课程吗</div>2021-12-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/5b/9e/a8dec12d.jpg" width="30px"><span>cwang</span> 👍（9） 💬（4）<div>这节课得好好琢磨琢磨，因为就如大圣老师说的，项目上线部署很重要，但确实大家容易忽略的一面。有时候，我们辛苦开发，不就是最后上线给用户使用嘛，如果最后一个环节做不好，那前面的99步都是失败，且不被认可的。

我自己的项目打包经历，算是经历了这样的一个“草莽时代”。以前写.net的，views全在asp.net模板里面，然后mvc架构提供model和controller支持。最后通过服务器上的IIS完成项目入口设置，部署工作。

再后来，我转型大前端，就是大圣老师讲得，先本地项目打包，然后发给服务器管理员。他打包解压后通知我，我们在测试。

现在的这家公司，前端项目独立部署了，但依然是把自己负责的那块上传代码仓库，负责人审查代码后，再在远程服务器拉取最新分支代码，构建编译完成项目上线工作。

通过今天的讲解，我们的水平依然处于“草莽”时代呀！这就特别期待大圣老师的视频讲解了。🤙🤙🤙</div>2021-12-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/cd/00/998ad719.jpg" width="30px"><span>Whisper</span> 👍（6） 💬（2）<div>只想说一句：买大圣的课太值了！期待后续录屏实操演示！</div>2021-12-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/a1/89/3c865bd0.jpg" width="30px"><span>T1M</span> 👍（1） 💬（0）<div>这一讲确实戳到了实战中项目上线问题的痛点。期待能看到更加详细的视频讲解。
</div>2021-12-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/fc/80/21d67b9b.jpg" width="30px"><span>二狗</span> 👍（0） 💬（0）<div>请问 提供客户私有化内网部署更新有啥好的解决方案</div>2023-08-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/94/6a/d40f64ec.jpg" width="30px"><span>尝试者说</span> 👍（0） 💬（0）<div>老师你还出了那些课程，我全部都要买</div>2023-05-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/40/b7/5e2b0bc2.jpg" width="30px"><span>________egg</span> 👍（0） 💬（0）<div>发布上去是直接覆盖之前的版本吗?</div>2023-03-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/4b/98/20ff3f6a.jpg" width="30px"><span>这个需求做不了</span> 👍（0） 💬（0）<div>你们的项目部署在github上？？？vuecli的部署路径也没讲呢？？相对路径和绝对路径??</div>2022-07-10</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2ibcQVCzwThRQWhAVVDHjiaaCOXqrYKC2qlM9iaAVrSZcpJmPAPBHoPiapG9pPYbjf4NtvNOVfrLOtw/132" width="30px"><span>MIKE LIU</span> 👍（0） 💬（1）<div>老师，请教一下，怎么样能将访问github的方式快一些，本地配置了&#47;etc&#47;hosts文件对应的github地址，还是很慢哦。一定要翻墙吗</div>2022-06-05</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/VzjUV1Io39wvVzLpdyF2ibIodS1JpTiaDKosSQSWDMgSjhxrWUSQYwUzK3cSeJW5Zz3zwLlDnyKcX1QAib9TCcvAw/132" width="30px"><span>Geek_e2c59e</span> 👍（0） 💬（0）<div>如何高效的利用项目中的文件缓存，似乎没有说</div>2022-06-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/9b/9a/7c87614b.jpg" width="30px"><span>YK菌</span> 👍（0） 💬（0）<div>收获满满~ 刚好最近也在用vuepress写博客，可以试试github actions的自动化部署了</div>2022-04-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/11/fc/80256cc8.jpg" width="30px"><span>心若水，则长安</span> 👍（0） 💬（0）<div>这是一个公司体系性的问题，前端、后端、测试、运维等等都在这个体系中，作为一名普通开发者我们能做的很少，但也需要了解这个体系的结构以及适当给出优化建议</div>2022-02-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/ce/91/3675b275.jpg" width="30px"><span>夹克</span> 👍（0） 💬（0）<div>部署实际上并非是单一的前端范畴，而是一个项目级别的话题，不仅仅包括前端，还有后端，测试灰度等
推荐看看devops 流程，先了解大致的内功心法，然后结合实际项目的特点因地制宜的采取优化措施</div>2022-01-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/20/5c/d9/f92794ed.jpg" width="30px"><span>王大丫</span> 👍（0） 💬（0）<div>这种带文档讲解很清晰，讲的也很细致，期待后边的视屏。</div>2021-12-04</li><br/><li><img src="" width="30px"><span>Geek_d47f78</span> 👍（0） 💬（0）<div>平时工作中很少接触到，期待后面的视频</div>2021-12-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/3c/1c/47e5b7aa.jpg" width="30px"><span>Johnson</span> 👍（0） 💬（0）<div>这个确实是实战痛点，对于软件项目来说，能实现自动化部署和需要时回退，这个太重要了</div>2021-12-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/3f/a8/8da58e53.jpg" width="30px"><span>海阔天空</span> 👍（0） 💬（0）<div>老师说得很好，不同版本的代码分开打包，互不干涉。我们现在的项目中也在逐步引用微前端技术。整合前端架构。</div>2021-12-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/cd/ed/825d84ee.jpg" width="30px"><span>费城的二鹏</span> 👍（0） 💬（0）<div>我们的部署只支持测试地址与生产地址，不支持泳道环境，也就不能针对特性分支进行测试。</div>2021-12-01</li><br/>
</ul>