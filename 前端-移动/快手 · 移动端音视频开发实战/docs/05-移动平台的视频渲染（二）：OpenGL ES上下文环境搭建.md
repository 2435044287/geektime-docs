你好，我是展晓凯。今天我们来继续学习移动平台的视频渲染。

[上一节课](https://time.geekbang.org/column/article/545953)，我们使用OpenGL ES提供给开发者的接口，创建出了一个GLProgram，但是如果让这个GLProgram运行起来还需要有一个上下文环境来支撑。由于OpenGL ES一开始就是为跨平台设计的，所以它本身并不承担窗口管理以及上下文环境构建的职责，这个职责需要由各自的平台来承担。

Android平台使用的是EGL，EGL是Khronos创建的一个框架，用来给OpenGL的输出与设备的屏幕搭建起一个桥梁。EGL的工作机制是双缓冲模式，也就是有一个Back Frame Buffer和一个Front Frame Buffer，正常绘制操作的目标都是Back Frame Buffer，渲染完毕之后，调用eglSwapBuffer这个API，会将绘制完毕的Back Frame Buffer与当前的Front Frame Buffer进行交换，然后显示出来。EGL承担了为OpenGL提供上下文环境以及窗口管理的职责。

iOS平台使用的是EAGL，与EGL的双缓冲机制比较类似，iOS平台也不允许我们直接渲染到屏幕上，而是渲染到一个叫renderBuffer的对象上。这个对象你可以理解为一个特殊的FrameBuffer，最终再调用EAGLContext的presentRenderBuffer方法，就可以将渲染结果输出到屏幕上去了。
<div><strong>精选留言（8）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/11/1d/64/52a5863b.jpg" width="30px"><span>大土豆</span> 👍（3） 💬（1）<div>我感觉这课程小白是听不懂了。我这种之前把EGL的代码当成八股文和模板的，倒是又重新理解了一遍。</div>2022-08-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/4f/f4/55081288.jpg" width="30px"><span>小跑猫</span> 👍（1） 💬（1）<div>有一个困惑请教，GLSurfaceview本身实现了一套opengl上下文，如果再把它的surface传到native去关联ANAtiveWindow，并在native层创建上下文之后进行渲染，这两套上下文会不会冲突？</div>2022-08-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/28/3a/df/f0f1ee84.jpg" width="30px"><span>我的無力雙臂</span> 👍（1） 💬（1）<div>demo的示例代码有链接吗</div>2022-08-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/90/5d/a177df1e.jpg" width="30px"><span>Aaron</span> 👍（0） 💬（1）<div>老师，请问有源代码的链接吗</div>2022-10-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/b0/2b/87aff702.jpg" width="30px"><span>一个正直的小龙猫</span> 👍（0） 💬（1）<div>这节课看不懂了，想问一个其他相关的问题，iOS平台使用metal 会不会更合适一些？</div>2022-09-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（0） 💬（1）<div>请教老师两个问题：
Q1：EGL和OpenGL ES是什么关系？
EGL是OpenGL ES的一部分吗？比如，EGL是OpenGL ES的底层部分。或者，两者是相互独立的两个实体？
Q2：能否提供可运行的源代码？我懂一点安卓，能用AS创建简单的工程，所以最好是安卓版本，基于AndroidStudio的源代码，能运行后产生一个简单的结果即可，比如打印一句话等。文章写得很好，很流畅，逻辑清晰，但没有实际的操作就好像少了一点什么。</div>2022-08-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/29/72/515e8867.jpg" width="30px"><span>王厂长</span> 👍（0） 💬（1）<div>有example代码吗，这个很重要啊</div>2022-08-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/07/8d/3e76560f.jpg" width="30px"><span>王建峰</span> 👍（0） 💬（0）<div>提到渲染后的显示的过程，有点不太明白，我们渲染后的图形，如果有多个图层进行合成，合成应该在哪个地方做呢，谁来执行这部分的程序？合成后的图像会写到backing buffer，然后设置成 fronting buffer 到显示屏，可以这样做嘛？</div>2023-08-27</li><br/>
</ul>