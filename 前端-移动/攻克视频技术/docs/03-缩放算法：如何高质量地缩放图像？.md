你好，我是李江。

今天，我们一起来聊聊图像的缩放算法。图像的缩放算法在我们的日常生活中使用非常频繁，只是可能你没有留意到。举个例子，你使用网页或者播放器看电影的时候，经常会开启全屏或者退出全屏，电影的播放画面就会变大，或者变小。这个过程里面就会用到图像的缩放算法。

事实上，只要视频的原始分辨率和播放窗口的大小不一致，就需要通过缩放处理来使得视频画面适应窗口的大小。比如说，电影分辨率是1080P，播放器的窗口大小是720P，则需要将电影画面从1080P缩小到720P再播放。如果你点击全屏播放，播放窗口变成了4K，则需要将电影画面做放大处理，即放大到4K之后再播放。这就是一个非常典型的图像缩放的例子。

在视频开发的过程中，图像的缩放就更多了。下面我列举3种用到图像缩放的情形：

- 情形1：播放窗口与原始图像分辨率不匹配的时候需要缩放。这和我刚才举的例子是一样的情况。
- 情形2：我们在线观看视频时会有多种分辨率可以选择，即需要在一个图像分辨率的基础上缩放出多种不同尺寸的图像出来做编码，并保存多个不同分辨率的视频文件。
- 情形3：RTC场景，有的时候我们需要根据网络状况实时调节视频通话的分辨率。这个也是需要缩放算法来完成的。
<div><strong>精选留言（22）</strong></div><ul>
<li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJV27QOK57cdpdh3E4hbArCOlccdtjCyWooF9fhjeSKAMo9SN1v9RODkrZUZD4RejjbdsqU2FIeMA/132" width="30px"><span>西钾钾</span> 👍（6） 💬（2）<div>补0或者是填充最边上的像素的值</div>2021-11-26</li><br/><li><img src="" width="30px"><span>Geek_cbfa0a</span> 👍（5） 💬（1）<div>这个图像的缩放原理，是否就是业务开发中所说的图片的重采样过程呢，放大图像称为上采样，缩小图像称为下采样？</div>2021-12-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/65/94/829f321f.jpg" width="30px"><span>天亮了</span> 👍（2） 💬（1）<div>缩放图像缩放处理常见的性能优化有哪些呢？比如 ffmpeg 似乎比其它库要快很多。</div>2021-12-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/88/cc/e1ba2379.jpg" width="30px"><span>一身龙骨</span> 👍（2） 💬（1）<div>个人觉得，不够像素点的，就用最近邻插值算法代替，简单快捷，而且图像上下边角的位置应该不是最重要的，清晰度不够也还能接受吧</div>2021-11-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/cf/c9/6881e913.jpg" width="30px"><span>白曦</span> 👍（1） 💬（1）<div>李老师，你好。我是视频基础小白，很幸运能上到你的课。我向请教的是:双线性插值计算中，从720p放大到1080p时，目标的(3，3)位置映射到原图像(2，2)时，还需要三次线性计算吗？因为(2，2)刚好在近邻的四个点(2，1)(1，2)(3，2)(2，3)的中心位置上上，m点和n点已经不存在了</div>2022-10-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/0e/96/eca820c7.jpg" width="30px"><span>李新</span> 👍（1） 💬（1）<div>这些插值算法是用于openGL 中的纹理过滤嘛？ 
https:&#47;&#47;learnopengl-cn.readthedocs.io&#47;zh&#47;latest&#47;01%20Getting%20started&#47;06%20Textures&#47;</div>2021-12-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/23/88/de/04784f86.jpg" width="30px"><span>ForwardsHao</span> 👍（1） 💬（1）<div>对于边缘和角落的点，以它为中心不够16个点的话：
1. 如果要补足16个点用双三次插值，可以将4*4的区块像够的方向上移动，比如计算(0.5,0.5)的点，16个像素可以选择原图里的(0 0)(0 1)(0 2)(0 3)......(3 0)(3 1)(3 2)(3 3)来计算，因为计算公式考虑了权重，所以理论上其实原图里的任意16个点都可以拿来放到这个公式里计算本位置的像素值
2. 要么就是不够16个像素的地方就换另外两种方法，因为是边缘2排的像素，如果对边缘要求不那么高可以降低一下算法准确度标准</div>2021-11-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2e/27/b4/df65c0f7.jpg" width="30px"><span>| ~浑蛋~</span> 👍（0） 💬（1）<div>lanczos算法的原理是咋样的</div>2022-11-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/04/c8/68263086.jpg" width="30px"><span>哈珀朋友</span> 👍（0） 💬（2）<div>
AI超分算法会讲吗？</div>2021-12-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/23/66/413c0bb5.jpg" width="30px"><span>LDxy</span> 👍（0） 💬（1）<div>手机上经常能见到那种全屏缩放的动画效果，还有在查看相册时，照片缩放的动画效果也是十分流畅的，要达到这种流畅程度，需要60帧每秒吗？也就是说每秒要进行60次全屏幕大小图像的缩放运算，这个运算量应该很大，为什么还能很流畅？</div>2021-12-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/26/99/cf6e1335.jpg" width="30px"><span>DK</span> 👍（0） 💬（1）<div>左上角的点对应的左上角已经没有了像素点，但是右下的像素点还是正常取值，所以需要用负数来均衡右下角的值进行平均值计算</div>2021-11-26</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Ikib5hH6AA9v1kJWp14ImL99HSv9XRmURK0IiaLAjm51dYbjicsgyXWwud3KjdweGtyd1SelMNb2HIsj9nzcAS0Sw/132" width="30px"><span>Geek_7de4c5</span> 👍（0） 💬（1）<div>不够的情况，取周围存在点的均值。将其补上。</div>2021-11-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/b4/05/49dfb810.jpg" width="30px"><span>mike</span> 👍（0） 💬（0）<div>线性插值计算公式不对, y1 和 y2 的系数应该互换才对</div>2024-10-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/31/a3/15/6d99cf21.jpg" width="30px"><span>louie</span> 👍（0） 💬（0）<div>720 到1080P的缩放中，三种算法有没有性能对比数据呢？</div>2023-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1a/06/38/ea1a4d7f.jpg" width="30px"><span>金刚</span> 👍（0） 💬（0）<div>我觉得还是找最近16个就好</div>2022-11-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2d/27/c5/d4d00da2.jpg" width="30px"><span>为了维护世界和平</span> 👍（0） 💬（0）<div>差值算法有没有源码可参考</div>2022-10-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/da/d0/75462190.jpg" width="30px"><span>麦客</span> 👍（0） 💬（0）<div>双三的最终结果是最终权重求和计算的，那不够的点是否都可以用映射点的像素代替，这样的话最终权不够的点都变为0，然后最终像素值由非0位决定</div>2022-07-17</li><br/><li><img src="" width="30px"><span>龚长华</span> 👍（0） 💬（0）<div>用它周围的像素填补。比如第一行的像素填充行， 第一列像素填充列等。</div>2022-05-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/9a/89/babe8b52.jpg" width="30px"><span>A君</span> 👍（0） 💬（0）<div>插值算法可以用来进行图像缩放：先把目标像素的坐标等比缩放得到原图中的坐标，再获取周围的像素通过最近插值、线性插值等算法来求像素值。插值算法的本质是加权求和计算。</div>2022-04-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/04/60/20c6a3f2.jpg" width="30px"><span>expecting</span> 👍（0） 💬（0）<div>左上角的点取第一行第一列填充，那左下角的就是最后一行最后一列填充吗？右上角、右下角也是同理吗？</div>2022-03-03</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/3fiaPu5EFhP1ODOLLGY89aQibwEeTicPlSN5lNCK2VEpRV3ZHN7Mt96sdia9RiajB9RagITBW3Oe7NuF6PBWkEbGuZQ/132" width="30px"><span>小爷</span> 👍（0） 💬（1）<div>情形 2：我们在线观看视频时会有多种分辨率可以选择，即需要在一个图像分辨率的基础上缩放出多种不同尺寸的图像出来做编码，并保存多个不同分辨率的视频文件。
李老师，关于情形2，想往自适应码流方向发展的话，多个不同分辨率视频文件的关键帧分布要求大致一致（80%的关键帧时间点能够一致），主要应该调ffmpeg x264的哪些参数呢
</div>2021-12-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/70/67/0c1359c2.jpg" width="30px"><span>qinsi</span> 👍（0） 💬（0）<div>gl里的叫法是clamp to edge</div>2021-12-04</li><br/>
</ul>