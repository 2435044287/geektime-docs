你好，我是陈航。

在上一篇文章中，我和你一起学习了文本、图片和按钮这3大经典组件在Flutter中的使用方法，以及如何在实际开发中根据不同的场景，去自定义展示样式。

文本、图片和按钮这些基本元素，需要进行排列组合，才能构成我们看到的UI视图。那么，当这些基本元素的排列布局超过屏幕显示尺寸（即超过一屏）时，我们就需要引入列表控件来展示视图的完整内容，并根据元素的多少进行自适应滚动展示。

这样的需求，在Android中是由ListView或RecyclerView实现的，在iOS中是用UITableView实现的；而在Flutter中，实现这种需求的则是列表控件ListView。

## ListView

在Flutter中，ListView可以沿一个方向（垂直或水平方向）来排列其所有子Widget，因此常被用于需要展示一组连续视图元素的场景，比如通信录、优惠券、商家列表等。

我们先来看看ListView怎么用。**ListView提供了一个默认构造函数ListView**，我们可以通过设置它的children参数，很方便地将所有的子Widget包含到ListView中。

不过，这种创建方式要求提前将所有子Widget一次性创建好，而不是等到它们真正在屏幕上需要显示时才创建，所以有一个很明显的缺点，就是性能不好。因此，**这种方式仅适用于列表中含有少量元素的场景**。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/11/1d/64/52a5863b.jpg" width="30px"><span>大土豆</span> 👍（11） 💬（3）<div>我想问的最关键的一点是，flutter的列表有重用的概念吗？1000条数据，是会渲染出1000个视图对象还是像Androd或者iOS原生的那样重用机制，就渲染屏幕当中的的视图对象</div>2019-07-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/34/01/30ca98e6.jpg" width="30px"><span>arronK</span> 👍（7） 💬（1）<div>1. cacheExtent
2. notification.metrics</div>2019-12-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/30/e8/6898e576.jpg" width="30px"><span>季末灬离殇</span> 👍（6） 💬（5）<div>double offsetY = scrollNotification.metrics.pixels;
滚动过程中通过偏移量更改isTop即可。</div>2019-07-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/1a/be/18c99af2.jpg" width="30px"><span>NASA</span> 👍（4） 💬（2）<div>希望每节能配有小demo，毕竟每个人水平都不同</div>2019-07-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/d0/1c/509e54ba.jpg" width="30px"><span>有妖气</span> 👍（3） 💬（1）<div>老师，NestedScrollView中body是一个customScrollview。这个customScrollview中包含一个listview，那么怎么知道listview已经滑动到了底部，目前想在内部的listview中做一个上拉刷新的操作。</div>2019-09-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg" width="30px"><span>许童童</span> 👍（2） 💬（4）<div>老师你好，CustomScrollView 的sliver还是不是特别理解，可以再给点参考资料吗？</div>2019-07-27</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/ODicJCxia34EqbeBCwQeyWxcc0F25RP9fnI1r3o1Nt7S3ibRCvQI6zUlUKORL0kZic0PmCGX912bCZ5ERXPE785ZTw/132" width="30px"><span>咖啡凉了</span> 👍（1） 💬（1）<div>    _controller.addListener(() {&#47;&#47; 为控制器注册滚动监听方法

      if(_controller.offset &gt; 1000) {&#47;&#47; 如果 ListView 已经向下滚动了 1000，则启用 Top 按钮

        setState(() {isToTop = true;});

      } else if(_controller.offset &lt; 300) {&#47;&#47; 如果 ListView 向下滚动距离不足 300，则禁用 Top 按钮

        setState(() {isToTop = false;});

      }

    });
这里的setstate在滚动中会一直重复调用吧，会不会影响性能呢</div>2019-09-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/fc/a2/7da62426.jpg" width="30px"><span>Dominic</span> 👍（1） 💬（2）<div>有没有完整的代码放github上，后端程序表示片段代码，运行不起来</div>2019-07-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/9e/3c/0e2a08b1.jpg" width="30px"><span>杨闯</span> 👍（1） 💬（2）<div>你好，我们现在需要在debug的时候引用一些库，而在release的时候不引用一些库，而这个库使用了fmdb，因此有以下两个问题
1、在dart代码中，如何通过判断来决定要不要将import这个库和使用这个库的相关方法，而现在不能完成编译。
2、如果将这个库放到dev_dependencies里面，在编译release的时候，这个库没有被引入进来，但是fmdb被引入进来了，怎么避免fmdb给引用进来，是哪里出现问题了吗，还是哪里需要进行特别的设置</div>2019-07-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/9d/f4/7d74c9bb.jpg" width="30px"><span>Longwei243</span> 👍（1） 💬（2）<div>这个sliver里面想要一个可折叠的多级列表有对应的控件吗？还是需要自己来实现一个</div>2019-07-28</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLEIsgI4ub1VOKWtVOfouAzSqx8Yt8ibQEsAnwNJsJHmuJzzpQqG79HullvYwpic8hgiclgON2GwXSjw/132" width="30px"><span>cv0cv0</span> 👍（0） 💬（1）<div>视差那个怎么设置滚动速度比率？</div>2019-12-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/93/7b/97d45363.jpg" width="30px"><span>狗子不要喝奶茶</span> 👍（0） 💬（1）<div>课后小作业的预加载：是否使用cacheExtent呢</div>2019-10-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/5a/e8/c31e06a8.jpg" width="30px"><span>赤茗</span> 👍（0） 💬（1）<div>问一下问什么ListView和SliverList（其他 list没试）为什么一定要以Scaffold作为根布局？我直接 return  CustomScrollView的话，只有SliverAppBar部分是正常的，下边的SliverList显示是错误的</div>2019-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/6c/56/07920099.jpg" width="30px"><span>微笑美男😄</span> 👍（0） 💬（1）<div>老师 ,separated 在分割线里面没法设置itemExtent 是吧
</div>2019-10-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/1d/25/c4cc1e9f.jpg" width="30px"><span>巫山老妖</span> 👍（0） 💬（1）<div>如果要用Flutter来实现ListView，其实可以讲的东西很多，比如item复用、item事件点击、下拉刷新实现，滚动底部刷新。</div>2019-10-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/67/4d/f0d1b920.jpg" width="30px"><span>钱钱钱我爱钱</span> 👍（0） 💬（1）<div>老师，我发现example里的ListView UI异常了，因为这里没办法上传图片，我写在了博客里。
https:&#47;&#47;blog.csdn.net&#47;aprilcuhk&#47;article&#47;details&#47;101520028
希望老师可以解答一下，谢谢！！！</div>2019-09-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/6a/01/d9cb531d.jpg" width="30px"><span>这得从我捡到一个鼠标垫开始说起</span> 👍（0） 💬（1）<div>cacheExtent是用这个参数实现预加载的对吧？</div>2019-08-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/e2/49/0c5eea4c.jpg" width="30px"><span>Geek_614bf3</span> 👍（0） 💬（1）<div>航哥把经典的iOS效果带入了flutter</div>2019-08-21</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIR6WDJVpJ103eeu54rLia1uhJO8sWUW1QJRZQqDCbgfSsSBYFWZFB7EleVmSUvZfhEbx6eLkzRhNA/132" width="30px"><span>右手边</span> 👍（0） 💬（1）<div>老师您好！会讲调试相关的内容吗？</div>2019-08-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/83/b2/e83dd93c.jpg" width="30px"><span>🌙</span> 👍（0） 💬（0）<div>如果我不需要这种效果呢？比如上滑图片马上消失，或者上滑时变换图片</div>2019-08-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/67/d1/1c69ad22.jpg" width="30px"><span>C</span> 👍（0） 💬（1）<div>为什么 ScrollNotification 滚动停止时回调 ScrollEndNotification 之后又回调了一次 UserScrollNotification 呢？</div>2019-08-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/83/b2/e83dd93c.jpg" width="30px"><span>🌙</span> 👍（0） 💬（2）<div>联动的操作在哪呢？是否是使用sliver就一定是这个效果？</div>2019-08-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/81/45/9aa91b75.jpg" width="30px"><span>矮个子先生😝</span> 👍（0） 💬（1）<div>onNotification监听回调方法的返回值bool有什么用呢,flutter文档注释不太理解,我返回true、false都会执行回调</div>2019-08-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/69/ec/df7fc14a.jpg" width="30px"><span>邓志强</span> 👍（0） 💬（1）<div>关于第一个问题，试了一下cacheExtent能提前加载设置的区域，不知道是不是这个答案。</div>2019-08-14</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/lQ1HcxQ49piaG5IImkt08ibkHk1GBY1lUSic2gQ9CbDE8UMhuYIUbmmSfke47XMyk0RyJEQT0vc47xGRaP0BpNQOw/132" width="30px"><span>Geek_60d7a7</span> 👍（0） 💬（2）<div>关于listview，官方demo在实现 item选中收藏功能时候，需要开发者额外维护一套item（状态）的数据，感觉略微麻烦些大家有什么解决办法么</div>2019-07-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/b6/18/ede273fe.jpg" width="30px"><span>ptlCoder</span> 👍（0） 💬（2）<div>listview 怎么去设置组头组尾，当每行row不一致的情况中 该怎么设置itembuild</div>2019-07-29</li><br/><li><img src="https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqr5ibqxYwcSgqPA7s49MZb1vEKKXT4mPTojwiclXkJf3ug26NuzTa6A5gbicR2rAUHdEkUAn13Rr2KQ/132" width="30px"><span>吴小安</span> 👍（0） 💬（1）<div>按照dart的语法这界面布局和控件一起会出现嵌套很深的代码，怎样可以写起来更优雅呢</div>2019-07-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/de/c7/26485903.jpg" width="30px"><span>Yolo七夜</span> 👍（0） 💬（5）<div>陈哥，我现在遇到了一个困扰我很久的问题，native工程调用flutter页面时，即使我设置了initialRoute为其他值，但flutter那边没能接收到，从而无法跳到我想要的页面，Google了一些资料，按照上面的说法也试过，还是无效，所以想咨询一下您，看是否能找到问题的答案（https:&#47;&#47;github.com&#47;flutter&#47;flutter&#47;issues&#47;27216</div>2019-07-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/23/74/e0b9807f.jpg" width="30px"><span>小米</span> 👍（0） 💬（2）<div>老师，架构方面会讲到吗？有没有相关开源项目可以推荐看一下的？</div>2019-07-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/4d/4a/e13779af.jpg" width="30px"><span>CoderAndy</span> 👍（1） 💬（0）<div>关于作者说的，为了性能，固定元素的高度。但是，如果列表中要有好几种元素，他们的高度各不相同，应该如何处理？</div>2022-09-07</li><br/>
</ul>