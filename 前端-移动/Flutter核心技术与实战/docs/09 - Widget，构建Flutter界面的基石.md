你好，我是陈航。

在前面的Flutter开发起步和Dart基础模块中，我和你一起学习了Flutter框架的整体架构与基本原理，分析了Flutter的项目结构和运行机制，并从Flutter开发角度介绍了Dart语言的基本设计思路，也通过和其他高级语言的类比深入认识了Dart的语法特性。

这些内容，是我们接下来系统学习构建Flutter应用的基础，可以帮助我们更好地掌握Flutter的核心概念和技术。

在第4篇文章“[Flutter区别于其他方案的关键技术是什么？](https://time.geekbang.org/column/article/105703)”中，我和你分享了一张来自Flutter官方的架构图，不难看出Widget是整个视图描述的基础。这张架构图很重要，所以我在这里又放了一次。

![](https://static001.geekbang.org/resource/image/ac/2f/ac7d1cec200f7ea7cb6cbab04eda252f.png?wh=2274%2A1186)

图1 Flutter架构图

备注：此图引自[Flutter System Overview](https://flutter.dev/docs/resources/technical-overview)

那么，Widget到底是什么呢？

Widget是Flutter功能的抽象描述，是视图的配置信息，同样也是数据的映射，是Flutter开发框架中最基本的概念。前端框架中常见的名词，比如视图（View）、视图控制器（View Controller）、活动（Activity）、应用（Application）、布局（Layout）等，在Flutter中都是Widget。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/ajNVdqHZLLBKSykSmNnspVs5OvAUGLecibeiczo7sQYJ4XoJXNa2jWUwvwiaHz8yM3iak0ErUSUIJrGfzNUJ7P79Rg/132" width="30px"><span>竹之同学</span> 👍（66） 💬（2）<div>如果用 Vue 来比喻的话，Widget 就是 Vue 的 template；Element 就是 virtual DOM；RenderObject 就是DOM，不知道这种想法对不？</div>2019-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/1d/64/52a5863b.jpg" width="30px"><span>大土豆</span> 👍（24） 💬（2）<div>React：JSX-&gt;虚拟DOM-&gt;浏览器DOM
React Native：JSX-&gt;虚拟DOM-&gt;Android&#47;iOS原生控件
flutter：Widget-&gt;Element（类似虚拟DOM，只是一种数据结构）-&gt; RenderObject 交给底层渲染
</div>2019-07-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/91/ed/a0d244bb.jpg" width="30px"><span>KrystalJake</span> 👍（13） 💬（3）<div>您好：
我看有的文档(flutter in action)会说一个Widget会对应多个Element，因为Element是根据Widget创建的，您的分享里说一个渲染点对应可能对应多个Widget，还是不太理解Widget，Element，RenderObject之间的关系，什么情况下一对一，一对多或多对一，希望能详细讲解一下，谢谢</div>2019-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/4f/15/463fcaf1.jpg" width="30px"><span>丁某某</span> 👍（10） 💬（1）<div>flutter 将Widget设计成不可变，怎么理解？</div>2019-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/83/e8/f726c635.jpg" width="30px"><span>加温后的啤酒</span> 👍（8） 💬（1）<div>在iOS中，UIView相当于Element，CALayer相当于renderObject。 老师 我的理解对吗？</div>2019-07-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/0b/a7/6ef32187.jpg" width="30px"><span>Keep-Moving</span> 👍（7） 💬（1）<div>文中提到的绘制和渲染的区别是什么呢？</div>2019-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/dc/77/05b119eb.jpg" width="30px"><span>Tony</span> 👍（4） 💬（1）<div>Element 则是 Widget 的一个实例化对象是什么含义</div>2019-09-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/3a/58/494a6aca.jpg" width="30px"><span>Paradise</span> 👍（4） 💬（1）<div>一个Widget可以对应多个Element，因为Widget是不可变的配置信息，而一个Element对应一个RenderObject</div>2019-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/9d/f4/7d74c9bb.jpg" width="30px"><span>Longwei243</span> 👍（3） 💬（1）<div>listview想要通过代码滑动到某个item有什么办法吗？item的高度都是不固定的</div>2019-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/49/ba/23c9246a.jpg" width="30px"><span>mαnajay</span> 👍（2） 💬（1）<div>我想问下 flutter 关于GPU 离屏渲染 这块有和iOS之类的不一样的地方吗？ 
比如圆角 ，阴影， mask ，不透明多层合并 等 处理</div>2019-07-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/6a/01/d9cb531d.jpg" width="30px"><span>这得从我捡到一个鼠标垫开始说起</span> 👍（1） 💬（3）<div>你是如何理解 Widget、Element 和 Render？
答：Widget描述了整个布局，从而构建出一棵树。flutter遍历这棵树的每一个widget，从而构造出对应的Element对象，Element对象再构造出对应的RenderObject对象。由于Widget是不可变的，而Element可变。每当Widget变化的时候，这个Widget会被重新创建，Element发现Widget重新创建后，就改变自身对应的部分同时也改变RenderObject对应的部分。通过阅读这篇文章，我的理解是，他们确实是一一对应的。</div>2019-08-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8c/18/7cbc34eb.jpg" width="30px"><span>davidzhou</span> 👍（1） 💬（1）<div>在iOS里面UIKit的UIView，对应widget，core animation的CALayer对应element，core graphics的context对应renderobject，不知道有没有理解到位</div>2019-07-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/da/66/5858322e.jpg" width="30px"><span>满大大</span> 👍（0） 💬（2）<div>RenderObjectWidget 本身并不负责这些对象的创建与更新，拿它有啥用啊</div>2019-11-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/89/a7/82827b76.jpg" width="30px"><span>outman</span> 👍（0） 💬（1）<div>请教个问题。RenderObjectWidget是通过RenderObject来进行布局绘制。那么继承StatefulWidget&#47;StatelessWidget的，是怎么进行布局绘制的呢，他们会创建ComponentElement，而不是RenderObjectElement，好像不会创建RenderObject。</div>2019-10-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/76/a7/374e86a7.jpg" width="30px"><span>欢乐的小马驹</span> 👍（0） 💬（1）<div>iOS中，大部分情况没有Widhet。但是NavigationBar对应Element，NavigationBarItem对应Widget。可以这样理解吗？老师</div>2019-10-13</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/XktNguBOU1CyXt2QoNtY6TAHnfA1QEqXZmdn7whTZggeKSiaibnbRwnHR1T1XqPDQrVJDbUicFw4bXBzlNby71a1g/132" width="30px"><span>夜色下云淡风轻</span> 👍（0） 💬（1）<div>有界面的Widget会生成Element，Element生成对应的RenderObject进行实际的布局绘制工作；而如果没有界面就不会生成Element自然也就没有RenderObject，Element和RenderObject必定是对应的这样理解对吗？</div>2019-09-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/2d/c9/0d8983f3.jpg" width="30px"><span>张简</span> 👍（0） 💬（1）<div>widget是数据的映射，数据来源于state(可变widget)和初始化数据(不可变widget)。可以这么理解吗？</div>2019-08-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/83/b2/e83dd93c.jpg" width="30px"><span>🌙</span> 👍（0） 💬（1）<div>widget是保存的控件的属性值吗？element是该控件对应的对象？能不能举个例子来说明一下，不是很懂</div>2019-08-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/58/27/1188e017.jpg" width="30px"><span>Egos</span> 👍（0） 💬（4）<div>Android 里面View 相当于Widget、Window 相当于Element、Surface 相当于RenderObject。</div>2019-07-19</li><br/><li><img src="https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqr5ibqxYwcSgqPA7s49MZb1vEKKXT4mPTojwiclXkJf3ug26NuzTa6A5gbicR2rAUHdEkUAn13Rr2KQ/132" width="30px"><span>吴小安</span> 👍（0） 💬（2）<div>如果 Widget 的配置数据发生了改变，那么持有该 Widget 的 Element 节点也会被标记为 dirty。 
widget按照文中所说widget是被element持有，那widget变化了是怎样找到对应的element？widget也持有element？</div>2019-07-18</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoibW0Cougnv3Hjl8n1EWoUHloXu5lMicuPm1FcJ0qyXWEaqwXv4Z09ARaeDRicbicL9RTIXnoNARibSxw/132" width="30px"><span>mq</span> 👍（0） 💬（1）<div>数据驱动UI构建的话，感觉数据与UI层耦合程度会很高，是不是很难进行重用界面？如果有一个界面几乎一样，但是数据不一样的话是不是要做重复的UI？</div>2019-07-18</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoibW0Cougnv3Hjl8n1EWoUHloXu5lMicuPm1FcJ0qyXWEaqwXv4Z09ARaeDRicbicL9RTIXnoNARibSxw/132" width="30px"><span>mq</span> 👍（0） 💬（1）<div>widget的渲染成本很低，意思是不是说ListView中类似的Cell可以不用进行重用了？</div>2019-07-18</li><br/><li><img src="" width="30px"><span>Miracle_</span> 👍（0） 💬（1）<div>有一点不理解，在Android中布局叠加嵌套会影响绘制性能，为什么Flutter中叠加不会呢？</div>2019-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/56/b0/5f5ec445.jpg" width="30px"><span>六号先生117</span> 👍（17） 💬（0）<div>推荐一篇好文，读完之后回头再翻这一篇很容易理解了。https:&#47;&#47;mp.weixin.qq.com&#47;s&#47;6ckRnyAALbCsXfZu56kTDw</div>2020-05-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/04/d8/21885ced.jpg" width="30px"><span>puppy_love</span> 👍（13） 💬（0）<div>flutter渲染原理相关文章看了太多了，但是大部分都是根据图一的flutter架构图重复描述（就好像Android的架构图反复叙述没有意义），刚开始看到这张图的时候以为又是一篇雷同文章，没想到后面的阐述这么清晰生动，让我对flutter的渲染原理有了一个立体的理解，也对flutter更有信心了</div>2019-07-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/a0/88/a4ffd85e.jpg" width="30px"><span>樊不烦</span> 👍（12） 💬（0）<div>在iOS中，感觉没有Widget对应的概念，它更像是每个UIView控件中的属性，而Element就相当于UIView，RenderObject就像是CALayer。因为Widget是只读的所以当我们修改某一属性的时候就会重新生成一个Widget，然后在对应的Element中去更新，就相当于更新UIView中的属性，然后在通过RenderObject也就是类似于CALayer的去重新计算和布局。请问老师不知道我理解的是否有偏差</div>2020-01-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/87/66/31629628.jpg" width="30px"><span>MaO</span> 👍（1） 💬（0）<div>如果 Widget 的配置数据发生了改变，那么持有该 Widget 的 Element 节点也会被标记为 dirty。在下一个周期的绘制时，Flutter 就会触发 Element 树的更新，并使用最新的 Widget 数据更新自身以及关联的 RenderObject 对象

-----？
这个知识点有更详细的参考资料吗？</div>2019-12-29</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEK5icO2A4K7HYTYfQoagTz7VbtgxfS2ibBqLnKVWwQZgsePibZWFvFJEhPT8BtpQSaFx9IEodyp6c0dw/132" width="30px"><span>Geek_jg3r26</span> 👍（0） 💬（0）<div>类似iOS中 cleanmemory 和dirtymemory的概念
</div>2024-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8f/c9/833d5060.jpg" width="30px"><span>玉皇大亮</span> 👍（0） 💬（0）<div>来自于 ChatGPT:

在 Flutter 中，Widget、Element 和 RenderObject 是构建 UI 的三个核心概念，并且它们是紧密相连但不是一一对应的。

Widget: Widget 是 Flutter 中用于描述用户界面部分的不可变配置数据。它们类似于 Android 中的 View 或 iOS 中的 UIView 的概念，但与之不同的是，Widget 本身并不是 UI 控件，而是对 UI 控件的描述。在 Web 开发中，Widget 可以看作是 DOM 节点的声明。Widgets 是声明式的，它们定义了应该展示什么。当 Widget 的状态改变时，Flutter 框架会创建一个新的 Widget 实例。

Element: Element 是 Widget 在渲染树中的实例。每一个 Element 对象都是一个特定类型的 Widget 的具体化。它们是 Widget 树到 RenderObject 树的桥梁。在 Android 或 iOS 中，没有直接对应的概念，但可以把 Element 想象成是 View 或 UIView 的控制器（Controller），它持有 Widget 的配置并且负责组织 RenderObject 的创建和更新。在 Web 开发中，Element 对应于 DOM 节点的实际实例。

RenderObject: RenderObject 是用于在屏幕上绘制内容的对象。它定义了布局、绘制和命中测试的算法。每个 RenderObject 都对应着屏幕上的一部分，并且与其他 RenderObject 协作以构建 UI。在 Android 中，这个概念类似于 Canvas 上的绘制操作，而在 iOS 中，则类似于 CALayer。在 Web 开发中，RenderObject 可以理解为浏览器的渲染引擎最终处理和渲染的像素。

Widget、Element 和 RenderObject 之间的关系是：

每个 Widget 都可以对应一个或多个 Element，这取决于 Widget 的类型。例如，StatelessWidget 和 StatefulWidget 的实例在树中通常只对应一个 Element，而像 ListView 这样的组合 Widget 可能对应多个 Element。

每个 Element 都对应一个 Widget，但并非所有 Element 都有一个 RenderObject。只有继承自 RenderObjectWidget 的 Widget 会创建一个 RenderObject，如 Container、Text 等。

每个 RenderObject 都对应一个 Element。

总的来说，在 Flutter 中，Widget 定义了配置，Element 代表了 Widget 在树中的具体化，并且管理了 Widget 的生命周期和状态，而 RenderObject 负责实际的布局和绘制工作。这个分层设计使得 Flutter 能够高效地更新 UI，并且保持代码的灵活性和可扩展性。</div>2024-02-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/2c/9f/265106fb.jpg" width="30px"><span>Geek_自来也大人</span> 👍（0） 💬（0）<div>复习复习</div>2023-10-14</li><br/>
</ul>