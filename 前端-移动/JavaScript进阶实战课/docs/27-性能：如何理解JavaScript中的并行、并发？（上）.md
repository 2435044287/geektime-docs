你好，我是石川。

在上一个单元，我们在JS之道的编程模式和JS之法的语法、算法的基础上，又学习了JS之术的设计模式，从今天开始，我们将开启JS之术非功能性优化篇。从前面的学习中，我们可以看到，无论是编程模式、算法还是设计模式都不是独立存在，而是一环扣一环的。那我们今天要讲到的并行、并发，其实也是延续上一讲提到的异步编程模式。

所以，今天，就让我们了解下并行、并发和异步编程的关系，以及多线程开发在JS中的实现。

## 线程vs进程、并行vs并发

在说到JavaScript中的并发和并行前，我们先来看看程序、线程和进程之间的关系。**在一个程序当中，可以有多个进程。在一个进程里，也可以有多个线程。**内存在进程间是不共享的，而在线程里，是可以共享的。通过下图，你可以有更直观的理解。

![图片](https://static001.geekbang.org/resource/image/0c/19/0c00b9d93ca190b61495a1990f2a1d19.jpeg?wh=1920x1080)

并发是**同一时间段**进行的任务，而并行是两个在**同一时刻**进行的任务。除非是多核CPU，否则如果只有一个CPU的话，多线程本身并不支持并行，而只能通过线程间的切换执行来做到并发。从下图中，你可以对并发和并行有更直观的认识。

![图片](https://static001.geekbang.org/resource/image/24/1a/24f9dc7be10a7f4562662278d28cd41a.jpeg?wh=1920x1080)

## 前后端语言如何支持线程并行开发

如果单从语言的层面来看，JavaScript本身没有线程的规范，也没有内置的对外暴露给开发者用来创建线程的接口。所以JavaScript本身的执行是单线程的，也就是说JavaScript的执行环境中只有一个虚机、指令指针和垃圾回收器。即使是在不同的 **realms** 中，如浏览器端不同的iframe或服务器端不同的context中，也都只有一条JavaScript指令在同一时间内执行。以此我们可以看出，JavaScript本身并不是多线程友好的。