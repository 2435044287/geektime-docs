对于很多从事 JavaScript 开发的同学来说，基本都认为 JavaScript 是专门做页面控制的。如果用 JavaScript 做音视频处理，那真是很难想象的事儿。你可能首先想到的问题是：JavaScript或者浏览器的性能跟得上吗？

而 Google 却不这么认为。 Google 就是要做一些常人无法想象，又难以理解的事情，否则它就不是 Google 了。

“**浏览器 + WebRTC**”就是 Google 给出的答案。2011年，Google 创立了 WebRTC 项目，其愿景就是可以在浏览器之间快速地实现音视频通信。

随着 WebRTC 1.0 规范的推出，现在主流浏览器Chrome、Firefox、Safari以及 Edge 都已经支持了WebRTC库。换句话说，**在这些浏览器之间进行实时音视频通信已经很成熟了**。

下面我就通过讲解JavaScript/浏览器访问电脑上的音视频设备，向你展示通过现代浏览器访问音视频设备是何其简单。

## WebRTC处理过程

在正式讲解如何通过浏览器采集音视频数据之前，我先向你介绍一下 WebRTC 实现一对一音视频实时通话的整个处理过程。对这个过程的了解，可以帮助你在阅读文章时，能清楚明了地知道所阅读的这篇文章、所要学习的知识点在整个处理过程中的位置。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/f1/9b/fe9b8a94.jpg" width="30px"><span>当当</span> 👍（9） 💬（3）<div>老师，直接在chrome测试成功，声音不正常（回声很想），加了参数消除回音，还是不行，为什么啊？</div>2019-07-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/81/ed/c34c1a53.jpg" width="30px"><span>蓝桥</span> 👍（8） 💬（1）<div>你好，老师，现有的 rtmp 的直播解决方案和 webRTC 之间优劣势在什么地方？</div>2019-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/57/b6/b4af6db6.jpg" width="30px"><span>翌</span> 👍（6） 💬（6）<div>其他平台学过老师的课程，讲的很详细。一直希望老师讲讲Android端相关的知识点，后来想来，音视频重点还是在服务端，Web 目前又比较普及，无论是PC还是移动终端，都越来越多的支持 Web 了。</div>2019-07-16</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJib9868nWiaNHt7asPdu9mBYq06z3I8anddLwQib7vHvQ7L7hQxsaOyHpeA6U2Rnxdvkruk6dZbux9A/132" width="30px"><span>venn</span> 👍（5） 💬（1）<div>请问老师，用webrtc做视频直播的话，是不是意味着教师端需要同时和所有学生端直接建立连接，然后音视频不需要经过服务器而直接发到学生端，这样的话对教师端的带宽有要求吗？这种直播稳定吗</div>2019-10-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/53/eb/008f83ad.jpg" width="30px"><span>Geek_4b4f4a</span> 👍（5） 💬（1）<div>你好，老师，我是做webrtc的原生Android客户端的，您的课程有这方面的讲解吗？</div>2019-07-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/4e/ac/3ca3fde2.jpg" width="30px"><span>李尧|Wonder</span> 👍（3） 💬（2）<div>老师，我打开audio之后回音特别大最后有很尖锐的声音，是什么原因？我试着在video中加入muted还是不行</div>2019-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/04/51/da465a93.jpg" width="30px"><span>超威丶</span> 👍（3） 💬（2）<div>请问NAT穿越是啥？</div>2019-07-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/a9/2a/677d4d6e.jpg" width="30px"><span>hh</span> 👍（2） 💬（1）<div>请问老师，本地打开html可以看到到画面，代码理解，但不知如何给server.js跑起来，如何部署在服务器里呢，配合nginx咋弄呢，对js这方面几乎是小白，望解惑？</div>2019-08-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/df/6e/267bd6ee.jpg" width="30px"><span>1900</span> 👍（2） 💬（1）<div>数据轨和音频轨视频轨的区别在哪里呢？</div>2019-07-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/2a/4f/ce7322e3.jpg" width="30px"><span>不是山谷-13.25</span> 👍（1） 💬（2）<div>老师，拒绝了摄像头访问之后再次进入怎么才能重新弹出授权弹框啊？</div>2020-03-23</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL7h9x6VXY9DmPnRWVKELfbfeJ9e9ricn12ia5icXB8u1cBhjlSE74lHiaYFAatosmjAxCdNIsyV23ByQ/132" width="30px"><span>Geek_ualcx9</span> 👍（1） 💬（1）<div>还没专门搭signal服务器和STUN&#47;TRUN服务器，只是用

python -m SimpleHTTPServer

简单的试了一下老师的demo，成功了！一点点正反馈，再前进。</div>2019-12-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/1d/94/80b8a9f4.jpg" width="30px"><span>一一</span> 👍（1） 💬（4）<div>1 经测试，通过file:&#47;&#47;&#47;E:&#47;test&#47;WebRTCTest&#47;day01&#47;WebRTC1.html本地打开Chrome、Edge浏览器，可以正常显示摄像头图像。
2 将页面部署到 IIS服务器中，通过http:&#47;&#47;192.168.1.37:81&#47;day01&#47;WebRTC1.html在以上浏览器中，无法显示摄像头图像。
3 看了网友的留言，老师回复需要https协议，还需要购买个域名，备案，才能解决2中的问题。</div>2019-11-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/f5/98/45374bb9.jpg" width="30px"><span>小小小丶盘子</span> 👍（1） 💬（2）<div>将老师的代码部署到自己站点，手机试了一下可以，电脑没有设备，但是报错是  DOMException，改为alert 的话，就提示  NotFoundError：Requested device not found。 </div>2019-09-27</li><br/><li><img src="" width="30px"><span>ammo</span> 👍（1） 💬（3）<div>想知道chrome如何直接播放rtsp直播流。现在后台给我的就是rtsp的播放链接。找了些方案要不太落后，要不就是要收费的。大致知道可以通过websocket转发给前端。有没有开源的直接方案，马上要上项目了。。。。。</div>2019-09-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/19/60/fee9a900.jpg" width="30px"><span>Shawn·Pen</span> 👍（1） 💬（1）<div>老师，请问基础开发环境如何搭建？有没有截图什么的？多谢！</div>2019-08-20</li><br/><li><img src="" width="30px"><span>Geek_leo长沙</span> 👍（1） 💬（1）<div>老师 我搭了stun服务，基于ubuntu系统搭的，已经放到公网，同nat内的设备可以连接看到视频。但是不同nat的设备无法看到彼此画面。要怎么增加turn服务呢。我找了几天没找到合适资料，就是搭建turn服务的，能帮推荐一下吗。可能需求描述不够到位，我目标就是要实现不同nat下的设备能互联看视频，这流程不同，我没法进行下一步webrtc学习了感觉，麻烦帮推荐或者指导下，多谢啦</div>2019-07-30</li><br/><li><img src="" width="30px"><span>Geek_leo长沙</span> 👍（1） 💬（4）<div>我自己搭了一个sturn服务器，放的外网阿里云。手机端的应用。两个设备都连wifi情况下可以视频连接。但是一个连wifi和一个用移动网络的终端互相都看不到对方视频。看信令日志 连接是成功了。不知道哪里出问题了。老师能帮分析下吗</div>2019-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/f7/64/7e39a739.jpg" width="30px"><span>麦晓杰alwaysu</span> 👍（1） 💬（1）<div>本地调试https，可以使用这个https:&#47;&#47;github.com&#47;FiloSottile&#47;mkcert。</div>2019-07-23</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/r9tbp1yt51ia58NrXaMOJic5fRl4GPTxoMBe1wtEMMLAlll5kanbSpBhKP2YIWdibGgShe55xbqavibccKx0Nl7ECA/132" width="30px"><span>曹士远</span> 👍（1） 💬（1）<div>STUN&#47;TURN 服务器是否有开源的，我之前看到都是使用谷歌的。</div>2019-07-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/87/48/e127c62a.jpg" width="30px"><span>空白</span> 👍（1） 💬（1）<div>在使用nuxt创建的vue项目中，
使用ip访问：navigator.mediaDevices.是 undefined 
使用localhost访问：navigator.mediaDevices. 存在

这是为什么呢</div>2019-07-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/d9/84/f70c4819.jpg" width="30px"><span>-外向的孤独患者.</span> 👍（1） 💬（1）<div>你好，我在本地调试的时候，可以出音视频，但是感觉很大杂音，是否是已经配置的echoCancellation等参数没有生效？ facingMode的参数值在这里需要怎么样才能在页面上传值到这个js方法填写呢，如果直接写就是默认选择好了？此阶段就遇到这两个问题</div>2019-07-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/7b/f0/ccc11dec.jpg" width="30px"><span>Cris</span> 👍（0） 💬（1）<div>老师，请问 字幕 属于 MediaStream 还是 DataStream ？</div>2021-04-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/23/af/84f4714e.jpg" width="30px"><span>caidy</span> 👍（0） 💬（1）<div>console.log(device.kind + &quot;: &quot; + device.label +
						&quot; id = &quot; + device.deviceId);拿到的ID一直是NULL,这是为什么？</div>2021-04-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/8e/c9/80e51289.jpg" width="30px"><span>Wall-E</span> 👍（0） 💬（1）<div>最近遇到一个问题： 能否直接rtsp流推到srs服务器？  
srs.conf添加了这个配置 但是 推流失败（推流地址：rtsp:&#47;&#47;ip:554&#47;live&#47;test）
stream_caster {
    enabled         on;
    caster          rtsp;
    output          rtmp:&#47;&#47;127.0.0.1&#47;[app]&#47;[stream];
    listen          554;
    rtp_port_min    57200;
    rtp_port_max    57300;
}
</div>2021-03-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/b9/90/abb7bfe3.jpg" width="30px"><span>A 付李珏</span> 👍（0） 💬（1）<div>请问摄像头是否最多指定到前后摄像头？对于后置多摄像模组，是否能够指定调用微距摄像头，进行OCR识别？</div>2021-01-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e8/58/ecb493dc.jpg" width="30px"><span>ming</span> 👍（0） 💬（1）<div>老师，demo中的 https:&#47;&#47;webrtc.github.io&#47;adapter&#47;adapter-latest.js 主要是解决什么问题？</div>2020-12-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/23/de/2d/b62aed1a.jpg" width="30px"><span>二营长的炮</span> 👍（0） 💬（2）<div>老师你好，目前我想要使用webrtc去实现web到手机的音频传输，类似对讲机的功能，请问这个会麻烦吗，有什么技术方法可以参考一下吗</div>2020-12-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/23/de/2d/b62aed1a.jpg" width="30px"><span>二营长的炮</span> 👍（0） 💬（2）<div>老师，我笔记本跑client.html，在打开回音消除，自动增益，降噪的情况下，并且只有client.html这一个页面开了开着音频，也还是回声不减，甚至我感觉有开没开效果不是特别明显，尝试了只开回音消除也是一样。试过外置耳机麦克风，笔记本内置麦克风没多大改变。我在video标签加了muted后就静音了，什么声音都发不出。请问这个回音消除是否真的有效呢？</div>2020-12-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/06/8a/68bfb917.jpg" width="30px"><span>人在风中</span> 👍（0） 💬（1）<div>之前研究了一段时间jitsi,脑壳痛 
看到老师的专栏真的是如获至宝</div>2020-10-09</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/aFAYPyw7ywC1xE9h1qibnTBwtWn2ClJqlicy5cMomhZVaruMyqSq76wMkS279mUaGhrLGwWo9ZnW0WCWfmMovlXw/132" width="30px"><span>木瓜777</span> 👍（0） 💬（1）<div>老师，怎么知道后端传给前端的第一帧数据传完了？ 或者说 前端有没有方法知道 收到的第一帧？</div>2020-08-07</li><br/>
</ul>