周一我为你介绍了搜索系统的一个宏观分类，包括传统的文本匹配信息检索系统和机器学习信息检索系统。这个分类可以让你非常清晰地了解信息搜索系统的历史进程，并对这两种搜索系统的特点有所了解。

今天我们就来剖析搜索系统的另一个框架体系：**多轮打分（Scoring）系统**。

## 多轮打分系统综述

什么是多轮打分系统？为什么搜索系统需要多轮打分？

我们拿上次介绍的机器学习搜索系统为例。从整体来说，机器学习搜索系统的目的是利用机器学习模型来预测文档和搜索关键字之间的相关性。那么，在理想状态下，针对每一个查询关键字，我们需要对数据集中的每一个文档进行打分。

如果是一个类似互联网搜索引擎的应用场景，那么理论上，每一个查询关键字都需要对几亿甚至十几亿的网页进行打分。显然，仅仅从这个数量级上来说，这样做都是不现实的。

从另一个方面来讲，目前比较通用的机器学习模型，特别是在排序问题上有强劲表现的树模型（Tree Model），比如GBDT（Gradient Boosted Decision Trees）或者神经网络，都有较高的计算时间复杂度。要想在实时响应的反应时间内（例如几百毫秒内）对相对比较多（我们这里说的是几千甚至上万）的文档进行打分是很困难的，我们刚才提到的整个数据集中是有几亿甚至十几亿的文档，那就更加困难了。

于是在这样的情况下，我们就需要有这么一种机制：对于每个查询关键字而言，能够先有一个方法在整个数据集上快速评价出几百到几千不等（视具体应用）的文档，然后在这个几百到几千不等的集合上运用复杂的模型进行计算并且排序。 **这种需要对文档进行两轮打分的流程叫做“两轮打分框架”**（见参考文献\[3]）。
<div><strong>精选留言（4）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/6a/a1/6270eeb7.jpg" width="30px"><span>极客星星</span> 👍（4） 💬（1）<div> 由于第一轮的主要功能是召回 所以我觉得应该以召回率为主要评估指标 不知道理解是否正确</div>2017-12-20</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/6uE1f3Dl8GqrPFEDrkNEQPEibY7z2Kl6QyjHgbGe7icKppOH9P3K7c3SRyN45hnDa8WfJDxOTEOTI2IMArQccNxA/132" width="30px"><span>ID</span> 👍（0） 💬（0）<div>WAND 操作符并不是把一个通用的、普遍的线性模型应用到文档索引上，而是说，如果我们能够把模型给简化为只有正系数的线性模型，那么，整个模型其实可以看做是两个向量的点积，而 WAND 则是对点积在索引上的一种优化。（这句话没懂）  模型是什么样的？特征是什么？预测的标签又是什么？怎么使用模型结果？怎么优化这个模型？</div>2019-11-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/4f/11/63d7d993.jpg" width="30px"><span>jifei</span> 👍（0） 💬（0）<div>目前我们的搜索也是做了两轮打分，第一轮搜索引擎排序：结合了文本得分以及物品质量、商业目标定义的得分值；第二轮机器学习算法排序：基于用户的反馈数据，离线训练模型，线上实时预测。下一步打算第一轮扩大召回范围以及个性化召回，让第二轮的数据量提上来在第二轮打分上内部实现分页。老师觉得怎么样呢？</div>2018-12-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/29/72/76838c57.jpg" width="30px"><span>白杨</span> 👍（0） 💬（0）<div>从经验上来判断bm25是否在一个范围内，而这个经验的范围可以通过机器学习的方式来拟合出来，这样可行吗？</div>2018-05-17</li><br/>
</ul>