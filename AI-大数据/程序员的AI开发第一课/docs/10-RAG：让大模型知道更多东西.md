你好，我是郑晔！

上一讲，我们讲了如何实现一个自己的聊天机器人，通过调整提示词，你就可以打造出各种各样的聊天机器人，相信你一定和它聊得不亦乐乎。

但在度过了最初的快乐时光，你打算让你的聊天机器人和你聊一下有用的东西时，你就会发现，它知道东西并不像你想象得那么多。

虽然我们说大模型的特点之一是知识丰富，但这里的知识仅限于通用的知识，也就是网上能够很容易找到的知识。对于一些特定的知识，比如你所在业务领域的知识，它就一无所知了。个中缘由，不言而喻，大模型训练时，根本不可能拿到你们公司的数据。

如果我打算为自己的业务开发一个聊天机器人，也就是说，让聊天机器人知道我的业务，该怎么办呢？抛开训练一个属于自己的大模型这种成本高昂的办法，常见的解决方案有两种：

- 模型微调：使用业务信息对已经训练好的模型进行微调。
- RAG：在上下文中带有业务信息，让大模型据此进行整合。

相比于模型微调，RAG 的方案成本要低一些，而且更加灵活，实现起来也更简单一些，所以，它也成为了现在解决这个问题的首选。这一讲，我们就来了解一下 RAG。

## RAG

RAG 是 Retrieval-Augmented Generation 的缩写，也就是检索增强生成。这是什么意思呢？就是通过检索的方式，对要处理的内容进行增强之后再去生成。
<div><strong>精选留言（7）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/18/06/32/3de6a189.jpg" width="30px"><span>范</span> 👍（1） 💬（1）<div>我的理解是RAG的整个请求过程是将业务知识向量化存储，独立于chatmodel模式。似乎也不在文中的极简示意图的五步中。</div>2024-12-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/a8/46/42c2e559.jpg" width="30px"><span>煜寶</span> 👍（0） 💬（1）<div>老师，embedding模型主要也是对应的一些llm提供的对吧？那这个就会有数据安全问题吧？比如open唉提供的embedding接口一般具有数据安全要求的团队就用不了吧？对此有什么解法么？</div>2024-11-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/78/3e/f60ea472.jpg" width="30px"><span>grok</span> 👍（2） 💬（1）<div>思考题答案：

### 1. **知识库内容缺失**
- **问题**：当用户提问的问题无法从现有的知识库中找到答案时，RAG系统可能会提供错误或不准确的回答，而不是告知用户“不知道”。
- **解决方案**：目前没有完美解决方案，但可以采取以下措施：
  - 明确提示词限制，避免让模型生成不相关或错误的信息。
  - 通过增强元数据来提高检索效率，如对商品进行固定分类和型号，确保提供给LLM的信息是相关且准确的。
  - 开发校验模型来判断回答是否正确。

### 2. **TopK截断有用文档**
- **问题**：与用户查询相关的文档可能因为相似度不足而被排除在检索结果之外。
- **解决方案**：
  - 持续优化reranker模型，以提高文档的排名准确性。
  - 使用元数据过滤来缩小检索范围，提升相关性。</div>2024-11-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg" width="30px"><span>张申傲</span> 👍（1） 💬（0）<div>第10讲打卡~
现阶段RAG仍然存在一些问题，比如 Embedding 后会丢失信息、召回结果不稳定、检索结果不好评估等等，还需要结合特定业务场景进行优化。</div>2025-01-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/84/19/7ed2ffa6.jpg" width="30px"><span>风</span> 👍（0） 💬（0）<div>RAG指的是查询的时候先去匹配业务知识向量库，然后把匹配到的相关知识作为少样本提示</div>2025-02-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/9a/a6/3bddb98c.jpg" width="30px"><span>大叶枫</span> 👍（0） 💬（0）<div>RAG总结
	1.概念定义：Retrieval-Augmented Generation，增强检索生成；通过检索的方式对内容进行增强后再进行生成，结合大模型应用和检索增强，使大模型了解特定领域的业务知识
	2.处理过程：RAG 系统处理用户请求的流程包括用户发起请求、在相关资料中进行查询、获取相关内容、组成完整提示词发给大模型，将大模型的回复发给用户
	3.通用技术
		3.1.RAG 技术是依赖于将文本转换成向量，以实现语义上的匹配。将文本转成向量，我们通常会使用专门的 Embedding 模型，而对向量进行检索，则使用向量数据库。
		3.2.索引就是把信息放到向量数据库中，而检索就是把信息提取出来，提取出来的信息与用户提示词合并起来，再到大模型去完成生成的过程
	4.相关技术：
		4.1.混合搜索，以支持人名、特定ID的检索
		4.2.重排序，增强业务查询相关程度
		4.3.知识图谱RAG，结构化信息之间的关联程度</div>2025-01-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg" width="30px"><span>Demon.Lee</span> 👍（0） 💬（0）<div>1、RAG 就是为大模型提供更多上下文知识（业务知识）；
2、传统的查询是「字面」意义的匹配，而向量数据库则是「语义」层面的匹配；
3、如何拆分文档，让检索更准确，感觉也是一个工程，需要结合段落，句子，语义等进行处理。

索引（将业务信息向量化并存储到向量数据）--&gt; 检索（将问题向量化，然后去向量数据库拿到相关信息） --&gt; 生成</div>2025-01-07</li><br/>
</ul>