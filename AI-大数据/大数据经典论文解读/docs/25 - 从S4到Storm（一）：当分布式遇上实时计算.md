你好，我是徐文浩。

到Spanner为止，我们已经把大数据里，关于数据存储和在线服务的重要论文解读完了。从这一讲开始，我们就要开始讲解另一个重要的主题，也就是大数据的流式处理。今天我们解读的第一篇论文，来自一个曾经辉煌但是今天已经逐渐销声匿迹的公司Yahoo。这篇论文就是《S4:Distributed Stream Computing Platform》，伴随着这篇论文的，同样是一个开源系统Apache S4。和同样孵化自Yahoo的Hadoop不同，S4虽然是最早发布的开源分布式流式数据处理系统，但是在市场上最终却没有占有一席之地。

不过，学习S4的论文本身还是很有价值的。一方面，你可以看到大数据流式处理的基础结构是怎么样的，你会发现它和批处理的MapReduce是非常相似的；另一方面，它又会面临比批处理的MapReduce多得多的挑战和困难。

那在学完这一讲之后，你能有这样几点收获：

- 首先是对于大数据的流式计算问题的基本抽象，也就是它在逻辑上应该是一个什么样的模型，它想要解决的具体问题是什么。
- 其次是S4这个系统的设计是怎么样的，它是如何进行分布式计算的。
- 最后是S4系统的缺陷有哪些，以及有哪些问题S4干脆是回避了。这一点对于我们后面去认识Storm、Kafka这些系统的核心价值点非常关键。
<div><strong>精选留言（4）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/15/66/8f/02be926d.jpg" width="30px"><span>在路上</span> 👍（10） 💬（0）<div>徐老师好，第一、MapReduce的每个Reduce任务都会对数据排序，哪怕需要的顺序和输入的顺序一致，在运算大数据集时排序可以让相关的数据靠在一起，减少内存的使用，但是对流式计算来说，把一分钟的数据全部放入内存是可行的，排序应该只在需要的时候进行。

第二、MapReduce的输入是有界数据，所以它总是等上一个任务完成，再开始下一个任务，这样系统不能有效利用所有的分布式资源，并且被掉队者（straggler）拖慢进度。而流式计算，会在上一个任务产生输出之后，马上开始第二个任务，这也决定了流式计算的数据一般不需要排序，因为排序需要等待收到全部数据。</div>2021-11-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/f6/e3/e4bcd69e.jpg" width="30px"><span>沉淀的梦想</span> 👍（1） 💬（0）<div>这种 Actor 模型扩容不是应该非常容易吗？为什么 S4 不支持动态扩容呢？是因为底层设计无法支撑，还是单纯没做？</div>2023-03-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/04/30/7f2cb8e3.jpg" width="30px"><span>CRT</span> 👍（1） 💬（0）<div>Mr做实时处理会遇到两个问题，第一个就是每个任务都要启动master，过于消耗时间，我们可以让master常驻来解决，也就是把流任务抽象为一个超级大的批任务，输入源无限大，让mr任务每次处理一小部分；第二个问题是mr任务中间结果会落地磁盘，这个比较好解决，既然每次只处理一部分，这部分在内存处理完直接释放即可。</div>2022-01-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/8f/60/be0a8805.jpg" width="30px"><span>陈迪</span> 👍（0） 💬（0）<div>communication layer 类似于node的sidecar😄</div>2021-12-01</li><br/>
</ul>