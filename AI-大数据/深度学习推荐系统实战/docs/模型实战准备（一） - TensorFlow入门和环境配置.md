你好，我是王喆。

我在留言区看到，很多同学对TensorFlow的用法还不太熟悉，甚至可能还没接触过它。但我们必须要熟练掌握TensorFlow，因为接下来，它会成为我们课程主要使用的工具和平台。为此，我特意准备了两堂模型实战准备课，来帮助你掌握TensorFlow的基础知识，以及为构建深度学习模型做好准备。

这节课，我们先来学习TensorFlow的环境配置，讲讲什么是TensorFlow，怎么安装TensorFlow，以及怎么在TensorFlow上构建你的第一个深度学习模型。下节课，我们再来学习模型特征和训练样本的处理方法。

## 什么是TensorFlow？

TensorFlow 是由 Google Brain团队开发的深度学习平台，于2015年11月首次发布，目前最新版本是2.3。因为TensorFlow自从2.0版本之后就发生了较大的变化，所以咱们这门课程会使用TensorFlow2.3作为实践版本。

TensorFlow这个名字还是很有意思的，翻译过来是“张量流动”，这非常准确地表达了它的基本原理，就是根据深度学习模型架构构建一个有向图，让数据以[张量](https://www.youtube.com/watch?v=f5liqUk0ZTw)的形式在其中流动起来。

这里的张量（Tensor）其实是指向量的高维扩展，比如向量可以看作是张量的一维形式，矩阵可以看作张量在二维空间上的特例。在深度学习模型中，大部分数据是以矩阵甚至更高维的张量表达的，为了让这些张量数据流动起来，每一个深度学习模型需要根据模型结构建立一个由点和边组成的有向图，图里面的点代表着某种操作，比如某个激活函数、某种矩阵运算等等，而边就定义了张量流动的方向。
<div><strong>精选留言（22）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/27/7c/ea/531e76a7.jpg" width="30px"><span>达拉崩巴</span> 👍（3） 💬（1）<div>在IDEA中安装tensorflow的分享：
1. Anaconda：是一个python环境的管理软件，它一般可以采用界面或者命令行，安装按照官网文档来即可，具体解释下几个基础概念：
channels:就是获取包的来源，一般需要改为清华镜像源，那样下载速度快些
tensorflow-gpu:该包是针对有英伟达GPU的电脑的，使用需要安装NVIDIA提供的CUDA库和cuDNN神经网络加速库
2.python环境，一般使用IDEA创建py文件时，需要指定python环境，最好先使用Anaconda创建一个含有tensorflow包的环境，再创建文件时使用该环境，这样不易出问题。
</div>2021-04-27</li><br/><li><img src="" width="30px"><span>Geek_ed807a</span> 👍（3） 💬（2）<div>老师为什么我没有tfmodel这个模块呢？是要自己创建么</div>2021-01-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/c9/f8/72955ef9.jpg" width="30px"><span>浣熊当家</span> 👍（3） 💬（1）<div>已经学到了第20讲，我们一直在用IDEA里使用TensorFlow，而且我觉得很方便，所以突然有了个问题， 我们既然IDEA里已经可以很好的运用TensorFlow， 而且可以方便的跟项目内部其他模块进行连接，那用Docker的好处和意义又是什么呢？而且在Docker里使用TensorFlow，我们怎么跟IDEA里的其他模块进行连接呢？</div>2020-11-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg" width="30px"><span>JustDoDT</span> 👍（3） 💬（3）<div>当你运行是遇到如下问题：
2020-11-22 00:24:18.554317: I tensorflow&#47;core&#47;platform&#47;cpu_feature_guard.cc:145] This TensorFlow binary is optimized with Intel(R) MKL-DNN to use the following CPU instructions in performance critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in non-MKL-DNN operations, rebuild TensorFlow with the appropriate compiler flags.
2020-11-22 00:24:18.554530: I tensorflow&#47;core&#47;common_runtime&#47;process_util.cc:115] Creating new thread pool with default inter op setting: 6. Tune using inter_op_parallelism_threads for best performance.
Train on 60000 samples
Epoch 1&#47;5
OMP: Error #15: Initializing libiomp5.dylib, but found libiomp5.dylib already initialized.
OMP: Hint This means that multiple copies of the OpenMP runtime have been linked into the program. That is dangerous, since it can degrade performance or cause incorrect results. The best thing to do is to ensure that only a single OpenMP runtime is linked into the process, e.g. by avoiding static linking of the OpenMP runtime in any library. As an unsafe, unsupported, undocumented workaround you can set the environment variable KMP_DUPLICATE_LIB_OK=TRUE to allow the program to continue to execute, but that may cause crashes or silently produce incorrect results. For more information, please see http:&#47;&#47;www.intel.com&#47;software&#47;products&#47;support&#47;.

Process finished with exit code 134 (interrupted by signal 6: SIGABRT)

运行：
conda install nomkl
可以解决。</div>2020-11-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/ef/89/e1f9ed28.jpg" width="30px"><span>设置</span> 👍（2） 💬（1）<div>大佬你好，我比较偏工程，想知道后续会有保存tensorflow的模型，java部署线上预估server的教程嘛，谢谢。</div>2020-11-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/c9/f8/72955ef9.jpg" width="30px"><span>浣熊当家</span> 👍（2） 💬（1）<div>还想请教老师，我经常被做项目过程中如何安装插件，如果设置环境这些很琐碎的问题卡住，经常是一个小问题就会卡好几天，在网上也经常搜不到解决方案，所以大多数的时间甚至不是花在学习项目山，而是配置软件上了。老师您是怎么一点一点了解这些的呢，比如您刚接触如何使用tensorflow， 使用docker的时候，在inteliJ使用conda环境，这些都是怎么学会的？ 是工作中同事相互讨论吗？</div>2020-11-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/08/a2/346431a9.jpg" width="30px"><span>Geek_b86285</span> 👍（1） 💬（1）<div>老师您好，请问如果需要使用gpu训练全量数据，或者要复现deepfm，din等比较复杂的推荐系统模型，对机器有没有什么要求呢，cpu核数，内存大小，显存大小，显卡型号等等</div>2020-11-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/c9/f8/72955ef9.jpg" width="30px"><span>浣熊当家</span> 👍（1） 💬（2）<div>在图3的步骤添加python SDK的时候，“JDK home path”的路径是不是一定要设置在tf&#47;bin&#47;python 这个路径呢？首先我去查找我的文件然后发现Users\myname\Anacomda3\envs\tf 这个路径下没有bin\python这个subfolder，然后如果直接选择tf这个文件夹，就是提示“The selected directory is not a valid home for JDK”. 想请教老师和大家该怎么解决</div>2020-11-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/14/34/9a96e8d2.jpg" width="30px"><span>浩浩</span> 👍（0） 💬（1）<div>王老师，现在生产环境中 tf 2.X 版本使用的多吗？而且一些新的预训练等等的模型支持的全吗？</div>2020-12-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/6d/c5/c0665034.jpg" width="30px"><span>Wiiki</span> 👍（0） 💬（1）<div>王老师，我在操作您介绍的第一种方式（docker+jupyter）时候遇到了一个问题，在本地安装完tensorflow镜像和tensorflow-jupyter镜像后，运行docker run -it -p 8888:8888 tensorflow&#47;tensorflow:latest-jupyter命令，然后服务顺利的启动了。但是在本地浏览器启动http:&#47;&#47;localhost:8888&#47; 的时候，界面显示“localhost拒绝了我们的连接请求”。这个是怎么回事呀？</div>2020-11-13</li><br/><li><img src="" width="30px"><span>Geek_c0fd60</span> 👍（5） 💬（7）<div>请问，图5中 只有 sparrowRecsys 模块，没有TFRecModel。项目中TFRecModel也没有小蓝框，如何设置呢</div>2021-03-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/25/2c/2bbd84ef.jpg" width="30px"><span>elephant</span> 👍（1） 💬（1）<div>Mac M1 亲测最简单的安装过程：https:&#47;&#47;caffeinedev.medium.com&#47;how-to-install-tensorflow-on-m1-mac-8e9b91d93706，需要自备梯子。</div>2022-12-29</li><br/><li><img src="" width="30px"><span>Geek_90c8fd</span> 👍（1） 💬（2）<div>运行测试的时候报错
ModuleNotFoundError: No module named &#39;keras&#39;
但查看conda list下面已经有keras是什么问题呢</div>2022-02-14</li><br/><li><img src="" width="30px"><span>Geek_c0fd60</span> 👍（1） 💬（0）<div>请教一下，我从git clone下来后，像图5 TFRecModel 。我们不是module。没有蓝色小框。这个怎么解决呢？</div>2021-03-10</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJbuxpls8cAmtDic0lbXjqiblKictEmVZkxHH8iaRq5dRLpoBc0pHZlybY6ERkuCkaQImuNbxj68HpKWQ/132" width="30px"><span>Geek_41d96a</span> 👍（0） 💬（0）<div>直接在pycharm中配置调试不是会简单点吗
</div>2022-02-16</li><br/><li><img src="" width="30px"><span>kuailema1217</span> 👍（0） 💬（1）<div>好像最新的版本TFRecModel在sparrowRecsys下面，就不需要加一个TFRecModel module了。
只要把图5显示的add python interpreter加在sparrowRecsys下面就可以。</div>2022-02-10</li><br/><li><img src="" width="30px"><span>Jarvis</span> 👍（0） 💬（0）<div>发现了一个小瑕疵。代码第28行漏了半边括号。</div>2022-01-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/a0/11/db9a2e60.jpg" width="30px"><span>呼儿嘿呦</span> 👍（0） 💬（0）<div>直接运行DIEN模型，报错，试了几个版本都不行，相互冲突，tensorflow=2.3.0,numpy=1.16.0NotImplementedError: Cannot convert a symbolic Tensor (gru&#47;strided_slice:0) to a numpy array. This error may indicate that you&#39;re trying to pass a Tensor to a NumPy call, which is not supported</div>2021-08-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/a0/11/db9a2e60.jpg" width="30px"><span>呼儿嘿呦</span> 👍（0） 💬（0）<div>直接运行DIEN模型，报错：</div>2021-08-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/a0/11/db9a2e60.jpg" width="30px"><span>呼儿嘿呦</span> 👍（0） 💬（0）<div>NotImplementedError: Cannot convert a symbolic Tensor (gru&#47;strided_slice:0) to a numpy array. This error may indicate that you&#39;re trying to pass a Tensor to a NumPy call, which is not supported</div>2021-08-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/23/b5/8b/92549066.jpg" width="30px"><span>Geek_8183d5</span> 👍（0） 💬（2）<div>M1芯片版的mac好像装不了tensorflow😅</div>2021-04-28</li><br/><li><img src="" width="30px"><span>Geek_安夏</span> 👍（0） 💬（0）<div>老师，请问conda create -n tf tensorflow这种方式默认安装的是TensorFlow的那个版本呢？我执行之后安装的是1.14版本，另外，创建虚拟环境时直接安装TensorFlow和先创建虚拟环境，指定python版本，再conda install tensorflow两种安装方式有本质区别吗？</div>2021-02-22</li><br/>
</ul>