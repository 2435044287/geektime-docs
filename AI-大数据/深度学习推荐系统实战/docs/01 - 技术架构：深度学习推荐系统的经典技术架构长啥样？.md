你好，我是王喆。从今天开始，我们正式开始学习“深度学习推荐系统”了。在开始之前，我想先问你一个问题：当你开始学习一个全新领域的时候，你想做的第一件事情是什么？

当然每个人可能都有自己的答案，但对于我自己来说，我最想搞明白的是两个问题。一个是，这个领域到底要解决什么问题？第二个是，这个领域有没有一个非常高角度的思维导图，让我能够了解这个领域有哪些主要的技术，做到心中有数？

针对“深度学习推荐系统”这个领域啊，可能还会有第三个问题，为什么我们要一直强调“深度学习”，深度学习到底给推荐系统带来了什么革命性的影响？相信听完了这一节课，你心中的这三个问题也都能迎刃而解。

## 推荐系统要解决的根本问题是什么？

在开篇词中我们提到，推荐系统的应用已经渗透到购物、娱乐、学习等生活的方方面面，虽然商品推荐、视频推荐、新闻推荐这些推荐场景可能完全不同，既然它们都被称为“推荐系统”，解决的本质问题一定是相通的，遵循着共通的逻辑框架。

推荐系统要解决的问题用一句话总结就是，**在“信息过载”的情况下，用户如何高效获取感兴趣的信息。**

因此，推荐系统正是在“浩如烟海的互联网信息”和“用户的兴趣点”之间，搭建起的一座桥梁。那这座桥是怎么一步步搭建起来的呢？下面，我们先来看看，推荐系统比较抽象的逻辑架构是什么样的，再一步步搭建起它的技术架构，让你对推荐系统有一个整体上的印象。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/0f/87/6b/0b6cd39a.jpg" width="30px"><span>朱月俊</span> 👍（33） 💬（2）<div>数据部分：event distribution, hadoop, query results, netflex.hermes, user event queue, netflix.manhattan.
模型部分：model training, models, online computation, online service, algorithm service.</div>2020-09-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/81/06/d7c6d511.jpg" width="30px"><span>杜军</span> 👍（24） 💬（3）<div>请教大神，我们注意到 Flink 最近更新比较频繁，号称可以做到流批一体分析，甚至 ETL 领域好像也可以用起来，是不是可以在系统架构设计的时候直接用 Flink 取代 Spark，ETL 和实时部分统一到一个架构上来是否可行？谢谢</div>2020-09-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/8c/55/cac3dbcc.jpg" width="30px"><span>Four y</span> 👍（22） 💬（4）<div>老师，请问关于大数据数据出口的那一部分，请问实时的用户推荐请求也是会先经过大数据处理，生成可供线上推理的数据吗？就是针对文中大数据出口的第二点。</div>2020-09-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/47/16/1df78c2b.jpg" width="30px"><span>飞逝@时间</span> 👍（13） 💬（2）<div>老师，请教几个实际生产问题（T表示当天，T-1表示昨天）：
1）在召回阶段，不管是传统的CB&#47;CF算法或者老师说深度学习中的Embedding技术，这部分由于拿的全量数据（T之前的所有数据）所以离线计算，但是由于训练的数据是按时间不断递增更新的，是需要每天都调度这些算法离线计算产生召回物品吗？
2）同样在精排阶段，由于数据每天按时间递增，那训练的模型是每天重新训练？还是按照一定的策略（比如积累一定程度的数据量）再重新训练模型？</div>2021-06-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/b2/cb/9c6c7bf7.jpg" width="30px"><span>张弛 Conor</span> 👍（9） 💬（2）<div>老师，想向您请教一下召回层和排序层除了结果上的“粗”和“精”是否还有其他的区别？另外就是二者在深度学习技术加持下能否实现端到端的排序呢？</div>2020-09-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/28/a1/fd2bfc25.jpg" width="30px"><span>fsc2016</span> 👍（9） 💬（1）<div>老师，这套课程侧重点和您的书《深度学习推荐系统》区别是什么了，更偏实战嘛</div>2020-09-22</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ3q0LkadjOv4zicr7xQufgXyh8o1Usno8RZdeBPOqzsoH8DRiaMdYjs0OyEuTknHwHxfQ4AnBHdBCA/132" width="30px"><span>Geek_f676f3</span> 👍（8） 💬（2）<div>文章写得不错，赞！推荐是一个更复合的领域，在推荐系统实践中，整体的思考架构还可以增加产品、系统纬度；产品、数据、模型、系统四位一体，作为从业人员，也要学会从产品角度来思考问题</div>2021-02-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/98/65/a14953d9.jpg" width="30px"><span>西北小英雄</span> 👍（8） 💬（1）<div>老师您好，我去看了您的知乎专栏对Netflix推荐系统架构图的讲解，对下面部分有点疑问。（可能我是推荐系统新手，没有工程经验对架构不太懂，如果的问题不是很营养，望谅解）

比如从online 到nearline和offline通过用户消息队列（User Event Queue，现在基本都使用Kafka）来缓存数据流，这是连接online和其他层的接口。
而从nearline和offline中连接online的接口则是algorithm service，online data service，以及model到online层的接口。
1.单从图中也看不出User Event Queue和offline层有关系，
2.nearline层是把计算结果存入mysql等数据库后给online层的algorithm service使用了吗？</div>2020-10-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/22/8e/67/afb412fb.jpg" width="30px"><span>Sam</span> 👍（7） 💬（3）<div>请问王老师一个概念问题，落盘是什么意思？为什么要用落盘这个词？</div>2020-10-26</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK6mh3xlaMoGtWjmVJh2LutdLcQcPbKNjRlVru3bx8ynPhgwuGhhdzTkwEMoXbvBtgkcDSfom1kZg/132" width="30px"><span>夜雨声烦</span> 👍（7） 💬（1）<div>推荐系统要解决的三个问题：
1，推荐系统要解决的问题是什么？
在“信息过载”的情况下，用户如何高效获取感兴趣的信息。
2，有没有一个非常高角度的思维导图，让我能够了解这个领域有哪些主要的技术，做到心中有数？
上面的树结构，以及根、枝干、叶子代表的含义；
3，为什么我们要一直强调“深度学习”，深度学习到底给推荐系统带来了什么革命性的影响？
深度学习的模型结构复杂，数据拟合能力和表达能力更强，能够让推荐模型更好的模拟用户的兴趣变迁过程，甚至是做决定的过程。而深度学习的发展，也推动着推荐系统数据流部分的革命，让它能够更快、更强地处理推荐系统相关的数据。

作业：
数据部分：event distribution,user event queue,Netflix.Manhattan,Cassandra,mysql,EVcache,Online Data Service;Query result,Offline data,Nearline Computation;
模型部分：model training,Models,online computation,online data service,Algorithm Service,Machine Learning Algorithm</div>2020-10-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/27/6d/78/c4a02882.jpg" width="30px"><span>谁将新樽盛旧月</span> 👍（6） 💬（2）<div>公司要上线推荐系统了，刚开始研发第一个推荐系统，看这个是不是有点超纲，后续优化推荐可以用到深度学习推荐，现在就上线课程中推荐系统的感觉有点困难，老师给点建议</div>2021-04-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/23/61/f2175373.jpg" width="30px"><span>高璇璇</span> 👍（6） 💬（1）<div>增强学习是指reinforcement learning吗？国内一般叫强化学习</div>2020-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/a4/49/1c8598d1.jpg" width="30px"><span>军舰</span> 👍（6） 💬（2）<div>老师，候选物品库是不是可以这样理解：我现在在看柯南，那么候选物品可能是动画片、侦探题材等？</div>2020-09-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/d5/68/2201b6b9.jpg" width="30px"><span>归零</span> 👍（5） 💬（1）<div>no magic，作为互联网从业者，目前预测后续的工作跟深度学习相关，先学习一下。很认同老师的思路，先知道解决什么问题，同时心中有一个路线，可以按图索骥。</div>2021-04-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/a2/da/a8a32113.jpg" width="30px"><span>太子长琴</span> 👍（5） 💬（1）<div>老师好，请问下啊，
特征库会存储模型计算后的特征（比如embeddibg）吗，还是只存储基本特征？
实时新数据（比如新用户，新物品）一般是多久或者有什么指标确定需要更新到离线模型呢？
谢谢</div>2020-09-25</li><br/><li><img src="" width="30px"><span>李@君</span> 👍（4） 💬（1）<div>老师，spark和flink都兼具批处理和流处理的能力，技术选型时为什么不使用其中一个呢。文中所提到的实时处理，又实用的是什么技术呢。模型在线更新时，是使用新产生的的数据再对模型进行训练吗，这样的话会不会太耗时，影响功能。</div>2020-09-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/a5/5f/ee1295af.jpg" width="30px"><span>DBC</span> 👍（3） 💬（1）<div>您好，请教一个问题~
Model Serving的部分里面说指的是在线的时候，提供特征的。请问一下，是指的在线去缓存里找，召回的这部分的item的特征和user特征，然后拼接成输入特征后，去请求模型这个过程么？</div>2021-07-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/f6/88/ee32fde9.jpg" width="30px"><span>章光辉</span> 👍（3） 💬（2）<div>虽然老师将“流处理平台”归为“准实时”，我也明白老师的意思是“流处理平台相对于客户端&#47;服务端具有一定的滞后性（哪怕是那么几百毫秒）”，但是这在大数据领域却不是一个正确的说法。</div>2021-03-18</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJNhyPECBkTc0OhtcnakrnriaOnqwJQfWv8DdrDkE3cUxW6OudoGlTXIxRDOZvg36GKGufm75aW9vw/132" width="30px"><span>Geek_b7f31e</span> 👍（3） 💬（3）<div>老师，请教几个问题：
1. 候选集比较小的情况，比如小于5千个物品，是不是没有必要分成召回和排序两块？
2. 一般推荐系统的响应速度要求是多少？根据您的经验制约响应速度的bottle neck一般会出现在哪个环节？
谢谢！</div>2021-01-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/83/61/0e92f997.jpg" width="30px"><span>Yuwei Quan🎋</span> 👍（3） 💬（1）<div>我想问nearline computation这一步是在干嘛啊，是把训练好的model 存成artifact准备和online model相结合做deployment吗。我不太懂数据部分和模型部分的接口是什么意思。最后的event distribution存起来有什么好处啊，会复盘吗？然后他们的Netflix Hermes和Manhattan是一个部组的整个代称还是一个数据处理的代称。谢谢</div>2020-10-15</li><br/><li><img src="" width="30px"><span>Geek_07</span> 👍（3） 💬（1）<div>老师，我想请教一下，候选物品库大概是怎么做存储管理的呢？像今日头条这种平台可能会有不同类型的物品（比如视频、图文等等），他们的结构化的内容属性可能都是不同的，做召回的时候，召回层又是怎么跟物品库做交互的？</div>2020-10-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/1c/b1/12edee24.jpg" width="30px"><span>少刷票圈多读书</span> 👍（3） 💬（1）<div>王喆老师对应的知乎专栏文章：https:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;114590897</div>2020-09-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/29/7f/60/9d7bae85.jpg" width="30px"><span>胡景方</span> 👍（2） 💬（2）<div>问一个很傻的问题，什么是embedding？</div>2021-07-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/8f/dc/31c55cc1.jpg" width="30px"><span>信军</span> 👍（2） 💬（1）<div>老师，能否帮我们付费用户拉个群，我们想互相沟通学习下</div>2021-04-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/dd/42/57a688b7.jpg" width="30px"><span>Jing Lu</span> 👍（2） 💬（1）<div>Netflix架构里面nearline的model, 具体回事什么样的模型啊？感觉只有那些能够incremental train的才行？比如neural net和gradient boosting tree？nearline model的training的更新频率是不是至少在小时的级别，不会太快？</div>2021-04-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/44/a4/7a45d979.jpg" width="30px"><span>IT蜗壳-Tango</span> 👍（2） 💬（1）<div>看其他留言都太牛了，加油学习吧。</div>2020-10-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/7b/48/6468c1f5.jpg" width="30px"><span>尼采</span> 👍（1） 💬（1）<div>看了一些留言，好像都没有说offline计算属于哪个部分，弱问大佬，offline计算应该属于数据部分，然后主要是离线特征挖掘之类的? 近线计算的部分，我理解主要是做一些比如实时的特征监控等，或者增量的训练数据的准备？</div>2021-02-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/33/2c/bc47cf1b.jpg" width="30px"><span>Mc铭城</span> 👍（1） 💬（2）<div>老师，您好，请问Nearline Computation和Online Computation的区别在哪里呢？
我理解Nearline Computation会计算一些准实时的特征，比如说近3min浏览某产品的时长，那Online Computation具体做什么呢？Online Inference吗？</div>2021-01-10</li><br/><li><img src="" width="30px"><span>韩木子</span> 👍（1） 💬（1）<div>“生成推荐系统模型服务（Model Serving）所需的“用户特征”，“物品特征”和一部分“场景特征”，用于推荐系统的线上推断。”
老师，这部分数据是什么，跟训练模型的数据有什么区别</div>2020-11-30</li><br/><li><img src="" width="30px"><span>李@君</span> 👍（1） 💬（1）<div>Netflix的离线数据处理部分，还在使用hive和pig技术吗。</div>2020-09-23</li><br/>
</ul>