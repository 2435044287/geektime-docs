你好，我是博伟。

经过前面的确定目标和假设、确定指标、选取实验单位、计算所需样本大小后，我们终于来到了A/B测试的最后一站：分析测试结果。

在正式开始之前，我想先问你一个问题：拿到测试结果之后，就可以马上进行分析了吗？肯定不行。因为只有确定测试结果值得信赖之后，才可以进行分析。其实，分析A/B测试结果并不难，难的是如何得出值得信赖的结果，从而给业务以正确的指导。

为什么这么说呢？接下来，我就通过一个音乐App要提高用户升级率的例子，和你先拆解下导致测试结果不可靠的因素有哪些，然后再看看具体该怎么分析。

## 案例导入

通常情况下，音乐App有两种盈利模式，一种是提供免费音乐，但是会在App中加广告，通过广告赚钱；一种是让用户付费订阅App，享受高品质的免广告音乐。

我们的这款音乐App是两种盈利模式都有，但是从长期盈利效果和用户体验来看，采用用户付费订阅的模式会更胜一筹。因此，我们计划在双十一前后，针对App里的免费用户做一次促销，吸引他们付费。

现在有这么两条广告语，为了通过A/B测试验证哪条更有效，将其分别放到实验组和对照组：

- 对照组广告语：千万曲库免广告无限畅听，用户升级，免费试用半年！
- 实验组广告语：即日起到11月15日，用户升级，免费试用半年！
<div><strong>精选留言（19）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/16/3e/cf/375ca6bd.jpg" width="30px"><span>贤者时间</span> 👍（5） 💬（1）<div>因为要考虑收益和成本的关系时，除了满足结果在统计上是显著的（两组指标不相同，差值的置信区间不包括 0）还不够，更要让结果在业务上也是显著的（两组指标不仅要不相等，而且其差值δ &gt;= δ收支平衡​，并且差值的置信区间的范围都要比 δ收支平衡​ 大）。

上面这段话的后半部分不太明白，两个方法在统计学上是等价的，那置信区间怎么保证差值δ &gt;= δ收支平衡​呢?我们计算样本量的时候，不是已经考虑到这个差值了吗？那么只要统计上显著，就说明超过这个差值了，不是吗？</div>2020-12-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/3e/cf/375ca6bd.jpg" width="30px"><span>贤者时间</span> 👍（5） 💬（1）<div> 在 保障统计品质的合理性检验 这一节中老师提到，“各组样本量占总样本量的比例也是概率，也是符合二项分布的”，这句话很不理解，为什么这个比例会服从二项分布呢？这里面的总体、样本、样本点分别是什么呢？我理解二项分布是N次独立重复实现发生K次的概率，但是这个想法在这个例子中好像很难套进去。</div>2020-12-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/84/33/b3666d78.jpg" width="30px"><span>吴优秀同学</span> 👍（3） 💬（8）<div>对专栏唯一的抱怨就是更新太慢。在这里请教老师一个问题，在计算样本量的时候我们预估会有10%的提升，然后以此得出样本量进行abtest。最后发现a组和b组之间的比率之差没有达到10%只有3%，但是统计结果是显著的。那是不是意味着我们还要继续进行检验，增加样本量，让我们能够对3%的差异进行检测呢？还是说差异没达到10%，不用进行统计学检测，直接否定这个改变能带来10%的差异这个假设。</div>2020-12-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/3e/cf/375ca6bd.jpg" width="30px"><span>贤者时间</span> 👍（2） 💬（4）<div>请教老师一个问题。假如出现下面这种情况，怎么办：
实验组和对照组经过假设检验后，结果是显著的；
但是对照组指标加上历史波动率之后，实验组指标又没有达到。
（假设其他条件都是满足的。）
那这个结果还是显著的吗？如何对待呢？</div>2021-01-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/23/e3/71/a2a46a9b.jpg" width="30px"><span>西西</span> 👍（2） 💬（1）<div>合理性检验如果没有通过怎么办呢？比如样本量差异过大，应该重新做实验吗？或者在较大的样本量中随机选出和较小样本量差不多的样本进行比较可行吗？</div>2020-12-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/8f/cf/890f82d6.jpg" width="30px"><span>那时刻</span> 👍（1） 💬（1）<div>我们目前使用的护栏指标是DAU和留存，细想了下，感觉可以归入到老师提到的delta收支平衡。不知理解是否正确？

另外请教老师两个问题：
1. 因为要考虑收益和成本的关系时，让结果在业务上也是显著的（两组指标不仅要不相等，而且其差值δ &gt;= delta_收支平衡，并且差值的置信区间的范围都要比 delta 大。为什么同时要求差值的置信区间比delta大呢？
2. 评价指标的波动范围：[1.86%，2.14%]。这数据是依据历史数据算出的么？

另外，体会到老师说到前后文章是有关联的，文中“我们构建了 95% 的置信区间[50%-1.96*0.06%, 50%+1.96*0.06%] = [49.88%,50.12%]”。我迟疑这个1.96，后来在第四章找到，它表示95%置信区间的Z score。通过例子翻阅之前的理论，蛮有意思的，同时也加深印象。</div>2020-12-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/21/e2/0f/19520317.jpg" width="30px"><span>frango</span> 👍（0） 💬（1）<div>老师，能出一版 用公式计算的吗？这用软件算，不同软件包不一样，计算原理也不知道，</div>2021-07-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/f6/88/ee32fde9.jpg" width="30px"><span>章光辉</span> 👍（2） 💬（4）<div>读者贤者时间问的问题确实有可能发生，拿老师的例子为例:
- 实验组：样本量为 315256，升级的用户为 7566，升级率为 2.4%。
- 对照组：样本量为 315174，升级的用户为 6303，升级率为 2.0%。
通过计算发现结果是显著的，但是历史数据表明对照组的升级率在1.5%~2.5%之间波动，所以从历史数据来看实验组又不显著，请问这种情况下要如何分析？</div>2021-06-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2e/21/e2/0146a8ab.jpg" width="30px"><span>飞飞今天学会da了吗</span> 👍（1） 💬（0）<div>老师您好：
下述部分
现在我们已经拿到了如下的测试结果：实验组：样本量为 315256，升级的用户为 7566，升级率为 2.4%。对照组：样本量为 315174，升级的用户为 6303，升级率为 2.0%。因为评价指标的波动范围是[1.86%,2.14%]

我按照  2.0% 加减 根号(0.02*0.98&#47;(315174+315256)) 计算出来的结果与上述结论不同
请问下老师这个结论是按照什么逻辑计算出来的呢？谢谢老师</div>2022-07-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/52/c3/b12e5fe1.jpg" width="30px"><span>嘻嘻大魔王</span> 👍（1） 💬（0）<div>老师，我有一个问题，如果我们这边每次用平台20%流量的uid去做ab测试（大约3000w用户），可观测的指标超过100个，如果每个指标都做z test的话，这个计算量应该如何优化？ 像我们这种hash 分桶的抽样方式是不是已经可以省去检验步骤，直接观测策略对大盘的整体影响了？</div>2021-12-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/4a/32/5605e892.jpg" width="30px"><span>张皓</span> 👍（1） 💬（0）<div>“因为评价指标的波动范围是[1.86%,2.14%]，所以我们可以得出实验组的升级率 2.4% 并不属于正常范围，很有可能显著不同于对照组。”
这个我是怎么算的呢？我根据数据来算，发现对不上</div>2021-10-14</li><br/><li><img src="" width="30px"><span>Geek_7d7659</span> 👍（0） 💬（0）<div>有两个问题请教老师
1、【评价指标的波动范围：[1.86%，2.14%]】，如果对照组对应的评价指标在波动范围内，是不是说明实验组和对照组评价指标不显著，也没必要进行显著性检验了？
2、【会以每周为单位形成周期性的变化，所以我们的测试至少要跑 7 天。而我们通过最小样本量已经算出了本次测试需要跑 10 天，包含了一个周期，所以我们可以放心地把测试时间定为 10 天】：我理解如果一共需要700万样本，每天只能有100万的样本，一共需要7天所有样本才完全进入实验，那第七天进入的样本截至当天也只有1天的测试数据，难道不需要所有样本进入实验后再进行一周的时间吗？</div>2025-02-16</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJW1mt6zS8bNAxbq2tjIPQbSoDUzDgia8Q52Ns7CxxhxaF5GAqbGiam8iaOQyic3fO9lnqVkcOhtNXXSw/132" width="30px"><span>金海涛</span> 👍（0） 💬（0）<div> 想问一个问题，目前我们在比较试验结果显著性的时候，经常采用的是test&amp;control A diff 绝对值大于等于 controlA&amp;control AAdiff， 这种评价方式对吗？</div>2023-10-23</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJW1mt6zS8bNAxbq2tjIPQbSoDUzDgia8Q52Ns7CxxhxaF5GAqbGiam8iaOQyic3fO9lnqVkcOhtNXXSw/132" width="30px"><span>金海涛</span> 👍（0） 💬（0）<div>想问一个问题，目前我们经常在做实验， 针对实验的结果判断是否置信，会考虑</div>2023-10-23</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/36/3d/86/1df02f3c.jpg" width="30px"><span>Adam twe</span> 👍（0） 💬（0）<div>老师python置信区间咋算的啊 网上没找到合适的参数输入</div>2023-04-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/60/1e/5c133cf0.jpg" width="30px"><span>阿东</span> 👍（0） 💬（0）<div>博伟老师你好，请教个问题，假设实验组和对照组各100人，我可以用z检验检验两组的转化人数比例是否有显著差异。那如果100人每个人有不同的转化金额，我可以直接用z检验检验金额的转化率吗？</div>2022-06-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/21/5f/9e1300d3.jpg" width="30px"><span>Mikey</span> 👍（0） 💬（0）<div>如果实验结论预期和后续上线情况不一致，一定是实验出了问题是嘛？</div>2022-04-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/f9/ce/4985c6fc.jpg" width="30px"><span>求知鸟</span> 👍（0） 💬（0）<div>Z检验：一般用于大样本（即样本容量大于30）平均值差异性检验的方法。它是用标准正态分布的理论来推断差异发生的概率，从而比较两个平均数的差异是否显著。在国内也被称作u检验。

T检验：主要用于样本含量较小（例如n &lt; 30），总体标准差σ未知的正态分布。T检验是用t分布理论来推论差异发生的概率，从而比较两个平均数的差异是否显著。

和老师给出的建议有违背？</div>2021-12-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1b/53/25/91e7485e.jpg" width="30px"><span>will_liu</span> 👍（0） 💬（0）<div>每天可以得到的样本量是啥</div>2021-09-23</li><br/>
</ul>