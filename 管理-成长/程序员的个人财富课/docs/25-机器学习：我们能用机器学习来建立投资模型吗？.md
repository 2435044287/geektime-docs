你好，我是王喆。今天我们讲一讲机器学习在投资过程中的应用。

我想，学习这门课的程序员同学，特别是机器学习方向的算法工程师，对今天的话题一定很感兴趣。不是相关方向的同学也不用担心，我会尽量用通俗的语言讲解这节课，你一定也可以掌握这节课的核心知识。

2016年以来，机器学习的发展越来越快，在搜索、推荐、广告等业内方向都得到了成功的应用。同时，也有很多把机器学习应用在投资领域的探索。业内领先的公募基金和私募对冲基金都开设了机器学习部门，这一点从它们公开的招聘信息中就可以看到。但是，由于投资领域不像互联网领域那样，拥有开源、分享的精神，对于投资策略有极其严格的保密机制，因此没有一家成功的投资公司会把自己方案的细节公之于众，这也导致了相关资料的极度稀缺。

今天这一讲，我们当然不可能写一套确保你赚大钱的机器学习策略，但是会结合李腾老师和我对业界的调研，给你讲解**一套已经被业界验证可行的机器学习建模方案**。希望你能以此为起点，在正确的方向上继续探索，通过不断的回测和验证，发现一套基于机器学习模型的投资方法。

## 机器学习模型能解决什么投资问题？

谈起训练机器学习模型进行投资，我想你首先就会想到训练一个模型来炒股。比如，通过模型来预测股票的涨跌，然后只要按照预测结果进行投资就好了。其实机器学习在金融行业的应用范围要宽泛得多。除了直接预测股票涨跌，还有人利用机器学习模型来进行选股，或者是判断某个股票基本面的好坏，进而生成一些高阶的投资因子，这些都取得了非常不错的效果。
<div><strong>精选留言（11）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/16/12/f4/1bf8568e.jpg" width="30px"><span>学要有所用</span> 👍（9） 💬（1）<div>在睡梦里，我认为股票的涨停随着我的想法决定涨或停；

在对未来的期望里，我认为预测未来哪只股票会上涨，完全是小菜一碟；

但当我清醒时，我的理智告诉我：预测分钟级的螺纹钢期货涨跌是比较现实的，因为随着时间的推移，各种不可控因素变得越来越多，时间越长，预测准确度越来越低，只有在较短的时间里，才能将各种影响因素缩小到可控范围，提高预测准确度。股票里的技术分析，诸如KDJ，MACD，布林线等，一般都用来预测短期行情，前期好的行情离得越近，越能判断近期涨势，两个离得近的金叉，比两个离得远的金叉可信度要高，我想这跟股市的瞬息万变强相关，上一秒好的行情可能在下一秒就变差了，时间越长，用于预测的有效信息偏离性越大。

由此可见，越是稳定的走势，越有利于预测分析，我能虽然无法准确预测哪只股票会涨，但是我们可以判断哪些股票较差，基于这一点，可不可以利用机器学习使用相同数据周期性进行预测呢？比如：对近期的股票以周为单位进行一次技术分析，通过综合对比，剔除以周为单位走势较差的股票，留下相对平稳的股票，待大范围选取相对好的股票后，再以天为单位对股票进行预测。</div>2021-09-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/47/5d/9afdf648.jpg" width="30px"><span>Link</span> 👍（4） 💬（1）<div>感觉这段时间和实战相关的知识比较多，需要通过动手和练习来掌握。</div>2021-09-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/12/f4/1bf8568e.jpg" width="30px"><span>学要有所用</span> 👍（1） 💬（1）<div>如果仅是用于投资，需不需要专门去学习机器学习？如果需要，学哪些就够了？</div>2021-09-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/7b/bd/ccb37425.jpg" width="30px"><span>进化菌</span> 👍（1） 💬（1）<div>用机器学习模型寻找下一周可能上涨的行业，我认为这个比较适合。
判断行业趋势的准确性，机器有大数据分析处理的优势，准确性会更高一些~</div>2021-09-08</li><br/><li><img src="https://wx.qlogo.cn/mmopen/vi_32/TYeIuNZlibjr0eCvnCCTkYnFEgc8t7BialET3Bnsrbv9micpGIvbhwQrw7Zvt9BicThAEPPXojibVteAvQLb0eTO3DA/132" width="30px"><span>cymx66688</span> 👍（1） 💬（2）<div>王喆老师，想请教下，股票或基金的历史数据可以从哪里获取呀</div>2021-09-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/34/aa/431de942.jpg" width="30px"><span>dbtiger</span> 👍（0） 💬（1）<div>思考：
我认为“我想训练一个分钟级别的预测螺纹钢期货涨跌的模型”更适合机器学习方式解决，因为条件明确，规模小（单一期货、时间限制1分钟）。

这章不明觉厉！</div>2021-09-08</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKms5faiaqcTQ0fmqZoAfsVPeZQYZib7CIWJfLCvSLWia1XaoNGpP2M9G2woDdvaIVUYfWPBJa8nLs9A/132" width="30px"><span>Geek_Rex</span> 👍（0） 💬（0）<div>如果希望使用机器学习框架，比如预测：标普500(spx)， 或者沪深300一个月以后的点位或涨跌，哪一个模型比较适合这种场景？为什么？ 尝试过LSTM， 预测效果较差，准确度&lt;50%, 还不如扔硬币。</div>2024-12-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/3e/90/c86ec4ca.jpg" width="30px"><span>Chengfei.Xu</span> 👍（0） 💬（0）<div>回答：
1、只是根据我个人散户能力的话，我会利用机器学习去预测一个分钟级别的预测螺纹钢期货涨跌的模型，相对而言成功率会高一点；
2、认同作者作为散户的看法，一定要把有限的时间用在解决一个相对规模较小、更精细化的领域内，只有这样建立生态位，才有可能在一个点上打败专业机构；
3、以上，我认为在更宏观的预测可能上涨的行业，以及“玄学”的预测涨停股票对我而言难度会太大。</div>2023-12-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/27/02/65/ddb6460e.jpg" width="30px"><span>柯里</span> 👍（0） 💬（0）<div>越学越觉得自己任重而道远</div>2023-10-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/b7/b4/33ccf207.jpg" width="30px"><span>whileflow</span> 👍（0） 💬（0）<div>对于散户来说，适合长线投资，要用机器学习方法的话，可以选用比较稳定的股票，按较长的时间区间来采样和预测比较合适吧</div>2022-11-19</li><br/><li><img src="" width="30px"><span>Yang Hong</span> 👍（0） 💬（0）<div>老师您在文中提到了“金融数据里的噪声更大，很多数据点都是杂乱的随机波动”，我想在数据清洗过程中应该需要对数据平滑处理去噪吧？但是这样是否也会损失有用的信息，您平常是如何平衡这两者的呢？</div>2022-04-08</li><br/>
</ul>