今天开始，我们要进入到计算机另一个重要的组成部分，存储器。

如果你自己组装过PC机，你肯定知道，想要CPU，我们只要买一个就好了，但是存储器，却有不同的设备要买。比方说，我们要买内存，还要买硬盘。买硬盘的时候，不少人会买一块SSD硬盘作为系统盘，还会买上一块大容量的HDD机械硬盘作为数据盘。内存和硬盘都是我们的存储设备。而且，像硬盘这样的持久化存储设备，同时也是一个I/O设备。

在实际的软件开发过程中，我们常常会遇到服务端的请求响应时间长，吞吐率不够的情况。在分析对应问题的时候，相信你没少听过类似“主要瓶颈不在CPU，而在I/O”的论断。可见，存储在计算机中扮演着多么重要的角色。那接下来这一整个章节，我会为你梳理和讲解整个存储器系统。

这一讲，我们先从存储器的层次结构说起，让你对各种存储器设备有一个整体的了解。

## 理解存储器的层次结构

在有计算机之前，我们通常把信息和数据存储在书、文件这样的物理介质里面。有了计算机之后，我们通常把数据存储在计算机的存储器里面。而存储器系统是一个通过各种不同的方法和设备，一层一层组合起来的系统。下面，我们把计算机的存储器层次结构和我们日常生活里处理信息、阅读书籍做个对照，好让你更容易理解、记忆存储器的层次结构。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/60/71/895ee6cf.jpg" width="30px"><span>分清云淡</span> 👍（12） 💬（2）<div>DRAM和SSD之间还有个NVM</div>2019-08-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/34/df/64e3d533.jpg" width="30px"><span>leslie</span> 👍（7） 💬（2）<div>       老师本节课都在讲存储的访问速度：强调的是设备之间的访问速度，90年代是我的高中时代，印象里那会儿一切的copy用的主要都还是软盘，那会儿似乎没有光盘，应当是它的便携性和访问速度快；毕竟那个时代网络还是电话线-软盘的携带性方便，硬盘其实同样是由多张盘构成的-其中涉及到寻址时间导致访问缓慢。</div>2019-08-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/56/c6/0b449bc6.jpg" width="30px"><span>斐波那契</span> 👍（51） 💬（1）<div>哎 这个问题一下就暴露年龄了 当年3.5寸磁盘又叫软盘 非常小巧 在windows中一般是A盘 里面放了当时做的ppt 文档什么的 后来被u盘取代 一开始u盘还要装驱动 后来xp系统不用自己装驱动就能用u盘一下子把这个软盘💾取代了</div>2019-07-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/e7/2e/1522a7d6.jpg" width="30px"><span>活的潇洒</span> 👍（25） 💬（0）<div>“你可以把CPU中的L1 Cache理解为我们的短期记忆，把L2&#47;L3 Cache理解成长期记忆，把内存当成我们拥有
的书架或者书桌。 当我们自己记忆中没有资料的时候，可以从书桌或者书架上拿书来翻阅。这个过程中就
相当于，数据从内存中加载到CPU的寄存器和Cache中，然后通过“大脑”，也就是CPU，进行处理和运算”
这一段精彩了，佩服老师

day35 笔记：https:&#47;&#47;www.cnblogs.com&#47;luoahong&#47;p&#47;11328671.html</div>2019-08-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/cf/96/251c0cee.jpg" width="30px"><span>xindoo</span> 👍（16） 💬（1）<div>8 90年代，虽然硬盘容量比磁盘大，但体积也大，价格也更高。磁盘体积小，价格低，携带方便，同体积下的硬盘和磁盘，当然是磁盘容量更大，价格更低，所以肯定是大家存储数据的首选。</div>2019-07-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/54/19/95ff4cbd.jpg" width="30px"><span>格非</span> 👍（4） 💬（6）<div>老师，比如CPU标明四核八线程，理论上，一个核只能处理一个线程，怎么这线程数是核数的两倍呢</div>2019-07-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/74/60/0403b575.jpg" width="30px"><span>林三杠</span> 👍（4） 💬（0）<div>应该是便携性比较好，价格也比较容易接受，而且当时需要便携性好的文件普遍没有那么大，综合下来，软盘才会风靡一时吧。后来就是u盘的天下了</div>2019-07-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/22/7d/a6/15798bf2.jpg" width="30px"><span>温雅小公子</span> 👍（2） 💬（1）<div>各个存储器只和相邻的一层存储器打交道，那cpu为什么能跨过cache，利用寄存器从内存读写数据捏？</div>2022-11-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/22/e1/7a/b206cded.jpg" width="30px"><span>人在江湖龙在江湖</span> 👍（2） 💬（0）<div>当时的软盘相当于现在的u盘，即插即用，可以当做系统启动盘，装系统或者应用程序，第二软盘远比硬盘便宜</div>2020-11-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/ee/28/c04a0c83.jpg" width="30px"><span>小炭</span> 👍（2） 💬（0）<div>了解了这些存储器设备特性对于架构设计至关重要。</div>2020-11-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/39/fa/a7edbc72.jpg" width="30px"><span>安排</span> 👍（2） 💬（3）<div>老师，双路四核CPU和单路四核CPU有什么区别？还有这个双路是指主板上有两个CPU插槽，插两个CPU就叫双路吗？</div>2019-07-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2b/1a/cd/12006c16.jpg" width="30px"><span>不是程序员的lisen</span> 👍（1） 💬（0）<div>这个大脑获取信息的类别太赞了～
哈哈，这节课让我想起了《三体》：在太阳系毁灭之际，人类为了尽量持久的保存人类文明的信息，最终把有限的信息刻在了石头上</div>2023-03-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/22/7d/a6/15798bf2.jpg" width="30px"><span>温雅小公子</span> 👍（1） 💬（0）<div>
最后计算存储器价格这个我算不明白了。

• cpu每个核有32k（Q1: 这个在哪看到的？）四核一共128k的L1指令Cache，价格 = 128k * 7$&#47;M = 0.875$；
• 还有128k的L1数据Cache，价格为0.875$；（Q2: 几路相连的放置策略是什么？）
• 每个核有256k的L2 Cache，价格 = 256k * 4 * 7 $&#47;M = 7 $;
• 多喝核心共用的12M L3 Cache (Q3: 这个大小怎么出来的？），价格 = 12 * 7 = 84 $；
• 综上，价格为 92.75$。
• 又，内存8G，价格122.88$；SSD硬盘128G ，价格52.4288$; HDD硬盘1T, 价格 41.94$；总价为217.25。

感觉这不是差不多啊，这比高速缓存多了好多钱呢。</div>2022-10-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/22/7d/a6/15798bf2.jpg" width="30px"><span>温雅小公子</span> 👍（1） 💬（0）<div>计算机领域，复杂的系统都要分层，比如存储器和网络。</div>2022-10-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/23/78/7b/09defb8d.jpg" width="30px"><span>Yongtao</span> 👍（1） 💬（0）<div>SRAM CPU高速缓存 1比特需要6个晶体管
DRAM 内存 1比特需要1个晶体管和3个电容
电容需要动态的充电刷新，所以dynamic</div>2021-06-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/68/ed/b5a41e95.jpg" width="30px"><span>张明云</span> 👍（1） 💬（0）<div>将各种存储介质比作大脑获取信息的不同来源很形象，很清晰地表达了意思，很赞。</div>2020-04-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/69/bf/58f70a2a.jpg" width="30px"><span>程序员花卷</span> 👍（1） 💬（0）<div>学习了这一章，我立马详细的研究了一下我电脑的配置！哈哈，点赞</div>2019-12-22</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/81/e9/d131dd81.jpg" width="30px"><span>Mamba</span> 👍（0） 💬（0）<div>尽管3.5寸磁盘的存储空间只有1.44MB，但在当时的历史背景下，它因其便携性、兼容性、成本效益以及相对充足的存储能力而成为了主流的存储选择。随着时间的推移，计算机技术的快速发展，软盘最终被其他更高效、容量更大的存储介质所取代。</div>2024-09-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/81/e9/d131dd81.jpg" width="30px"><span>Mamba</span> 👍（0） 💬（0）<div>有个疑惑，虽然如今这样金字塔型的存储结构看似非常合理地平衡了存储空间和存取速度，但这样一层层传递，那么不会因为传递过程而拖慢速度嘛？</div>2024-09-02</li><br/><li><img src="" width="30px"><span>Geek_88604f</span> 👍（0） 💬（0）<div>分层存储是构建大型存储系统的基本架构。对于很少访问的数据可以考虑存储到磁带上。成本更加便宜，只不过访问速度更慢，要访问磁带上的数据需要提前申请。</div>2023-12-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/50/2b/2344cdaa.jpg" width="30px"><span>第一装甲集群司令克莱斯特</span> 👍（0） 💬（0）<div>极好的课程。</div>2022-12-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/17/e0/c5/c324a7de.jpg" width="30px"><span>jorin@zou</span> 👍（0） 💬（0）<div>越学到后面，评论越少了</div>2022-06-19</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJpJXWFP3dNle88WnTkRTsEQkPJmOhepibiaTfhEtMRrbdg5EAWm4EzurA61oKxvCK2ZjMmy1QvmChw/132" width="30px"><span>唐江</span> 👍（0） 💬（1）<div>老师说dram 数据是保存在一个晶体管和一个电容里面的，具体怎么保存的呢？或者可以从哪里查到这方面的资料呢</div>2021-05-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/7f/22/d670af4a.jpg" width="30px"><span>邱マン</span> 👍（0） 💬（0）<div>老师讲的真棒👍通俗易懂</div>2021-05-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/99/c3/e4f408d4.jpg" width="30px"><span>陌兮</span> 👍（0） 💬（0）<div>总算明白了各个存储的物理结构了</div>2021-03-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/fe/83/df562574.jpg" width="30px"><span>慎独明强</span> 👍（0） 💬（0）<div>看了这么多章节，想把这节的东西记录下来，之前很多都是囫囵吞枣，这一张看懂了。从层级来看，寄存器-cpu三级高速缓存-主内存-固态硬盘-机械硬盘。  每个层级之能相近之间访问。想到之前学的内存模型，主内存，cpu，总线，寄存器，写缓冲器，无效队列等来保证缓存一致性，结合这个存储器层次结构理解起来就容易多了。对于这些知识可以先囫囵吞枣去读，当积累了其他知识后，感觉会豁然开朗</div>2021-03-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/6d/87/21e516ec.jpg" width="30px"><span>林杨</span> 👍（0） 💬（0）<div>DRAM和SSD之间，还有一层intel的Optane的非易失内存。性能和成本也是介于两者之间。</div>2021-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/71/22/b8c596b6.jpg" width="30px"><span>风</span> 👍（0） 💬（0）<div>我们常常把 CPU 比喻成高速运转的大脑，那么和大脑同步的寄存器（Register），就存放着我们当下正在思考和处理的数据。而 L1-L3 的 CPU Cache，好比存放在我们大脑中的短期到长期的记忆。我们需要小小花费一点时间，就能调取并进行处理。
我们自己的书桌书架就好比计算机的内存，能放下更多的书也就是数据，但是找起来和看起来就要慢上不少。而图书馆更像硬盘这个外存，能够放下更多的数据，找起来也更费时间。从寄存器、CPU Cache，到内存、硬盘，这样一层层下来的存储器，速度越来越慢，空间越来越大，价格也越来越便宜。
这三个“越来越”的特性，使得我们在组装计算机的时候，要组合使用各种存储设备。越是快且贵的设备，实际在一台计算机里面的存储空间往往就越小。而越是慢且便宜的设备，在实际组装的计算机里面的存储空间就会越大。</div>2020-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/71/22/b8c596b6.jpg" width="30px"><span>风</span> 👍（0） 💬（0）<div>从 Cache、内存，到 SSD 和 HDD 硬盘，一台现代计算机中，就用上了所有这些存储器设备。其中，容量越小的设备速度越快，而且，CPU 并不是直接和每一种存储器设备打交道，而是每一种存储器设备，只和它相邻的存储设备打交道。比如，CPU Cache 是从内存里加载而来的，或者需要写回内存，并不会直接写回数据到硬盘，也不会直接从硬盘加载数据到 CPU Cache 中，而是先加载到内存，再从内存加载到 Cache 中。</div>2020-10-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/e0/6b/f61d7466.jpg" width="30px"><span>prader26</span> 👍（0） 💬（0）<div>计算机中的存储空间包括，lL1cache  L2cache  L3cache  内存   和硬盘</div>2019-10-12</li><br/>
</ul>