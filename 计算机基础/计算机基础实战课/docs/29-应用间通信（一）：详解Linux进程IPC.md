你好，我是LMOS。

通过前面的学习，我们对进程有了一定的认知，进程之间是独立的、隔离的，这种安排，使得应用程序之间绝对不可以互相“侵犯”各自的领地。

但是，应用程序之间有时需要互相通信，互相协作，才能完成相关的功能。这就不得不由操作系统介入，实现一种通信机制。在这种通信机制的监管之下，让应用程序之间实现通信。Linux实现了诸如管道、信号、消息队列、共享内存，这就是Linux进程IPC。我们用两节课的时间，分别讨论这些通信机制。这节课，我们先学习管道和信号。

课程的配套代码，你可以从[这里](https://gitee.com/lmos/Geek-time-computer-foundation/tree/master/lesson29~30)下载。

### 管道

顾名思义，通常管道就是你家一端连接着水池，另一端连着水龙头的、能流通水的东西。在Linux中管道作为最古老的通信方式，它能把一个进程产生的数据输送到另一个进程。

比方说，我们在shell中输入“ls -al / | wc -l”命令来统计根目录下有多少文件和目录。该命令中的“|”就是让shell创建ls进程后建立一个管道，连接到wc进程，使用ls的输出经由管道输入给wc。由于ls输出的是文本行，一个目录或者一个文件就占用一行，wc通过统计文本行数就能知道有多少目录和文件。

下面我们手动建立一个管道，代码如下所示：
<div><strong>精选留言（5）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/19/ae/c3/d930693b.jpg" width="30px"><span>LockedX</span> 👍（2） 💬（1）<div>管道：原理上是通过共享文件来实现的，优点是能够传输任意信息，缺点是只能单向传输
信号：原理上是通过中断来实现的，优点是异步通信并且某些信号可以自定义函数，缺点是只能传递固定的信号</div>2022-10-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（2） 💬（1）<div>老师的课很不错啊，请教几个问题：
Q1：管道能否用于非父子进程之间的通信？
文中管道例子的两个进程是父子进程，使用了fork。假如两个进程不是通过fork产生的，即不是父子关系，那么，这两个进程可以通过管道通信吗？
注：对于信号，同样存在这个问题：信号能否用于非父子进程之间的通信？(没有用fork)

Q2：管道读取端的文件句柄被关闭后，是自动调用write，还是进程调用write时返回0？
文中这句话“如果所有管道写入端对应的文件句柄被关闭，则进程调用 read 时将返回 0；如果所有管道的读取端对应的文件句柄被关闭，则会调用 write，从而产生 SIGPIPE 信号，这可能导致调用 write 进程退出”。 这句话有两个“如果”，前一个“如果”是讲写入端，结果是“read会返回0”。后一个“如果”是讲读取端，感觉应该是对称的啊，对称的话，后半部分应该是“则进程调用 write 时将返回 0”。但文中写的是“则会调用 write”，给人的感觉就是“文件句柄关闭后，即使进程没有调用wirte，也会有个东西自动调用write”。 请问：这里是笔误吗？ 假如不是笔误，是谁自动调用write？是内核自动调用吗？

Q3：管道内部的缓冲可以设置吗？

Q4：应用进程可以给Linux内核发送信号吗？

Q5：信号例子的死循环会导致系统卡死吗？
信号例子的代码中，循环代码“while(1)  {    ;&#47;&#47; 死循环防止进程退出  }” ，循环体中什么都没有，没有阻塞，没有等待，会导致系统卡死吗？

Q6：Hello OS可以安装在虚拟机上吗？
我正在看老师的另外一门课《操作系统实战45讲》，其中第02课是讲Hello OS的。这个Hello OS是安装在Linux下。我没有专门的Linux电脑，我的笔记本是 win10，用VMWare安装了Ubuntu22虚拟机。请问，Hello OS可以安装在此Ubuntu22虚拟机下吗？</div>2022-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/41/62/33520c3e.jpg" width="30px"><span>贾献华</span> 👍（1） 💬（2）<div>SIGQUIT 应该是 Ctrl+\ 控制吧！</div>2022-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/29/a6/ad/e65aec4c.jpg" width="30px"><span>苏流郁宓</span> 👍（1） 💬（1）<div>管道需要信号调节的（从一个进程数据传输到另一个进程）
在同一时间只允许单向传输（谁是输出方谁是接受方由信号调节决定）？</div>2022-09-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2c/c7/89/16437396.jpg" width="30px"><span>极客酱酱</span> 👍（0） 💬（1）<div>goroutiner 可以实现类似进程通信的机制吗？好像不能获取到goroutiner 的id，那怎么通知呢？</div>2022-11-02</li><br/>
</ul>