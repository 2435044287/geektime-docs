你好，我是LMOS。

通过上一节课的学习，我们已经清楚了C语言可以把程序抽象成一个函数，这样的函数又抽象成表达式和流程控制，表达式又能进一步抽象成各种类型的变量和各种运算符。并且我们还搞懂了**变量就是数据，运算符就是操作，而变量的运算结合起来就能对数据施加操作。**这样拆分下来，是不是C语言就没那么神秘了？

今天，让我们就来继续揭秘C语言编译器的日常工作，搞清楚各种类型变量、各种运算符、流程控制以及由它们组成的函数，是如何对应到机器指令的（代码从[这里](https://gitee.com/lmos/Geek-time-computer-foundation/tree/master/lesson15)下载）。

此外，我还会带你了解函数间的调用规范，这能让我们在以后写代码时，清楚自己的每行代码都会被编译器转化为什么样的机器指令。

### C变量

现在，我们从最基本的C语言的变量开始说起。

C语言是如何把各种类型的变量转换成对应的汇编语言呢？高级语言更容易被工程师理解，而汇编语言这样的低级语言，则更容易被机器解读。这是**因为汇编语言里的大部分内容都跟机器语言一一对应，你可以这样理解，汇编语言就是把机器语言符号化。**

我举个例子让你加深理解，机器对应的加法指令是一段很长的二进制数据，在汇编语言中，这个指令就对应着“add”这个指令。无论是机器指令还是寄存器，经过汇编语言“翻译”出来都是符号。
<div><strong>精选留言（3）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/19/ae/c3/d930693b.jpg" width="30px"><span>LockedX</span> 👍（3） 💬（1）<div>结构体要根据是否指针传递来判断传参方式：
1. 值传递
这种情况下，会把结构体里面的变量当作参数来传递，有多少个参数就会使用多少个参数寄存器，和多参数函数传参一样
2. 指针传递
这个时候用a0寄存器传递指针就可以完成结构体参数传递

所以尽量用指针传递结构体参数（只利用了一个寄存器）能提高性能</div>2022-09-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/19/8b/06/fb3be14a.jpg" width="30px"><span>TableBear</span> 👍（2） 💬（1）<div>根据C变量那一节的内容，结构体的存储格式是一块整齐的连续内存，里面聚合了各种类型的变量。所以C语言函数传递结构体类型参数时，应该是将整个结构体拆散，然后每种类型的字段按照对应的传参方式进行传递。</div>2022-08-30</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/29/a6/ad/e65aec4c.jpg" width="30px"><span>苏流郁宓</span> 👍（1） 💬（1）<div>请问 C 语言函数如何传递结构体类型的参数呢？
建立栈模型？（一类先进后出的数据类型），但栈是加载到内存上，也就是加到cpu内部，就是一组组数据指令，实际上，cpu运算器90%以上的时间是和寄存器与cache打交道，毕竟从内存直接取数据效率过低！
纵然如此，cpu的浪费也是惊人的（意味着，仍然有很多资源没有充分利用好，就比如维护数据一致性导致的浪费）
俺有个不懂的问题。由于内存到cpu的时间效率低于cpu内部效率，那能不能优化数据结构，把命中率高的数据在cpu运算时，加载到cache上？（这个加不加载到cache上应该是硬件工程师考虑的吧），方便及时取数据！</div>2022-08-29</li><br/>
</ul>