今天我们继续上次的话题，看看HTTP性能优化有哪些行之有效的手段。

上一讲里我说到了，在整个HTTP系统里有三个可优化的环节，分别是**服务器**、**客户端**和**传输链路**（“第一公里”和“中间一公里”）。但因为我们是无法完全控制客户端的，所以实际上的优化工作通常是在服务器端。这里又可以细分为后端和前端，后端是指网站的后台服务，而前端就是HTML、CSS、图片等展现在客户端的代码和数据。

知道了大致的方向，HTTP性能优化具体应该怎么做呢？

总的来说，任何计算机系统的优化都可以分成这么几类：硬件软件、内部外部、花钱不花钱。

**投资购买现成的硬件**最简单的优化方式，比如换上更强的CPU、更快的网卡、更大的带宽、更多的服务器，效果也会“立竿见影”，直接提升网站的服务能力，也就实现了HTTP优化。

另外，**花钱购买外部的软件或者服务**也是一种行之有效的优化方式，最“物有所值”的应该算是CDN了（参见[第37讲](https://time.geekbang.org/column/article/120664)）。CDN专注于网络内容交付，帮助网站解决“中间一公里”的问题，还有很多其他非常专业的优化功能。把网站交给CDN运营，就好像是“让网站坐上了喷气飞机”，能够直达用户，几乎不需要费什么力气就能够达成很好的优化效果。

不过这些“花钱”的手段实在是太没有“技术含量”了，属于“懒人”（无贬义）的做法，所以我就不再细说，接下来重点就讲讲在网站内部、“不花钱”的软件优化。
<div><strong>精选留言（30）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/11/30/8a/b5ca7286.jpg" width="30px"><span>业余草</span> 👍（17） 💬（4）<div>70门课程，看完了50门。后面空闲下来继续看2遍！</div>2019-09-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg" width="30px"><span>钱</span> 👍（13） 💬（0）<div>哈哈，都是夸老师的，在极客时间买了一堆专栏，别的不敢说，判断一个专栏的优劣的能力是给锻炼出来了。和买东西很类似，销量多、评论多（如果引起不了共鸣老实讲会懒得评论）、老师回复多、且比较有耐心（能感受到）这课程绝对值，如果能通俗易懂的讲出来，那功力就更强了，另外，姜还是老的辣，年轻又优秀的也非常多，不过有时能感觉到功力还是不行。说了这么多，最后想说的是老师在佼佼者中也是佼佼者。
感谢分享，这钱花的太值了（其实钱不多也不重要，时间和精力才是最宝贵的，如果学了感觉啥用没有就太沮丧了）</div>2020-04-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/5c/3f/34e5c750.jpg" width="30px"><span>看，有只猪</span> 👍（13） 💬（1）<div>这是我30门极客时间课程中第一门完整学完的课程，感谢老师通俗易懂的讲解，让我又新学到很多关于HTTP的知识点。跟着这门课程记录笔记，整理完后，整个结构清晰明了。老师按功能讲解字段的方法，让我知道了哪些功能会涉及哪些字段，不会再像以前那么模糊了，期待老师下一门课程</div>2019-09-03</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/0d/40/f70e5653.jpg" width="30px"><span>前端西瓜哥</span> 👍（9） 💬（1）<div>老师写得太好了，学到了很多很多东西。靠着在这篇专栏学到的 HTTP 知识，我在几天前也是拿到了一个大公司的offer，太高兴了。
另外这篇专栏也是我第一个从头到尾没有掉队的专栏，写得真的不错！感谢老师带给我们这么棒的专栏！</div>2019-08-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/77/e5/eed499a6.jpg" width="30px"><span>Geek_hfbm3l</span> 👍（4） 💬（1）<div>老师的课讲的非常好，每节课都看的非常明白，而且每个问题都很认真的回答，想问下老师接下来还打算开什么课吗？个人很希望老师讲讲 tcp ip 有关的。或者还有什么其它渠道能关注到老师吗？比如博客？</div>2019-08-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/db/64/06d54a80.jpg" width="30px"><span>中年男子</span> 👍（3） 💬（1）<div>老师，不太理解 为什么一个网站有多个域名，解析域名获得ip会是不小的成本，需要收缩，是因为访问一个url内部会出现多次访问不同的地址的原因吗？
不是web开发，不太理解这些。</div>2020-04-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg" width="30px"><span>Demon.Lee</span> 👍（2） 💬（1）<div>c++11、Boost、OpenResty，不过还要看有多少读者想要了
---
I want! 
老师尽管出，我一定支持！（老师也要注意休息，身体第一！）
感恩！！
</div>2019-11-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/7b/10/723a149c.jpg" width="30px"><span>何某人</span> 👍（2） 💬（1）<div>吹爆Chrono老师，课程又专业又通俗易懂。让身为网络小白的我受益匪浅。期待老师的新一门课程！！！另外看了老师的课后老师的书我也都买了哈哈。</div>2019-08-29</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg" width="30px"><span>ifelse</span> 👍（1） 💬（1）<div>感谢老师，学到了很多知识，长见识了。</div>2023-02-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/6c/d4/85ef1463.jpg" width="30px"><span>路漫漫</span> 👍（1） 💬（1）<div>谢谢老师，我学完了，4周记了70页的笔记。作为一个前端我的http终于入门了。感谢老师的耐心回复让我及时解惑，让我觉得学习的路上有人陪伴，从不孤独。谢谢老师，希望老师能出更多的精品课程，让知识能够改变更多人的生活！</div>2021-11-26</li><br/><li><img src="" width="30px"><span>Geek_3e1530</span> 👍（1） 💬（1）<div>老师，赶紧出一个关于nginx和openrestry的课吧</div>2021-07-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/cd/94/0d44361e.jpg" width="30px"><span>Jerryz</span> 👍（1） 💬（1）<div>首先，文字+音频的专栏确实比视频的专栏信息密度更高。也更适合学习。
再则，作为一个前端工程师学习 HTTP 原理确实和后端谈接口的时候更有信心了。
老师的专栏质量很高，也确实做了深入浅出。
点个赞。</div>2021-04-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/ed/a9/662318ab.jpg" width="30px"><span>我母鸡啊！</span> 👍（1） 💬（1）<div>完结～ 认真的学完了第一遍～ 第二遍继续～</div>2020-05-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg" width="30px"><span>lesserror</span> 👍（1） 💬（1）<div>老师，这里指的是多级域名的意思嘛？

DNS 解析域名会耗费不少的时间，如果网站拥有多个域名，那么域名解析获取 IP 地址就是一个不小的成本，所以应当适当“收缩”域名，限制在两三个左右，减少解析完整域名所需的时间，让客户端尽快从系统缓存里获取解析结果。</div>2020-01-01</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/21/cf/f47e092d.jpg" width="30px"><span>咕咕咕</span> 👍（1） 💬（1）<div>非常好的专栏，让我对于HTTP知识有了一个系统性的认知，但是后面还需要结合实际经验反复学习加深印象。非常期待老师的下一门专栏！</div>2019-12-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg" width="30px"><span>QQ怪</span> 👍（1） 💬（1）<div>感谢老师的分享，感谢老师的陪伴，学到了很多东西</div>2019-08-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/37/e3/c5/10fb4460.jpg" width="30px"><span>HAX</span> 👍（0） 💬（1）<div>课程学完了，不，应该是第一遍学完了，内容确实很棒，之前我都不知道http里面还有这么多门道，工作中更多的只是CRUD，然后就是接口请求，响应，传输数据，都没有深入思考过这背后的网络世界，很是惭愧。接下来，我将更加深入的学习，毕竟兴趣来了，就要好好享受学习的乐趣，哈哈。感谢罗老师。</div>2023-07-14</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKq0oQVibKcmYJqmpqaNNQibVgia7EsEgW65LZJIpDZBMc7FyMcs7J1JmFCtp06pY8ibbcpW4ibRtG7Frg/132" width="30px"><span>zhoufeng</span> 👍（0） 💬（1）<div>老师好，
课外小贴士里说的第1点，“增大初始拥塞窗口”这个是怎么做的，接收窗口倒是可以通过内核参数调大，包括window_scaling也是针对的接收窗口。</div>2022-08-27</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/9a/ab/fd201314.jpg" width="30px"><span>小耿</span> 👍（0） 💬（1）<div>感谢老师，学到很多！</div>2022-05-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/29/b0/d3/200e82ff.jpg" width="30px"><span>功夫熊猫</span> 👍（0） 💬（1）<div>我感觉解耦和缓存真的是计算机两个法宝。解耦可以试代码的逻辑性变强，比如计算机网络的分层，前后端的分离。而缓存就是加快速度的一个方法</div>2021-10-31</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1e/f2/f5/b82f410d.jpg" width="30px"><span>Unknown element</span> 👍（0） 💬（1）<div>对于 HTTP&#47;2 来说，一个域名使用一个 TCP 连接才能够获得最佳性能，如果开多个域名，就会浪费带宽和服务器资源，也会降低 HTTP&#47;2 的效率
这里说的不太对吧  http1里的并发连接不也是链接到同一个域名吗  域名分片是为了使服务器可以支持更多的连接 所以对同一个ip注册了多个域名 这样服务器总的最大并发连接数就是它们的和</div>2021-06-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/24/22/4e/2e081d9c.jpg" width="30px"><span>hao</span> 👍（0） 💬（1）<div>老师有个问题想请求一下，HTTP&#47;2中，为何开多个域名对应一个IP地址（域名分片实现并发连接），会浪费带宽和服务器资源 ？

- HTTP&#47;1中存在  `HTTP&#47;1的队头阻塞`  ，可以通过域名分片来缓解  `HTTP&#47;1的队头阻塞`（建立了多个TCP连接）
- 而HTTP&#47;2通过 `流`  实现  `多路复用`  从而解决  `HTTP&#47;1的队头阻塞`，且它是基于一个TCP连接，所以开多个域名对应一个IP地址，白白浪费建立好的TCP连接，又用不上它

</div>2021-06-05</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/6zQbmug198ru2uHRqIXScft6mZP7picwb6XN6iaXK0jet9PhnfuWqRbZl2kt9Ng257cajpHhtAY2Wia5ddgcwkBwQ/132" width="30px"><span>syjs</span> 👍（0） 💬（1）<div>谢谢罗老师教了我那么多的知识</div>2020-11-28</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL9wR9gRmCjmsUfdWRa1Ua0AibfjzrDFl5KSe6hBLT4ghLYIFHmibGVQ7yibc3k4jwVd8iatGyicUKXMRA/132" width="30px"><span>Seven</span> 👍（0） 💬（1）<div>通俗易懂，给 Chrono 大拿手动点赞
必须推荐给其他小伙伴来买这个专栏
</div>2020-11-18</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL9wR9gRmCjmsUfdWRa1Ua0AibfjzrDFl5KSe6hBLT4ghLYIFHmibGVQ7yibc3k4jwVd8iatGyicUKXMRA/132" width="30px"><span>Seven</span> 👍（0） 💬（1）<div>花了三天时间，一口气看完了整个专栏。毕竟前端出身，破冰篇、基础篇、进阶篇的内容，相当于是知识复习，看的快一点。而之前一知半解的 HTTPS 细节，在安全篇里了解到了详细、丰富的知识点，当然还没完全掌握，需要再二刷或者三刷下安全篇。</div>2020-11-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/81/e6/6cafed37.jpg" width="30px"><span>旅途</span> 👍（0） 💬（1）<div>老师 一个域名使用一个tcp连接就够了 这点没看懂 多个客户端和服务器连接 他们的端口都是不同的吧 怎么使用一个tcp连接就可以了呢</div>2020-08-21</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/2b/39/19041d78.jpg" width="30px"><span>😳</span> 👍（0） 💬（1）<div>感谢老师的分享，课程讲的很透彻，通俗易懂，质量很高，也学到了很多新东西，对以前的知识也有了巩固。</div>2020-05-24</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/bb/82/5a32de87.jpg" width="30px"><span>泷沁心</span> 👍（0） 💬（1）<div>http 启蒙老师 - Chrono老师</div>2020-05-02</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/96/5a/846a09f7.jpg" width="30px"><span>pony</span> 👍（0） 💬（1）<div>性能优化上还是很有启发，总结的到位</div>2020-04-25</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/cb/92/3dbeb6ab.jpg" width="30px"><span>池强泽</span> 👍（0） 💬（1）<div>学习了，讲的很好</div>2020-02-16</li><br/>
</ul>