你好，我是黄申。

你平时应该见过手机App推送的新闻吧？你有没有觉得这些App的推荐算法很神奇？它们竟然可以根据你的喜好来推荐新闻。想要实现这些推荐算法，有一个非常重要的步骤就是给新闻分类。可是，新闻头条这种综合性的平台，需要处理的新闻都是海量的，我们不可能完全靠人工手动处理这些事情。这个时候，我们就要用到计算机技术，来对文本进行自动分类。

上一节，我给你介绍了如何利用朴素贝叶斯方法，教会计算机进行最基本的水果分类。基于水果分类，今天我们继续深入分类这个话题，告诉你如何利用自然语言处理和朴素贝叶斯方法，对新闻这种长篇文本进行分类。

## 文本分类系统的基本框架

想要实现一个完整的文本分类系统，我们通常需要进行这些步骤：

### 1.采集训练样本

对于每个数据对象，我们必须告诉计算机，它属于哪个分类。上一节的水果案例里，我们给每个水果打上“苹果”“甜橙”和“西瓜”的标签，这就是采集训练样本。

同样，我们可以给每一篇新闻打上标签，也就是说，我们首先要分辨某条新闻是什么类型的，比如是政治的、军事的、财经的、体育的，还是娱乐的等等。这一点非常关键，因为分类标签就相当于计算机所要学习的标准答案，其质量高低直接决定了计算机的分类效果。此外，我们也可以在一开始就预留一些训练样本，专门用于测试分类的效果。
<div><strong>精选留言（20）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/44/42/af72265f.jpg" width="30px"><span>冰冷的梦</span> 👍（32） 💬（9）<div>老师，我觉得这个p(c|fi,fj) = p(c|fi) * p(c|fj)怪怪的，这个是怎么推导的啊？</div>2019-03-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg" width="30px"><span>qinggeouye</span> 👍（6） 💬（2）<div>P(政治|美国电影) 
= P(政治|美国) · P(政治|电影)
= [ P(美国|政治) · P(政治) &#47; P(美国) ] · [ P(电影|政治) · P(政治) &#47; P(电影) ]
= [ 0.0028% · 20% &#47; 0.0028% ] · [ ... · 20% &#47; 0.0032% ]

“美国电影”属于其它文本分类同理。</div>2019-03-04</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/14/a2/79/e7d758c1.jpg" width="30px"><span>gaoch</span> 👍（3） 💬（1）<div>有没有代码实现方法可以参考的？</div>2019-10-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/f5/e0/76822dd9.jpg" width="30px"><span>南边</span> 👍（2） 💬（1）<div>文章分类的例子，有两个独立性假设，一个是朴素贝叶斯算法，针对文章分类概率和单词词频概率两个维度的独立性假设，另一个是在自然语言处理阶段，对每个单词的独立性假设，这两种假设都简化了算法的复杂性，虽然如果单词量很多的话，计算量也不小，但是相对有联动的概率影响情况，已经好很多了</div>2019-11-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/44/42/af72265f.jpg" width="30px"><span>冰冷的梦</span> 👍（2） 💬（2）<div>老师，上一个问题是基于这个“这里是假设f1和f2相互独立，所以有p(c|f1,f2)=p(c,f1,f2)&#47;(p(f1,f2))=(p(c,f1)p(c,f2))&#47;(p(f1)p(f2))=p(c|f1)p(c|f2)”，中间的等式：p(c,f1,f2)&#47;(p(f1,f2))=(p(c,f1)p(c,f2))&#47;(p(f1)p(f2))这个等式成立的话我理解的是p(c,f1,f2) = p(c,f1)*p(c,f2)应该是成立的，这个是怎么推导的？</div>2019-03-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/55/96/baea9a4e.jpg" width="30px"><span>Ray</span> 👍（1） 💬（1）<div>请教一下，中文 NLP 除了 jieba 之外还有其他好的分词工具推荐吗？</div>2019-11-19</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/44/42/af72265f.jpg" width="30px"><span>冰冷的梦</span> 👍（1） 💬（4）<div>p(c,f1,f2) = p(c,f1)*p(c,f2)这两个相等是怎么推出来的？</div>2019-03-08</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/7c/cc/140c4b61.jpg" width="30px"><span>zhaimy</span> 👍（1） 💬（1）<div>第一张表的先验概率应该是词频&#47;总词频，而不是数量相除吧？比如政治，应该是726898&#47;2837891，而非20%</div>2019-02-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/0f/bc/a0/97c7679b.jpg" width="30px"><span></span> 👍（1） 💬（1）<div>老师，可能我太菜，不会算。也许不是直接带公式吧。比如P(美国|军事），根据条件概率公式=P(美国*军事)&#47;P(军事)。我不知道美国和军事是否应该看做独立。我就算了第一个P(政治|美国电影)，那个P(电影|政治)我取了第三个表中出现政治所有概率求和取平均值。算的0.07125%</div>2019-02-06</li><br/><li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epu2icN21lgNgOmbmicESItsE96Oiarsmk9tyeSia82spSXgeTlSqmy6HdImCqVKzwPRaQugeGzsB9ntw/132" width="30px"><span>孙旗</span> 👍（0） 💬（1）<div>上面的算法只考虑了待预测分类的文本每个词是否出现，比如待预测文档内容是&quot;中国航母&quot;，分词后套用公式可以得出他的分类建议。

但是实际应用上，这个文档内容有可能是这样的：&quot;中国航母，中国导弹，中国核弹，中国制造&quot;

这里中国这个单词不止出现了一次，还要根据上述公式，拆分为：

 P(政治|中国)*P(政治|航母)*P(政治|导弹)*P(政治|核弹)*P(政治|制造)

来计算么？这样的计算方式合理么，或者有可以将文档各个单词出现次数也考虑进去的分类方法么？</div>2022-07-20</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/20/fd/a8/ab2041ef.jpg" width="30px"><span>刘桃花</span> 👍（0） 💬（1）<div>老师，这里想问一个独立随机变量的问题，如果把p(c|f)中的c和f看作随机变量，那么p(c|fi, fj, fk)中的[fi,fj,fk]应该统一看成一个随机变量还是三个？
另外这里我们认为fi, fj, fk是相互独立的，那在这个例子中c和fi, fj, fk还是相互独立的吗？属性和分类之间是否相互影响呢？</div>2020-10-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/15/f5/49/2a84fcf2.jpg" width="30px"><span>zp</span> 👍（0） 💬（1）<div>p(c|f1,f2)=p(c,f1,f2)&#47;(p(f1,f2))=(p(c,f1)p(c,f2))&#47;(p(f1)p(f2))=p(c|f1)p(c|f2)中的p(c,f1,f2) = p(c,f1)*p(c,f2)这两个相等是怎么推出来的？</div>2020-09-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/23/f8/24fcccea.jpg" width="30px"><span>💢 星星💢</span> 👍（0） 💬（4）<div>老师可以举个例子说明一下小数的log变换么。我在上一篇文章也看到老师说了这句话。但是我不得要领。也希望知道的同学帮我解答一下。</div>2019-11-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/32/b8/6a80fb00.jpg" width="30px"><span>Jeson</span> 👍（0） 💬（3）<div>很好，看其他材料都没提分类结果是个相对值，这里还提了原因，最后还要进行一个归一化处理吧</div>2019-04-11</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/42/df/a034455d.jpg" width="30px"><span>罗耀龙@坐忘</span> 👍（3） 💬（1）<div>
茶艺师学编程

思考题：计算一下“美国电影”属于政治、军事、财经、体育和娱乐分类的概率，分别是多少？

美国电影属于政治分类：
P(政治|美国电影)=P(政治|美国)*P(政治|电影)
                          =[P（美国|政治）*P(政治)]&#47;P(美国)*[P（电影|政治）*P(政治)]&#47;P(电影)
                          =0.0028%*20%&#47;0.0028%*P（电影|政治）*20%&#47;0.0032%
                         
美国电影属于军事分类：
P(军事|美国电影)=P(军事|美国)*P(军事|电影)
                          =[P（美国|军事）*P(军事)]&#47;P(美国)*[P（电影|军事）*P(军事)]&#47;P(电影)
                          =P（美国|军事）*16%&#47;0.0028%*P（电影|军事）*16%&#47;0.0032%
                          =P（美国|军事）*P（电影|军事）*

美国电影属于财经分类：
P(财经|美国电影)=P(财经|美国)*P(财经|电影)
                          =[P（美国|财经）*P(财经)]&#47;P(美国)*[P（电影|财经）*P(财经)]&#47;P(电影)
                          =P（美国|财经）*18%&#47;0.0028%*P（电影|财经）*18%&#47;0.0032%

美国电影属于体育分类：
P(体育|美国电影)=P(体育|美国)*P(体育|电影)
                          =[P（美国|体育）*P(体育)]&#47;P(美国)*[P（电影|体育）*P(体育)]&#47;P(电影)
                          =P（美国|体育）*22%&#47;0.0028%*P（电影|体育）*22%&#47;0.0032%


美国电影属于娱乐分类：
P(娱乐|美国电影)=P(娱乐|美国)*P(娱乐|电影)
                          =[P（美国|娱乐）*P(娱乐)]&#47;P(美国)*[P（电影|娱乐）*P(娱乐)]&#47;P(电影)
                          =P（美国|娱乐）*24%&#47;0.0028%*P（电影|娱乐）*24%&#47;0.0032%

可惜上面还差一些数据······</div>2020-04-15</li><br/><li><img src="" width="30px"><span>Paul Shan</span> 👍（2） 💬（0）<div>文章的分类是基于文中的单词信息，可以看作是单词对分类的投票，某一分类的单词越多，属于这个分类的可能性越大。为了达成这个目标，先得把文章分词统计，这是分离出单词并分类单词的过程，这一步统计出来各类文章出现的概率和每类文章的各种单词出现的概率，有了这两类数据，就可以计算出单词和分类的联合概率，有了联合概率就可以求出每个单词为条件，判断文章类别的概率。假定单词是独立的，每个单词就为类别投票，得票多的类别胜出。这里的得票是独立的条件概率，不是求和运算而是乘积，可以用对数的方法处理，这样即避免了概率过小的问题，也把乘法简化为加法，同时还保证了相对大小不变。</div>2019-09-03</li><br/><li><img src="" width="30px"><span>013923</span> 👍（1） 💬（0）<div>谢谢！</div>2022-07-28</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2d/33/f6/cd26bd4a.jpg" width="30px"><span>Geeek</span> 👍（0） 💬（0）<div>老师，p(f2|(f1,c))=p(f2|c)，这个等式是成立的吗</div>2022-07-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/1d/9a/89/babe8b52.jpg" width="30px"><span>A君</span> 👍（0） 💬（0）<div>用朴素贝叶斯来对文章分类，需要满足以下几个因素：1，要能对文本进行分词，将语句转成一系列特征，并为他们赋予相应的数值。2，统计出单词在各分类中出现的频率、各分类出现的频率、各单词出现的频率（通过累加该单词在各分类出现的概率得到）。</div>2021-01-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/b5/98/ffaf2aca.jpg" width="30px"><span>Ronnyz</span> 👍（0） 💬（0）<div>P(政治|美国电影)=P(政治|美国，电影)=P(政治|美国)*P(政治|电影)
=[P(美国|政治)*P(政治)&#47;P(美国)]*[P(电影|政治)*P(政治)&#47;P(电影)]</div>2019-10-09</li><br/>
</ul>