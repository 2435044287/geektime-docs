如果让你设计一个有十亿用户使用的售票网站，你会考虑哪些问题？如果让你设计一个有一万亿用户使用的服务，你又会考虑哪些问题？不要以为有一万亿个用户的服务离我们很远，它正在快速地逼近我们。

我们前面讨论了，代码的性能是关于如何管理内存、磁盘、网络和内核等计算机资源的。该怎么衡量这些资源管理的好坏呢？这就需要一些评价指标。

这些指标不仅指导着代码的交付标准，也指导着我们编码时的技术选择。

## 用户的真实感受

最直接的指标就是用户的真实感受。用户的感受是我们软件开发最基本的风向标，当然也是代码性能追求的终极目标。

如果去超市买东西，我们享受的是购物的过程，讨厌结账。结账之所以令人讨厌，一小部分原因在于这时我们要付钱，更大的原因在于这个过程排队时间可能会很长。如果再算错了帐，就更让人不爽了。

用户对于软件性能的要求，和我们超市结账时的要求差不多：等待时间要短，出错的概率要小。

**等待时间要短**

这个概念很好理解。等待时间越短，我们越喜欢。最好是一点儿都感觉不到等待时间。使用“感觉”、“快”、“慢”这种词汇，有点主观了。有一种统计方法，被广泛地用来评价应用程序性能的满意度，它就是应用程序性能指数（Apdex）。

根据任务的响应时间，应用程序性能指数定义了三个用户满意度的区间：
<div><strong>精选留言（7）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/18/f6/2ff7bc7a.jpg" width="30px"><span>轻歌赋</span> 👍（11） 💬（1）<div>hashmap的默认大小的问题吗？
个人感觉是这个原因，解决办法就是创建map时指定大小。
另外hash的计算都是o1的时间复杂度，但是put这种写操作要比读操作慢。这个暂时没有想到替代方案。
每次都要创建差值感觉比较慢，可以反过来查询当前值，存放差值。
传入的数组不知道有没有序，但是可以默认有序，然后前后交换着访问。即先访问第一个，再访问最后一个，再访问第二个，反复进行
两数之和不知道有没有负数参与的情况。
个人感觉这个算法的时间复杂度已经是o1了，只能从其他角度考虑更快，空间复杂度偏大，考虑有序情况可以前后交换查找。但是无序情况没有帮助。
当数据很大的情况下，可以考虑并行算法。
这个问题的解法感觉最终的结果不应该是单个，可能有多组两数之和都满足的情况，程序设计个人感觉有点问题，实在是想不到更多了。欢迎大家和老师评论，目前还是实习阶段，经验难免不足，希望各位能够指出不足，共勉</div>2019-02-13</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/4f/7f/5dc11380.jpg" width="30px"><span>苏志辉</span> 👍（2） 💬（1）<div>感觉剖异常比较耗性能，需要生成堆栈，可以返回空值</div>2019-03-15</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/10/78/29bd3f1e.jpg" width="30px"><span>王子瑞Aliloke有事电联</span> 👍（1） 💬（2）<div>很想有时间的时候自己试着开发一个浏览器；|
但这个目标的是我考上研究生之后实施。</div>2019-03-05</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/e4/e9/0dd3829f.jpg" width="30px"><span>aguan(^･ｪ･^)</span> 👍（1） 💬（1）<div>时间复杂度O(n)，n表示数组的长度
空间复杂度O(1)</div>2019-02-14</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/11/89/41/c276dbda.jpg" width="30px"><span>李星</span> 👍（0） 💬（1）<div>for循环时间复杂度可能是O(n),hashmap的put和containskey都是O（1）吧</div>2019-02-17</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg" width="30px"><span>ifelse</span> 👍（2） 💬（0）<div>从小的代码层面看，我们要有意识、要能够给理解并计算算法的复杂度，来尽量提高每一段代码的效率。从大的架构层面看，我们要采用合适的技术，指导实现的代码能够把有限资源使用的更有效率，也能够在必要时使用更多的资源。从更大的产品层面看，我们一定要关切用户的使用体验和真实感受，特别是糟糕状况下的感受，及时地做出调整。--记下来</div>2022-07-22</li><br/><li><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/ooZCPFY1xgC81h0Eu3vuqbWG5MaBp8RNmvXXGQwupo2LpSOLq0rBlTDRAF1yM6wF09WdeG49rA9dJSVKIUBxnQ/132" width="30px"><span>Sisyphus235</span> 👍（1） 💬（0）<div>这个解法的算法已经比较完善了，如果要提升效率可能要从多线程、多进程的角度出发，这些也要和数据量相关，数据量小的时候可能排序的效果更好，因为线程和进程切换要损失效率</div>2019-05-22</li><br/>
</ul>