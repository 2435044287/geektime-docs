成功的大公司，也是从小公司起步的。刚开始的时候，软件可能比较简单，用户也比较少，一台廉价的服务器，或者一个简单的虚拟机，甚至几个静态的页面就绰绰有余。

很快，辛苦的努力得到回报，产品传播速度远超预期，用户很喜欢公司的产品或者服务，数量大幅增加，需求越来越强劲。这时候也是公司最忙碌的时候，每个人眼里只有两个字：“增长”。用户规模增长随之带来的是软件规模增长，运维复杂度增长。这时候，廉价的服务器满足不了需求了，就需要更多的服务器，甚至是各种用途不一样的服务器，还需要使用更多的带宽、更多的内存、更多的CPU，甚至更多的硬盘。

跟得上增长的公司，用户会越来越喜欢，就会脱颖而出，每一份辛苦都得到了优厚的回报；跟不上增长的，用户会越来越抱怨，公司会被迅速模仿，然后用户被抢走，公司被迅速甩开，每一份辛苦都成了一声叹息。

增长对软件的要求，就是要有处理越来越多工作和越来越大规模的能力或者潜力。这种能力，通常称之为可伸缩性（Scalability）。

不过，要提醒的是，也有人使用“可扩展性”这个词表示规模的扩张能力。可扩展性这个词汇很多时候也用于表示功能的扩展（Extensibility）。这就容易混淆规模扩展和功能扩展这两个完全不一样的概念。如果有人使用了可扩展性这个概念，要弄清楚指的是规模还是功能。
<div><strong>精选留言（6）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg" width="30px"><span>hua168</span> 👍（8） 💬（1）<div>怎么判断代码是否使用分布式？

1.是不是看企业将来战略要求？
他们一般都会说将来用户量大，但是开发人员就那么几个，是不是一开始就弄分布式，只不过放在一两台服务器上，当用户量增加再慢慢分离？

2.看公司未来3年是否用户量增加到要代码拆分的程度？
  如果用到最好前期就开始做吗？


像我们水平扩展，做分布式，前期java web比较多的组合是
nginx+spring Boot+dubbo（spring cloud）+redis+mongoDB&#47;mysql

nginx：反代，主要是处理静态，分担tomcat压力，前期和spring Boot1台
spring Boot+dubbo（spring cloud）:含tomcat，解决代码水平扩展，前期1台服务器
redis：保存状态数据，一般是session比较多，前期做主从，前期一般2台
mongoDB&#47;mysql：数据库，只在数据，前期一般2台

如果访问量过大：
  1. 数据库方面：变成1主多从，如果压力大就分库，再大就分表做sharding
  2. 前上面组合中前面添加多一个web代理，如nginx&#47;haproxy，
     包含代码的web服务器复制几台现来，再做七层代理，如果一个七层代理不够，前面再加4层LVS
  3. redis：做成群集</div>2019-03-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/18/f6/2ff7bc7a.jpg" width="30px"><span>轻歌赋</span> 👍（3） 💬（2）<div>所以一个web程序可以将信息简单分为三类
1. 静态数据，客户端缓存，主要思考方向在如何让客户端更多的缓存，并且服务端能够随时消除缓存
2. 无状态动态数据，可以考虑在单实例做缓存，提高效率，但是需要考虑如何通知清理缓存，怎么样设计缓存可以尽可能细粒度的清理缓存
3. 有状态数据，可以考虑在redis等系统级的缓存处缓存，考虑到系统的扩张，一台缓存可能不够用，需要算法层次考虑分散用户数据，确保一个用户只会进入一部分缓存

对于3，之前看过对于用户的ID进行hash的方式，但是感觉当缓存实例数量变化的时候取模是个问题，请问老师，这点如何在算法上进行设计呢？</div>2019-03-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg" width="30px"><span>hua168</span> 👍（1） 💬（1）<div>老师，之后的会介绍一些简单的防攻击之类的吗？我觉得代码写的再好，如果很容易被入侵，那也是等于0，我前公司网站经常时不时被入侵还不知道怎么回事T_T，服务器安全没有什么问题。
防攻击是靠java的安全框架，还是自己手工写的防攻击代码？还是直接加多一层专门用来做防攻击过滤？
起码保证代码是安全的，如果是网络类有专业的防火墙，如DDOS防火墙。</div>2019-03-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg" width="30px"><span>hua168</span> 👍（1） 💬（1）<div>如果分布式前期已确定好（如：SpringBoot+redis+mysql）代码写好之后，如果再加多一些安全过滤来防攻击，是不是在直接在SpringBoot加多一层安全过滤？因为我在网上看到过这么一句话：

Any problem in computer science can be solved by anther layer of indirection.
计算机科学领域的任何问题都可以通过增加一个间接的中间层来解决。
</div>2019-03-07</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg" width="30px"><span>ifelse</span> 👍（0） 💬（0）<div>如果你要设计一个具有规模扩张能力的软件架构，分离无状态数据和状态数据，既可以提高规模水平能力，也可以提高规模垂直扩张能力。--记下来</div>2022-07-26</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg" width="30px"><span>夜空中最亮的星</span> 👍（0） 💬（0）<div>有启发 有收获</div>2019-03-06</li><br/>
</ul>