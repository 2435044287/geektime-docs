你好，我是吴咏炜。

早在 Vim 和 Emacs 的“圣战”时期，Emacs 有个功能可是 Vim 用户一直暗暗垂涎的，那就是可以集成 GDB 来调试程序。Emacs 之所以能够实现这个功能，是因为它可以模拟一个终端环境，像终端一样跟一个程序进行输入输出的交互。这样一来，我们不离开编辑器，也能调试程序，既可以方便地看到目前执行在源代码的第几行，也可以直接在编辑器里跟执行中的程序进行交互。

很多主流的开发环境都支持类似的功能。但 Vim 一直不支持这样的功能，直到 Vim 8。虽然到得有点晚，但 Vim 也算是厚积薄发，利用 libvterm 给出了完整的终端支持。今天，我们就拿终端窗口支持和 GDB 支持，作为我们最后的技术话题来介绍了。

## 终端窗口支持

### 基本用法

使用 `:terminal`（缩写 `:term`）命令，我们可以在 Vim 的窗口中运行终端模拟器。基本的用法就是下面两种：

- 使用 `:terminal`，后面不跟其他命令，分割一个新窗口，并使用默认的 shell 程序进行终端模拟；shell 退出后窗口自动关闭（可用使用命令参数 `++noclose` 改变这一行为）。
- 使用 `:terminal 命令` 的方式，分割一个新窗口，在其中运行指定的命令并进行终端模拟；命令执行完成退出后窗口不自动关闭，保留执行中显示的信息（可用使用命令参数 `++close` 改变这一行为）。
<div><strong>精选留言（5）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/13/0d/40/f70e5653.jpg" width="30px"><span>前端西瓜哥</span> 👍（1） 💬（1）<div>老师，怎么在vimrc设置默认shell啊，Windows 下我每次打开默认打开的是 cmd，我想用的是 powershell，每次打开都要敲 :term powershell，命令有点长（当然我也想到一个解决方案是加个快捷方式 \t</div>2020-09-16</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg" width="30px"><span>我来也</span> 👍（1） 💬（1）<div>学习了.
有时间了再好好研究研究.

这个功能对我来说还比较陌生.
之前是用tmux来实现终端的一部分功能.

在使用了`vim-dispatch`插件后,才知道这个功能这么方便.
可以单独开一个小终端去执行make中的编译操作,
主窗口还是继续做自己的事情.

这样编译结束或出错了,立马就知道了,也不用傻等.

----
老师在写专栏的过程中没少恶补周边知识吧，哈哈。

平常自己折腾的话,不需要掌握的特别全,能用和好用就够了.
但是写专栏时,就需要知识比较全,且是准确无误的,有时还需要知道来龙去脉.

----
不知不觉专栏的正文部分都结束了，不舍。������
</div>2020-09-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/25/2b/ca/71ff1fd7.jpg" width="30px"><span>谁家内存泄露了</span> 👍（0） 💬（2）<div>请问老师，在vim内置的终端里，如果我想输入上一条命令，怎么实现呢？普通终端应该使用方向键↑就好了。</div>2023-03-12</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/74/a9/5eb3ebc6.jpg" width="30px"><span>唐龙</span> 👍（0） 💬（1）<div>首先体验了一下`:tab term`的无限递归，我一直都挺喜欢用多个标签页的。

后面试了一下gdb，突然发现我几乎没用过gdb，就记得start run b c s这么几个命令，但是也确实体验到了在中间那一栏输出。

虽然还不太熟练，但是我设想了一下，以后再写项目的时候，切换文件直接用`:e`，编辑多个文件用多个标签页，除了gdb调试的时候基本不会主动使用多窗口，但是gdb调试用多窗口还是挺舒服的。
当然也可以写一些快捷键简化上述操作，比如：`nnoremap &lt;leader&gt;o :tabnew `。

整篇课程里80%+的插件自己都尝试了一下，`frazrepo&#47;vim-rainbow`在我看来就特别香。

感觉自己还可以进一步的做些定制，主要是快捷键，到时候再假装vim是IDE，奈斯。</div>2020-09-09</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/18/4f/a3/0e56b4e5.jpg" width="30px"><span>doge</span> 👍（0） 💬（1）<div>学到了，单文件调试效果确实不错。不过大型项目的调试感觉不是特别好用了。</div>2020-09-09</li><br/>
</ul>