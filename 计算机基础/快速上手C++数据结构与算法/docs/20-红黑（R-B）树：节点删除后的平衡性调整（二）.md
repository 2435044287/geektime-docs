你好，我是王健伟。

这节课我们接着讨论删除黑色叶子节点导致的红黑树平衡性调整问题。现在还有一种情况我们没有讨论到，那就是**待删节点的父节点为黑色，兄弟节点也为黑色且兄弟节点不待任何孩子节点**的情况。

随着我的讲解，你也可以回想上节课的思考题，看一看你想到的各种情况和解决思路与我即将开始的讲解是否相同，以及是否有一些情况没有想到。

这节课的标号我们接着上节课来。

7. 待删除节点是左节点或者右节点都可以（下图中用左节点演示），其父节点为黑色，兄弟节点为黑色且不带孩子。

这是个比较特殊的情形，因为调整后黑高度会变小。为了清晰，把Nil节点也绘制出来，如图1所示：

![](https://static001.geekbang.org/resource/image/9b/1d/9ba1849b7e48c4318afe191ff6462d1d.jpg?wh=1475x658 "图1 待删除节点的父节点为黑色，兄弟节点为黑色且不带孩子")

**操作步骤：**

- 把节点D删除。
- 把S节点变为红色，如图1中的第2个图所示。

单纯看图1中的第2个图是平衡的，如果此时P节点是整个红黑树的根则平衡调整完毕。但如果P节点不是整棵红黑树的根，那么，比较图1中第1个和第2个图，会发现第2个图比第1个图的黑高度减少了1，所以如果把图1中第1个图放在一个大的红黑树中，当删除节点D并进行平衡性调整后就会出现问题，如图2所示：

![](https://static001.geekbang.org/resource/image/99/81/992d762c59814c85f5cb9755b9f6b581.jpg?wh=1692x765 "图2 待删除节点的父节点为黑色，兄弟节点为黑色且不带孩子，作为一棵子树的情形之一")

在图2的第1个图是一个大的红黑树。其中根节点100的颜色随意，可红可黑。现在需要删除节点D，则操作步骤的前两步与前面相同，即：
<div><strong>精选留言（2）</strong></div><ul>
<li><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/xQfxqZibARNAGjHAslju85UfgnosqM13kee7qXSXv6tLtzh4189zDdWlicr5syjwia5PMzsicuhtjvwgYnicu0TU0pA/132" width="30px"><span>Geek_0c9a5e</span> 👍（2） 💬（1）<div>王老师也太牛掰了。每一种数据结构都有具体实现。比不少大学老师敬业的多。</div>2023-04-06</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/16/8d/d2/498cd2d1.jpg" width="30px"><span>程序员班吉</span> 👍（0） 💬（0）<div>这个厉害，全网能把红黑树的删除讲明白的几乎没找到。</div>2023-09-24</li><br/>
</ul>