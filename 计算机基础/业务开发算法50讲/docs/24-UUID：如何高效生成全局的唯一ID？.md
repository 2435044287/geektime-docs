你好，我是微扰君。

今天我们来聊一聊在生产环境中非常常用的一个算法——全局唯一ID生成算法，也就是我们通常说的UUID。

就和我们在社会中都有自己的身份证号作为自己的唯一标示一样，在互联网的应用中，很多时候，我们需要能生成一个全局唯一的ID，去区别不同业务场景下的不同数据，比如消息ID、用户ID、微博内容ID等等。

因为我们往往**需要通过这个ID去索引某个业务数据，所以一定要保证生成的ID在全局范围内是唯一的**，这也是identifier的本意，在部分情况下，冲突概率很小可能也是可以接受的。另外，这个ID通常需要按照某种规则有序排列，最常用的就是基于时间进行排序。

所以全局唯一ID的两个核心需求就是：

1. 全局唯一性
2. 粗略有序性

那业界是如何生成满足这两大需求的ID，又有哪些方案呢？我们开始今天的学习。

### 单体环境

在单体的应用中，保证ID的全局唯一，其实不是一个很大的问题，我们只需要提供一个在内存中的计数器，就可以完成对ID的颁发。

当然这样的ID可能会带有明确的含义，并被暴露出去了，比如在票务系统中，如果这样设计，我们能根据电子票ID判断出自己买的是第几张票。这对安全性要求更高的业务来说，是不可接受的，但通过一些简单的加密算法混淆，我们就能解决这个问题。
<div><strong>精选留言（2）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/19/6b/e9/7620ae7e.jpg" width="30px"><span>雨落～紫竹</span> 👍（1） 💬（1）<div>有问题。人家就10毫秒来10万个 你这不都有问题了</div>2022-07-18</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg" width="30px"><span>peter</span> 👍（0） 💬（1）<div>请教老师四个问题：
Q1：重试幂等使用的ID用什么方法生成？
Q2：个人电脑，比如我使用的笔记本，我并没有对它进行过时间同步操作，
        请问这个笔记本会自动进行时间同步吗？
Q3：Snowflake算法的bit0为什么不用？maxNodeId为什么要1024减去1？
        maxSequence为什么要4096减去1？
Q4：能否举几个分布式ID在互联网的典型应用？ 比如XX场景下用XX方法？</div>2022-02-15</li><br/>
</ul>