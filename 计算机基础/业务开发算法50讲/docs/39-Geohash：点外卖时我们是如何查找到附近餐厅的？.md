你好，我是微扰君。

今天我们来聊一聊另一个和索引相关的非常有趣的问题：“地理位置检索”问题。

身处移动互联网时代，我们的衣食住行少不了各种用到地理位置信息的APP。比如周末想和朋友小聚一下，不知道去哪，我就会在美团点评上检索餐厅或者休闲场所，除了看评价，也经常会按照距离排序或者限定距离范围，找距离近、评价也高的地方，这样通勤成本就可以低很多。

![图片](https://static001.geekbang.org/resource/image/57/d5/57ed5cd1fdc11211593c5e4526f9b7d5.png?wh=1170x2532)

再比如许多基于地理位置推荐用户的社交类APP，或者摩拜单车这样的APP里，也都有类似的地理位置检索的需求。

作为一个软件工程师，不知道你有没有思考过这背后用了什么样的算法呢？今天就让我们来一探究竟。

## 地理位置检索

来明确一下这里要说的地理位置检索问题的讨论范畴。

所谓检索，自然是说从数据中找到一些有指定特征的数据。比如，在数据库中做一个select的查询就可以认为是一种检索行为，语句中如果有where的子句，就说明我们的查询是有条件的。

**地理位置检索，正是从这样一些含有地理位置信息（通常用经纬度表示）的元素中，查询满足特定地理位置条件的元素的行为**。比如在存有店铺信息和对应经纬度的数据库中，查询某个经纬度坐标3km之内的店铺，或者进一步按照距离远近进行排序。这就是我们今天主要讨论的问题。许多数据存储系统也都支持了相关的查询实现，比如MongoDB、Redis等等。
<div><strong>精选留言（2）</strong></div><ul>
<li><img src="https://static001.geekbang.org/account/avatar/00/17/95/af/b7f8dc43.jpg" width="30px"><span>拓山</span> 👍（1） 💬（0）<div>[然后我们再继续考虑 39.9929 纬度属于[0,45]还是[45,90]，如果属于[45,90]，用 1 标记，反之用 0。这个时候，我们发现 39.9929 属于[0,45]应该用 1 标记]

这句话写的有问题，头半句是说 [0,45] 要用0标记，怎么到了第二句又变成了[0,45]用1标记？
 </div>2023-08-10</li><br/><li><img src="https://static001.geekbang.org/account/avatar/00/2a/29/ab/59a6e437.jpg" width="30px"><span>Kevin</span> 👍（0） 💬（0）<div>恍然大悟，巧妙的算法</div>2023-04-24</li><br/>
</ul>